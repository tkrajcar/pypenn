This is patch 1 for PennMUSH 1.8.4. After applying this patch, you
will have version 1.8.4p1

To apply this patch, save it to a file in your top-level 1.8.4p0 MUSH directory,
and do the following:
        patch -p0 < 1.8.4-patch01
        ./configure
        make install

If you use GNU patch 2.2, you probably want the above to be 'patch -b
-p0', not just 'patch -p0'.

Unix (or cygwin) users need not worry about failed hunks in
game/txt/hlp/index.hlp, src/switchinc.c, hdrs/switches.h, hdrs/cmds.h,
or hdrs/funs.h. These files are automatically rebuilt on compile. On
the off chance they appear not to be, simply rm them and re-run make.

Then @shutdown/reboot your MUSH.
    - Shawn/Raevnos

In this patch:

Major Changes:
 * You can now do the equivilent of @command/add, @hook, @function and
   @attribute/access from alias.cnf and restrict.cnf, to add/configure
   commands, functions and standard attributes. Suggested by Paige. [MG]
 * Exits now use @alias for alternate names. The old style of
   including aliases directly in names is still supported, but
   depreciated in new construction. Suggested by [MG]. [SW]

Minor Changes:
 * @power now reports when you try and set a power which is already set (or
   clear one which isn't set), similar to @set. Suggested by Paige. [MG]
 * Sorting methods now take - as a prefix to sort type in order to sort
   in descending order. Suggested by Minion. [GM]
 * The matching code no longer matches players who aren't nearby with
   "*playername" when MAT_NEAR is given, more in line with other checks.
   (This has virtually no impact for most players.) [MG]
 * The internal pe_info (which manages the function invocation limit, among
   other things) is now managed per-queue, not per-command argument. [MG]
 * @chan/decompile now uses "*name" for players, and dbrefs for other
   objects, when printing "@chan/on" statements. [MG]
 * cpu_limit now works on Cygwin (though not quite as well as on unix).
   A slightly higher limit may be needed than other platforms. [MG]
 * The output from say, pose, semipose and @emit is now passed through the
   SPEECHMOD attribute before being outputted. Suggested by Paige, based on
   MUX and TinyMUSH. [MG]
 * @config/list now accepts wildcard patterns to match against option names.
   Suggested by Trinsec. [MG]
 * The dreaded <Output flushed> message should show up a lot less frequently
   on spammy debug output and the like. By popular demand. [SW]
 * Added support for MSSP (Mud Server Status Protocol), based on patches by
   Javelin and Teal. See mush.cnf for details. [MG]
 * The script for updating config files is smarter about adding new alias
   lines. [SW]
 * @search now only charges for elock searches which use eval or indirect
   locks.
 * Added @mail/unread, to mark mail you've already read as new, and 
   @mail/status to change read/cleared/tagged status for messages.. Suggested
   by qa'toq. [MG]

Commands:
 * Add /preserve switch to @chzone and @chzoneall, like @chown/preserve.
 * Rooms/exits must now have an @COST attribute in order to be given
   pennies. Use @cost <ancestor>=%0 to enable giving to all rooms/exits. [MG]
 * with/room can now check for commands in the Master Room or your ZMR, and
   with can check for commands on your ZMT. [MG]
 * @sitelock/register <host> now sets the access rules for <host> to be
   "!create register", rather than "!create". Suggested by Trinsec. [MG]
   
Functions:
 * remit() now works like @remit/list. Suggested by Minion. [MG]
 * rand() now accepts negative arguments again. [MG]
 * lcon() can now take a second argument to make it behave like lthings()
   or l[v]players(), or makes it return only puppets/listening objects,
   for MUX/Rhost compatability. Suggested by Bane. [MG]
 * open() can now open rooms remotely. Suggested by Minion. [MG]
 * reswitch() and co now perform $-replacements for subexpressions. [MG]

Fixes:
 * Help fixes.
 * @search's output can now include garbage objects, like lsearch().
   Reported by Minion. [MG]
 * The command parser incorrectly expanded the names of disabled built-in
   commands prior to $-command matching. Reported by Mercutio. [MG]
 * benchmark()'s average would be thrown off when the CPU limit was 
   exceeded during evaluation. Reported by Amberyl. [MG]
 * Fix a few bugs in handling of command locks. [SW]
 * Garbage objects could be matched by dbref. Reported by Paige. [MG]
 * No longer complain about reboot.db not being present when we're not
   doing a @shutdown/reboot anyway. Reported by Paige. [MG]
 * The Telnet escape code was not properly escaped when sent literally to
   Pueblo-aware clients. [MG]
 * namelist() did not accept names in quotes. Reported by Amberyl. [MG]
 * @attrib/access/retroactive could remove the 'root' flag from attribute
   trees, making nasty things happen. Reported by Cooee. [MG]
 * Fix fn() to check that the first arugment is actually the name of a
   built-in function. Reported by Time and Cheetah. [DC]
 * Nested @asserts/@breaks with no '=' would loop unintentionally.
   Reported by Minion. [MG]
 * Fixed a couple of small bugs in give/@cost. [MG]
 * You can now always look at remote objects whose descs are not set nearby,
   and can never look at remote objects with nearby descs. [MG]
 * The chatdb didn't load correctly with invalid objects on channels. [MG]
 * Fixed a crashbug in @boot on Windows. Reported by Daniel Powell. [MG]
 * %q-registers did not carry over into @includes correctly. Reported by
   Reaver. [MG]
 * Double-free in follow command fixed. Reported by Anya@ST:DW. [MG]
 * locate() sometimes returned #-2 when two objects matched, even if only
   one of them was the preferred type. Reported by Minion. [MG]

 CHANGES.184               |   94 +
 Makefile.in               |    2 
 Patchlevel                |    2 
 game/access.README        |    2 
 game/aliascnf.dst         |   20 
 game/mushcnf.dst          |   11 
 game/restart              |   15 
 game/restrictcnf.dst      |    9 
 game/txt/README           |   44 
 game/txt/hlp/index.hlp    |  773 ++++++-------
 game/txt/hlp/pennchat.hlp |    2 
 game/txt/hlp/penncmd.hlp  |  392 ++++--
 game/txt/hlp/pennconf.hlp |    5 
 game/txt/hlp/pennfunc.hlp |   95 +
 game/txt/hlp/pennmail.hlp |   14 
 game/txt/hlp/penntop.hlp  |   18 
 game/txt/hlp/pennv184.hlp |   97 +
 game/txt/hlp/pennvOLD.hlp |    2 
 hdrs/atr_tab.h            |    1 
 hdrs/attrib.h             |    3 
 hdrs/boolexp.h            |    3 
 hdrs/command.h            |   17 
 hdrs/conf.h               |   17 
 hdrs/dbdefs.h             |    2 
 hdrs/externs.h            |   10 
 hdrs/extmail.h            |   12 
 hdrs/function.h           |    3 
 hdrs/game.h               |    7 
 hdrs/mushtype.h           |    7 
 hdrs/parse.h              |    3 
 hdrs/svninfo.h            |    2 
 hdrs/switches.h           |   52 
 hdrs/version.h            |    6 
 po/de_DE.pox              |    4 
 po/hr_HR.pox              |  171 ++-
 po/nl_NL.pox              |   69 -
 po/no_NO.pox              |    8 
 po/pennmush.pot           | 2593 +++++++++++++++++++++++-----------------------
 po/pl_PL.pox              |    8 
 po/sv_SE.pox              |    4 
 src/Makefile.in           |   29 
 src/SWITCHES              |    2 
 src/access.c              |   22 
 src/atr_tab.c             |   42 
 src/attrib.c              |   93 -
 src/boolexp.c             |   39 
 src/bsd.c                 |  150 ++
 src/chunk.c               |    2 
 src/cmds.c                |   14 
 src/command.c             |  251 +++-
 src/conf.c                |  129 ++
 src/cque.c                |   17 
 src/db.c                  |    7 
 src/destroy.c             |    2 
 src/extchat.c             |   28 
 src/extmail.c             |   95 +
 src/flags.c               |   66 -
 src/funcrypt.c            |    4 
 src/function.c            |   94 +
 src/fundb.c               |  148 +-
 src/funlist.c             |   37 
 src/funmisc.c             |  122 +-
 src/funstr.c              |    5 
 src/funufun.c             |   10 
 src/game.c                |   48 
 src/help.c                |    7 
 src/ident.c               |    2 
 src/info_master.c         |    3 
 src/lock.c                |    3 
 src/look.c                |   20 
 src/malias.c              |    1 
 src/markup.c              |   70 -
 src/match.c               |   30 
 src/memcheck.c            |    6 
 src/mymalloc.c            |    4 
 src/mysocket.c            |    3 
 src/myssl.c               |    8 
 src/notify.c              |    9 
 src/parse.c               |   60 -
 src/pcre.c                |    8 
 src/plyrlist.c            |    4 
 src/predicat.c            |    5 
 src/rob.c                 |   19 
 src/set.c                 |   16 
 src/sort.c                |   66 -
 src/speech.c              |   55 
 src/sql.c                 |    3 
 src/strutil.c             |   28 
 src/switchinc.c           |    2 
 src/timer.c               |   24 
 src/utils.c               |    6 
 src/wait.c                |    2 
 src/wiz.c                 |   77 -
 utils/update-cnf.pl       |  320 +++--
 utils/update.pl           |  255 ++--
 95 files changed, 4390 insertions(+), 2781 deletions(-)

Prereq: 1.8.4.0
===================================================================
--- Patchlevel	(.../184p0)	(revision 575)
+++ Patchlevel	(.../184p1)	(revision 575)
@@ -1,3 +1,3 @@
 Do not edit this file. It is maintained by the official PennMUSH patches.
-This is PennMUSH 1.8.4.0
+This is PennMUSH 1.8.4p1
 
Index: Makefile.in
===================================================================
--- Makefile.in	(.../184p0)	(revision 575)
+++ Makefile.in	(.../184p1)	(revision 575)
@@ -3,7 +3,7 @@
 # - System configuration - #
 
 VERSION=1.8.4
-PATCHLEVEL=0
+PATCHLEVEL=1
 
 #
 # This section of the file should be automatically configured by the
Index: src/mysocket.c
===================================================================
--- src/mysocket.c	(.../184p0)	(revision 575)
+++ src/mysocket.c	(.../184p1)	(revision 575)
@@ -176,7 +176,6 @@
   char cport[NI_MAXSERV];
   int s;
   int res;
-  int err;
 
   memset(&hints, 0, sizeof(struct addrinfo));
   hints.ai_family = AF_UNSPEC;  /* Try to use IPv6 if available */
@@ -216,7 +215,7 @@
         penn_perror("bind failed (Possibly harmless)");
     }
 
-    if ((err = connect_nonb(s, server->ai_addr, server->ai_addrlen, nonb)) == 0)
+    if (connect_nonb(s, server->ai_addr, server->ai_addrlen, nonb) == 0)
       break;
 
 #ifdef DEBUG
Index: src/fundb.c
===================================================================
--- src/fundb.c	(.../184p0)	(revision 575)
+++ src/fundb.c	(.../184p1)	(revision 575)
@@ -38,7 +38,7 @@
                         char const *pattern, ATTR *atr, void *args);
 static dbref dbwalk(char *buff, char **bp, dbref executor, dbref enactor,
                     int type, dbref loc, dbref after, int skipdark,
-                    int start, int count, int *retcount);
+                    int start, int count, int listening, int *retcount);
 
 const char *
 do_get_attrib(dbref executor, dbref thing, const char *attrib)
@@ -653,7 +653,7 @@
 static dbref
 dbwalk(char *buff, char **bp, dbref executor, dbref enactor,
        int type, dbref loc, dbref after, int skipdark,
-       int start, int count, int *retcount)
+       int start, int count, int listening, int *retcount)
 {
   dbref result;
   int first;
@@ -661,6 +661,7 @@
   dbref thing;
   int validloc;
   dbref startdb;
+  int privwho = Priv_Who(executor);
 
   nthing = 0;
 
@@ -696,6 +697,12 @@
           (skipdark && Dark(thing) && !Light(thing) && !Light(loc)) ||
           ((type == TYPE_PLAYER) && skipdark && !Connected(thing)))
         continue;
+      if ((listening == 1 && !Puppet(thing)) || (listening == 2 &&
+                                                 !((Hearer(thing)
+                                                    || Listener(thing))
+                                                   && (privwho
+                                                       || !Dark(thing)))))
+        continue;
       nthing += 1;
       if (count < 1 || (nthing >= start && nthing < start + count)) {
         if (buff) {
@@ -728,6 +735,7 @@
   int vis = 0;
   int type = 0;
   int result = 0;
+  int listening = 0;
   const char *ptr = called_as;
   char *buffptr = buff;
   char **bptr = bp;
@@ -736,50 +744,71 @@
   buffptr = buff;
   bptr = bp;
 
-  switch (*(ptr++)) {
-  case 'X':
-    if (!is_strict_integer(args[1]) || !is_strict_integer(args[2])) {
-      safe_str(T(e_int), buff, bp);
+  if (!strcmp(called_as, "LCON") && nargs == 2) {
+    if (string_prefix("player", args[1])) {
+      type = TYPE_PLAYER;
+    } else if (string_prefix("object", args[1])
+               || string_prefix("thing", args[1])) {
+      type = TYPE_THING;
+    } else if (string_prefix("connect", args[1])) {
+      type = TYPE_PLAYER;
+      vis = 1;
+    } else if (string_prefix("puppet", args[1])) {
+      type = TYPE_THING;
+      listening = 1;
+    } else if (string_prefix("listen", args[1])) {
+      type = TYPE_THING | TYPE_PLAYER;
+      listening = 2;
+    } else {
+      safe_str("#-1", buff, bp);
       return;
     }
-    start = parse_integer(args[1]);
-    count = parse_integer(args[2]);
-    if (start < 1 || count < 1) {
-      safe_str(T("#-1 ARGUMENT OUT OF RANGE"), buff, bp);
-      return;
+  } else {
+    switch (*(ptr++)) {
+    case 'X':
+      if (!is_strict_integer(args[1]) || !is_strict_integer(args[2])) {
+        safe_str(T(e_int), buff, bp);
+        return;
+      }
+      start = parse_integer(args[1]);
+      count = parse_integer(args[2]);
+      if (start < 1 || count < 1) {
+        safe_str(T("#-1 ARGUMENT OUT OF RANGE"), buff, bp);
+        return;
+      }
+      break;
+    case 'N':
+      buffptr = NULL;
+      bptr = NULL;
+      break;
     }
-    break;
-  case 'N':
-    buffptr = NULL;
-    bptr = NULL;
-    break;
-  }
 
-  if (*ptr == 'V') {
-    vis = 1;
-    ptr++;
-  }
+    if (*ptr == 'V') {
+      vis = 1;
+      ptr++;
+    }
 
-  switch (*ptr) {
-  case 'C':                    /* con */
-    type = TYPE_THING | TYPE_PLAYER;
-    break;
-  case 'T':                    /* things */
-    type = TYPE_THING;
-    break;
-  case 'P':                    /* players */
-    type = TYPE_PLAYER;
-    break;
-  case 'E':                    /* exits */
-    type = TYPE_EXIT;
-    break;
-  default:
-    /* This should never be reached ... */
-    type = TYPE_THING | TYPE_PLAYER;
+    switch (*ptr) {
+    case 'C':                  /* con */
+      type = TYPE_THING | TYPE_PLAYER;
+      break;
+    case 'T':                  /* things */
+      type = TYPE_THING;
+      break;
+    case 'P':                  /* players */
+      type = TYPE_PLAYER;
+      break;
+    case 'E':                  /* exits */
+      type = TYPE_EXIT;
+      break;
+    default:
+      /* This should never be reached ... */
+      type = TYPE_THING | TYPE_PLAYER;
+    }
   }
 
   dbwalk(buffptr, bptr, executor, enactor, type, loc, NOTHING,
-         vis, start, count, &result);
+         vis, start, count, listening, &result);
 
   if (!buffptr) {
     safe_integer(result, buff, bp);
@@ -792,7 +821,7 @@
   dbref loc = match_thing(executor, args[0]);
   safe_dbref(dbwalk
              (NULL, NULL, executor, enactor, TYPE_THING | TYPE_PLAYER, loc,
-              NOTHING, 0, 0, 0, NULL), buff, bp);
+              NOTHING, 0, 0, 0, 0, NULL), buff, bp);
 }
 
 /* ARGSUSED */
@@ -801,7 +830,7 @@
   dbref loc = match_thing(executor, args[0]);
   safe_dbref(dbwalk
              (NULL, NULL, executor, enactor, TYPE_EXIT, loc, NOTHING, 0, 0, 0,
-              NULL), buff, bp);
+              0, NULL), buff, bp);
 }
 
 /* ARGSUSED */
@@ -814,13 +843,13 @@
     case TYPE_EXIT:
       safe_dbref(dbwalk
                  (NULL, NULL, executor, enactor, TYPE_EXIT, Source(it), it, 0,
-                  0, 0, NULL), buff, bp);
+                  0, 0, 0, NULL), buff, bp);
       break;
     case TYPE_THING:
     case TYPE_PLAYER:
       safe_dbref(dbwalk
                  (NULL, NULL, executor, enactor, TYPE_THING | TYPE_PLAYER,
-                  Location(it), it, 0, 0, 0, NULL), buff, bp);
+                  Location(it), it, 0, 0, 0, 0, NULL), buff, bp);
       break;
     default:
       safe_str("#-1", buff, bp);
@@ -1601,7 +1630,7 @@
       return;
     }
     if (FUNCTION_SIDE_EFFECTS)
-      (void) do_chzone(executor, args[0], args[1], 1);
+      (void) do_chzone(executor, args[0], args[1], 1, 0);
     else {
       safe_str(T(e_disabled), buff, bp);
       return;
@@ -1802,9 +1831,19 @@
 FUNCTION(fun_fullname)
 {
   dbref it = match_thing(executor, args[0]);
-  if (GoodObject(it))
+  if (GoodObject(it)) {
     safe_str(Name(it), buff, bp);
-  else
+    if (IsExit(it)) {
+      ATTR *a = atr_get_noparent(it, "ALIAS");
+      if (a) {
+        char *aliases = atr_value(a);
+        if (aliases && *aliases) {
+          safe_chr(';', buff, bp);
+          safe_str(aliases, buff, bp);
+        }
+      }
+    }
+  } else
     safe_str(T(e_notvis), buff, bp);
 }
 
@@ -1869,7 +1908,7 @@
   int first = 1;
   char *current;
   dbref target;
-  char *start;
+  const char *start;
   int report = 0;
   ufun_attrib ufun;
   char *wenv[2];
@@ -1883,12 +1922,12 @@
     }
   }
 
-  start = trim_space_sep(args[0], ' ');
+  start = (const char *) args[0];
   while (start && *start) {
     if (!first)
       safe_chr(' ', buff, bp);
     first = 0;
-    current = split_token(&start, ' ');
+    current = next_in_list(&start);
     if (*current == '*')
       current = current + 1;
     target = lookup_player(current);
@@ -2083,6 +2122,7 @@
 /* ARGSUSED */
 FUNCTION(fun_open)
 {
+  dbref source = NOTHING;
   if (!FUNCTION_SIDE_EFFECTS) {
     safe_str(T(e_disabled), buff, bp);
     return;
@@ -2091,7 +2131,17 @@
     safe_str(T(e_perm), buff, bp);
     return;
   }
-  safe_dbref(do_real_open(executor, args[0], args[1], NOTHING), buff, bp);
+  if (nargs > 2) {
+    source = match_result(executor, args[2], TYPE_ROOM,
+                          MAT_HERE | MAT_ABSOLUTE | MAT_TYPE);
+    if (source == NOTHING) {
+      safe_str(T("#-1 INVALID SOURCE ROOM"), buff, bp);
+      return;
+    }
+  }
+  safe_dbref(do_real_open
+             (executor, args[0], (nargs > 1 ? args[1] : NULL), source), buff,
+             bp);
 }
 
 /* ARGSUSED */
Index: src/sql.c
===================================================================
--- src/sql.c	(.../184p0)	(revision 575)
+++ src/sql.c	(.../184p1)	(revision 575)
@@ -882,8 +882,7 @@
 static void
 penn_mysql_free_sql_query(MYSQL_RES * qres)
 {
-  MYSQL_ROW row_p;
-  while ((row_p = mysql_fetch_row(qres)) != NULL) ;
+  while (mysql_fetch_row(qres)) ;
   mysql_free_result(qres);
 }
 
Index: src/utils.c
===================================================================
--- src/utils.c	(.../184p0)	(revision 575)
+++ src/utils.c	(.../184p1)	(revision 575)
@@ -557,7 +557,7 @@
                 "Couldn't read from /dev/urandom! Resorting to normal seeding method.");
     } else {
       do_rawlog(LT_ERR, "Seeded RNG from /dev/urandom");
-      init_by_array(buf, r / sizeof(unsigned long));
+      init_by_array(buf, r / sizeof(uint32_t));
       return;
     }
   } else
@@ -658,9 +658,7 @@
     return n;
   }
 
-  mush_strncpy(n, s, BUFFER_LEN);
-  if ((s = strchr(n, ';')))
-    *s = '\0';
+  copy_up_to(n, s, ';');
 
   return n;
 }
Index: src/extchat.c
===================================================================
--- src/extchat.c	(.../184p0)	(revision 575)
+++ src/extchat.c	(.../184p1)	(revision 575)
@@ -520,7 +520,7 @@
   char *tmp;
   CHANUSER *user;
   dbref player;
-  for (i = 0; i < ChanNumUsers(ch); i++) {
+  for (i = ChanNumUsers(ch); i > 0; i--) {
     db_read_this_labeled_dbref(fp, "dbref", &player);
     /* Don't bother if the player isn't a valid dbref or the wrong type */
     if (GoodObject(player) && Chan_Ok_Type(ch, player)) {
@@ -1265,7 +1265,7 @@
       notify_format(player,
                     T("CHAT: You join %s to channel <%s>."), Name(victim),
                     ChanName(chan));
-      u = onchannel(victim, chan);
+      onchannel(victim, chan);
       ChanNumUsers(chan)++;
       if (!Channel_Quiet(chan) && !DarkLegal(victim)) {
         channel_send(chan, victim,
@@ -1318,7 +1318,6 @@
 channel_join_self(dbref player, const char *name)
 {
   CHAN *chan = NULL;
-  CHANUSER *u;
 
   if (Guest(player)) {
     notify(player, T("Guests are not allowed to join channels."));
@@ -1364,7 +1363,7 @@
   }
   if (insert_user_by_dbref(player, chan)) {
     notify_format(player, T("CHAT: You join channel <%s>."), ChanName(chan));
-    u = onchannel(player, chan);
+    onchannel(player, chan);
     ChanNumUsers(chan)++;
     if (!Channel_Quiet(chan) && !DarkLegal(player))
       channel_send(chan, player,
@@ -1530,7 +1529,6 @@
 do_chat(dbref player, CHAN *chan, const char *arg1)
 {
   CHANUSER *u;
-  const char *gap;
   char type;
   bool canhear;
 
@@ -1569,11 +1567,9 @@
   }
 
   /* figure out what kind of message we have */
-  gap = " ";
   type = ':';
   switch (*arg1) {
   case SEMI_POSE_TOKEN:
-    gap = "";
     type = ';';
     /* FALLTHRU */
   case POSE_TOKEN:
@@ -2824,10 +2820,15 @@
                       bufferq_blocks(ChanBufferQ(c)));
       if (!brief) {
         for (u = ChanUsers(c); u; u = u->next) {
-          if (!Chanuser_Hide(u) || Priv_Who(player))
-
-            notify_format(player, "@channel/on %s = %s", ChanName(c),
-                          Name(CUdbref(u)));
+          if (!Chanuser_Hide(u) || Priv_Who(player)) {
+            if (IsPlayer(CUdbref(u))) {
+              notify_format(player, "@channel/on %s = *%s", ChanName(c),
+                            Name(CUdbref(u)));
+            } else {
+              notify_format(player, "@channel/on %s = #%d", ChanName(c),
+                            CUdbref(u));
+            }
+          }
         }
       }
     }
@@ -3801,8 +3802,7 @@
   }
   if (recall_timestring) {
     num_lines = 0;
-    while ((buf =
-            iter_bufferq(ChanBufferQ(chan), &p, &speaker, &type, &timestamp))) {
+    while (iter_bufferq(ChanBufferQ(chan), &p, &speaker, &type, &timestamp)) {
       if (timestamp >= recall_from)
         num_lines++;
     }
@@ -3818,7 +3818,7 @@
   all = (start <= 0 && num_lines >= BufferQNum(ChanBufferQ(chan)));
   notify_format(player, T("CHAT: Recall from channel <%s>"), ChanName(chan));
   while (start > 0) {
-    buf = iter_bufferq(ChanBufferQ(chan), &p, &speaker, &type, &timestamp);
+    iter_bufferq(ChanBufferQ(chan), &p, &speaker, &type, &timestamp);
     start--;
   }
   while ((buf = iter_bufferq(ChanBufferQ(chan), &p, &speaker, &type,
Index: src/Makefile.in
===================================================================
--- src/Makefile.in	(.../184p0)	(revision 575)
+++ src/Makefile.in	(.../184p1)	(revision 575)
@@ -368,6 +368,7 @@
 chunk.o: ../confmagic.h
 chunk.o: ../hdrs/mypcre.h
 chunk.o: ../hdrs/command.h
+chunk.o: ../hdrs/boolexp.h
 chunk.o: ../hdrs/switches.h
 chunk.o: ../hdrs/intrface.h
 chunk.o: ../hdrs/log.h
@@ -390,6 +391,7 @@
 cmdlocal.o: ../hdrs/mypcre.h
 cmdlocal.o: ../hdrs/parse.h
 cmdlocal.o: ../hdrs/command.h
+cmdlocal.o: ../hdrs/boolexp.h
 cmdlocal.o: ../hdrs/switches.h
 cmdlocal.o: ../hdrs/cmds.h
 cmds.o: ../hdrs/copyrite.h
@@ -448,6 +450,7 @@
 command.o: ../hdrs/strtree.h
 command.o: ../hdrs/function.h
 command.o: ../hdrs/command.h
+command.o: ../hdrs/boolexp.h
 command.o: ../hdrs/switches.h
 command.o: ../hdrs/mymalloc.h
 command.o: ../hdrs/log.h
@@ -493,6 +496,7 @@
 conf.o: ../hdrs/pueblo.h
 conf.o: ../hdrs/parse.h
 conf.o: ../hdrs/command.h
+conf.o: ../hdrs/boolexp.h
 conf.o: ../hdrs/switches.h
 conf.o: ../hdrs/log.h
 conf.o: ../hdrs/game.h
@@ -506,16 +510,17 @@
 cque.o: ../hdrs/mushtype.h
 cque.o: ../hdrs/htab.h
 cque.o: ../hdrs/command.h
+cque.o: ../hdrs/boolexp.h
+cque.o: ../hdrs/chunk.h
+cque.o: ../hdrs/dbio.h
 cque.o: ../hdrs/switches.h
 cque.o: ../hdrs/mushdb.h
 cque.o: ../hdrs/flags.h
 cque.o: ../hdrs/ptab.h
-cque.o: ../hdrs/dbio.h
 cque.o: ../hdrs/match.h
 cque.o: ../hdrs/externs.h
 cque.o: ../hdrs/compile.h
 cque.o: ../hdrs/dbdefs.h
-cque.o: ../hdrs/chunk.h
 cque.o: ../confmagic.h
 cque.o: ../hdrs/mypcre.h
 cque.o: ../hdrs/parse.h
@@ -607,6 +612,7 @@
 destroy.o: ../hdrs/attrib.h
 destroy.o: ../hdrs/lock.h
 destroy.o: ../hdrs/boolexp.h
+destroy.o: ../hdrs/parse.h
 extchat.o: ../hdrs/copyrite.h
 extchat.o: ../config.h
 extchat.o: ../hdrs/conf.h
@@ -721,6 +727,7 @@
 flags.o: ../confmagic.h
 flags.o: ../hdrs/mypcre.h
 flags.o: ../hdrs/command.h
+flags.o: ../hdrs/boolexp.h
 flags.o: ../hdrs/switches.h
 flags.o: ../hdrs/attrib.h
 flags.o: ../hdrs/parse.h
@@ -728,7 +735,6 @@
 flags.o: ../hdrs/privtab.h
 flags.o: ../hdrs/game.h
 flags.o: ../hdrs/lock.h
-flags.o: ../hdrs/boolexp.h
 flags.o: ../hdrs/log.h
 flags.o: ../hdrs/sort.h
 flags.o: ../hdrs/mymalloc.h
@@ -808,11 +814,11 @@
 fundb.o: ../hdrs/match.h
 fundb.o: ../hdrs/parse.h
 fundb.o: ../hdrs/command.h
+fundb.o: ../hdrs/boolexp.h
 fundb.o: ../hdrs/switches.h
 fundb.o: ../hdrs/game.h
 fundb.o: ../hdrs/privtab.h
 fundb.o: ../hdrs/lock.h
-fundb.o: ../hdrs/boolexp.h
 fundb.o: ../hdrs/log.h
 fundb.o: ../hdrs/attrib.h
 fundb.o: ../hdrs/function.h
@@ -839,10 +845,10 @@
 funlist.o: ../hdrs/mymalloc.h
 funlist.o: ../hdrs/match.h
 funlist.o: ../hdrs/command.h
+funlist.o: ../hdrs/boolexp.h
 funlist.o: ../hdrs/switches.h
 funlist.o: ../hdrs/attrib.h
 funlist.o: ../hdrs/lock.h
-funlist.o: ../hdrs/boolexp.h
 funlist.o: ../hdrs/sort.h
 funlocal.o: ../hdrs/copyrite.h
 funlocal.o: ../config.h
@@ -976,6 +982,7 @@
 funufun.o: ../hdrs/attrib.h
 funufun.o: ../hdrs/lock.h
 funufun.o: ../hdrs/boolexp.h
+funufun.o: ../hdrs/function.h
 game.o: ../hdrs/copyrite.h
 game.o: ../config.h
 game.o: ../hdrs/conf.h
@@ -1031,6 +1038,7 @@
 help.o: ../confmagic.h
 help.o: ../hdrs/mypcre.h
 help.o: ../hdrs/command.h
+help.o: ../hdrs/boolexp.h
 help.o: ../hdrs/switches.h
 help.o: ../hdrs/help.h
 help.o: ../hdrs/log.h
@@ -1054,6 +1062,7 @@
 htab.o: ../hdrs/chunk.h
 htab.o: ../confmagic.h
 htab.o: ../hdrs/mypcre.h
+htab.o: ../hdrs/log.h
 htab.o: ../hdrs/mymalloc.h
 ident.o: ../config.h
 ident.o: ../hdrs/conf.h
@@ -1111,9 +1120,9 @@
 local.o: ../hdrs/mypcre.h
 local.o: ../hdrs/parse.h
 local.o: ../hdrs/command.h
+local.o: ../hdrs/boolexp.h
 local.o: ../hdrs/switches.h
 local.o: ../hdrs/lock.h
-local.o: ../hdrs/boolexp.h
 lock.o: ../hdrs/copyrite.h
 lock.o: ../config.h
 lock.o: ../hdrs/conf.h
@@ -1253,6 +1262,7 @@
 match.o: ../hdrs/case.h
 match.o: ../hdrs/match.h
 match.o: ../hdrs/parse.h
+match.o: ../hdrs/attrib.h
 memcheck.o: ../config.h
 memcheck.o: ../hdrs/conf.h
 memcheck.o: ../hdrs/copyrite.h
@@ -1607,16 +1617,17 @@
 set.o: ../hdrs/attrib.h
 set.o: ../hdrs/ansi.h
 set.o: ../hdrs/command.h
+set.o: ../hdrs/boolexp.h
 set.o: ../hdrs/switches.h
 set.o: ../hdrs/mymalloc.h
 set.o: ../hdrs/lock.h
-set.o: ../hdrs/boolexp.h
 set.o: ../hdrs/log.h
 set.o: ../hdrs/game.h
 SFMT.o: ../config.h
 SFMT.o: ../hdrs/SFMT.h
 SFMT.o: ../hdrs/SFMT-params.h
 SFMT.o: ../hdrs/SFMT-params19937.h
+SFMT.o: ../hdrs/SFMT-sse2.h
 shs.o: ../hdrs/copyrite.h
 shs.o: ../config.h
 sig.o: ../config.h
@@ -1654,6 +1665,7 @@
 sort.o: ../hdrs/parse.h
 sort.o: ../hdrs/ansi.h
 sort.o: ../hdrs/command.h
+sort.o: ../hdrs/boolexp.h
 sort.o: ../hdrs/switches.h
 sort.o: ../hdrs/sort.h
 speech.o: ../hdrs/copyrite.h
@@ -1700,6 +1712,7 @@
 sql.o: ../hdrs/log.h
 sql.o: ../hdrs/parse.h
 sql.o: ../hdrs/command.h
+sql.o: ../hdrs/boolexp.h
 sql.o: ../hdrs/switches.h
 sql.o: ../hdrs/function.h
 sql.o: ../hdrs/ansi.h
@@ -1841,6 +1854,7 @@
 version.o: ../hdrs/mypcre.h
 version.o: ../hdrs/version.h
 version.o: ../hdrs/buildinf.h
+version.o: ../hdrs/svninfo.h
 wait.o: ../config.h
 warnings.o: ../config.h
 warnings.o: ../hdrs/copyrite.h
@@ -1910,3 +1924,4 @@
 wiz.o: ../hdrs/command.h
 wiz.o: ../hdrs/switches.h
 wiz.o: ../hdrs/extmail.h
+wiz.o: ../hdrs/ansi.h
Index: src/malias.c
===================================================================
--- src/malias.c	(.../184p0)	(revision 575)
+++ src/malias.c	(.../184p1)	(revision 575)
@@ -869,7 +869,6 @@
     notify(player, T("Permission denied."));
     return;
   }
-  i = 0;
 
   /*
    * Parse the player list
Index: src/myssl.c
===================================================================
--- src/myssl.c	(.../184p0)	(revision 575)
+++ src/myssl.c	(.../184p1)	(revision 575)
@@ -114,8 +114,8 @@
 SSL_CTX *
 ssl_init(char *private_key_file, char *ca_file, int req_client_cert)
 {
-  const SSL_METHOD *meth; /* If this const gives you a warning, you're
-			     using an old version of OpenSSL. */
+  const SSL_METHOD *meth;       /* If this const gives you a warning, you're
+                                   using an old version of OpenSSL. */
   unsigned char context[128];
   DH *dh;
   unsigned int reps = 1;
@@ -359,10 +359,9 @@
 {
   int ret;
   int state = 0;
-  int err;
 
   if ((ret = SSL_do_handshake(ssl)) <= 0) {
-    switch (err = SSL_get_error(ssl, ret)) {
+    switch (SSL_get_error(ssl, ret)) {
     case SSL_ERROR_WANT_READ:
       /* We must want for the socket to be readable, and then repeat
        * the call.
@@ -542,7 +541,6 @@
     switch (SSL_get_error(ssl, r)) {
     case SSL_ERROR_NONE:
       /* We wrote something, but maybe not all */
-      bufsize -= r;
       *offset += r;
       break;
     case SSL_ERROR_WANT_WRITE:
Index: src/wiz.c
===================================================================
--- src/wiz.c	(.../184p0)	(revision 575)
+++ src/wiz.c	(.../184p1)	(revision 575)
@@ -47,6 +47,8 @@
 #include "command.h"
 #include "dbdefs.h"
 #include "extmail.h"
+#include "boolexp.h"
+#include "ansi.h"
 
 
 #include "confmagic.h"
@@ -806,7 +808,7 @@
 void
 do_boot(dbref player, const char *name, enum boot_type flag, int silent)
 {
-  dbref victim;
+  dbref victim = NOTHING;
   DESC *d = NULL;
   int count = 0;
   int priv = Can_Boot(player);
@@ -951,7 +953,7 @@
  * \param target string containing new zone master for objects.
  */
 void
-do_chzoneall(dbref player, const char *name, const char *target)
+do_chzoneall(dbref player, const char *name, const char *target, bool preserve)
 {
   int i;
   dbref victim;
@@ -989,7 +991,7 @@
    * consistency on things like flag resetting, etc... */
   for (i = 0; i < db_top; i++) {
     if (Owner(i) == victim && Zone(i) != zone) {
-      count += do_chzone(player, unparse_dbref(i), target, 0);
+      count += do_chzone(player, unparse_dbref(i), target, 0, preserve);
     }
   }
   notify_format(player, T("Zone changed for %d objects."), count);
@@ -1221,13 +1223,14 @@
   } else if (nresults > 0) {
     /* Split the results up by type and report. */
     int n;
-    int nthings = 0, nexits = 0, nrooms = 0, nplayers = 0;
-    dbref *things, *exits, *rooms, *players;
+    int nthings = 0, nexits = 0, nrooms = 0, nplayers = 0, ngarbage = 0;
+    dbref *things, *exits, *rooms, *players, *garbage;
 
     things = mush_calloc(nresults, sizeof(dbref), "dbref_list");
     exits = mush_calloc(nresults, sizeof(dbref), "dbref_list");
     rooms = mush_calloc(nresults, sizeof(dbref), "dbref_list");
     players = mush_calloc(nresults, sizeof(dbref), "dbref_list");
+    garbage = mush_calloc(nresults, sizeof(dbref), "dbref_list");
 
     for (n = 0; n < nresults; n++) {
       switch (Typeof(results[n])) {
@@ -1243,6 +1246,9 @@
       case TYPE_PLAYER:
         players[nplayers++] = results[n];
         break;
+      case TYPE_GARBAGE:
+        garbage[ngarbage++] = results[n];
+        break;
       default:
         /* Unknown type. Ignore. */
         do_rawlog(LT_ERR, "Weird type for dbref #%d", results[n]);
@@ -1314,15 +1320,34 @@
       }
     }
 
+    if (ngarbage) {
+      notify(player, T("\nGARBAGE:"));
+      for (n = 0; n < ngarbage; n++) {
+        tbp = tbuf;
+        if (ANSI_NAMES && ShowAnsi(player))
+          notify_format(player, T("%sGarbage%s(#%d)"), ANSI_HILITE, ANSI_END,
+                        garbage[n]);
+        else
+          notify_format(player, T("Garbage(#%d)"), garbage[n]);
+      }
+    }
+
     notify(player, T("----------  Search Done  ----------"));
-    notify_format(player,
-                  T
-                  ("Totals: Rooms...%d  Exits...%d  Things...%d  Players...%d"),
-                  nrooms, nexits, nthings, nplayers);
+    if (ngarbage)
+      notify_format(player,
+                    T
+                    ("Totals: Rooms...%d  Exits...%d  Things...%d  Players...%d  Garbage...%d"),
+                    nrooms, nexits, nthings, nplayers, ngarbage);
+    else
+      notify_format(player,
+                    T
+                    ("Totals: Rooms...%d  Exits...%d  Things...%d  Players...%d"),
+                    nrooms, nexits, nthings, nplayers);
     mush_free(rooms, "dbref_list");
     mush_free(exits, "dbref_list");
     mush_free(things, "dbref_list");
     mush_free(players, "dbref_list");
+    mush_free(garbage, "dbref_list");
   }
   if (results)
     mush_free(results, "search_results");
@@ -1489,6 +1514,14 @@
       /* List bad sites */
       do_list_access(player);
       return;
+    case SITELOCK_REGISTER:
+      if (add_access_sitelock
+          (player, site, AMBIGUOUS, ACS_REGISTER, ACS_CREATE)) {
+        write_access_file();
+        notify_format(player, T("Site %s locked"), site);
+        do_log(LT_WIZ, player, NOTHING, "*** SITELOCK *** %s", site);
+      }
+      break;
     case SITELOCK_ADD:
       if (add_access_sitelock(player, site, AMBIGUOUS, 0, ACS_CREATE)) {
         write_access_file();
@@ -1947,7 +1980,6 @@
   return 0;
 }
 
-
 /* Does the actual searching */
 static int
 raw_search(dbref player, const char *owner, int nargs, const char **args,
@@ -1969,29 +2001,30 @@
     return -1;
   }
 
-  /* make sure player has money to do the search -
-   * But only if this does an eval or lock search. */
-  if ((spec.lock != TRUE_BOOLEXP) ||
-      spec.cmdstring[0] || spec.listenstring[0] || spec.eval[0]) {
-    if (!payfor(player, FIND_COST)) {
-      notify_format(player, T("Searches cost %d %s."), FIND_COST,
-                    ((FIND_COST == 1) ? MONEY : MONIES));
-      return -1;
-    }
-  }
-
   is_wiz = Search_All(player) || See_All(player);
 
   if ((spec.owner != ANY_OWNER && spec.owner != Owner(player)) &&
       !(is_wiz || (spec.type == TYPE_PLAYER) ||
         (ZMaster(spec.owner) && eval_lock(player, spec.owner, Zone_Lock)))) {
-    giveto(player, FIND_COST);
     notify(player, T("You need a search warrant to do that!"));
     if (spec.lock != TRUE_BOOLEXP)
       free_boolexp(spec.lock);
     return -1;
   }
 
+  /* make sure player has money to do the search -
+   * But only if this does an eval or lock search. */
+  if (((spec.lock != TRUE_BOOLEXP) && is_eval_lock(spec.lock)) ||
+      spec.cmdstring[0] || spec.listenstring[0] || spec.eval[0]) {
+    if (!payfor(player, FIND_COST)) {
+      notify_format(player, T("Searches cost %d %s."), FIND_COST,
+                    ((FIND_COST == 1) ? MONEY : MONIES));
+      if (spec.lock != TRUE_BOOLEXP)
+        free_boolexp(spec.lock);
+      return -1;
+    }
+  }
+
   result_size = (db_top / 4) + 1;
   *result = mush_calloc(result_size, sizeof(dbref), "search_results");
   if (!*result)
Index: src/conf.c
===================================================================
--- src/conf.c	(.../184p0)	(revision 575)
+++ src/conf.c	(.../184p1)	(revision 575)
@@ -48,6 +48,7 @@
 
 OPTTAB options;         /**< The table of configuration options */
 HASHTAB local_options;  /**< Hash table for local config options */
+MSSP *mssp;             /**< Linked list of MSSP values */
 
 int config_set(const char *opt, char *val, int source, int restrictions);
 void conf_default_set(void);
@@ -914,6 +915,39 @@
 
 }
 
+int
+add_mssp(char *name, char *value)
+{
+  MSSP *opt = NULL, *last;
+
+  /* Validate name and value */
+  while (*name && *name == ' ')
+    name++;
+  /* names/values cannot contain IAC(255), MSSP_VAR (1) or MSSP_VAL (2) */
+  if (!name || (strchr(name, (char) 255) || strchr(name, (char) 1) ||
+                strchr(name, (char) 2)))
+    return 0;
+  if (strchr(value, (char) 255) || strchr(value, (char) 1) ||
+      strchr(value, (char) 2))
+    return 0;
+
+  upcasestr(name);
+  opt = mush_malloc(sizeof(MSSP), "mssp");
+  if (!mssp) {
+    mssp = opt;
+  } else {
+    last = mssp;
+    while (last->next) {
+      last = last->next;
+    }
+    last->next = opt;
+  }
+  opt->name = mush_strndup(name, 50, "mssp.name");
+  opt->value = mush_strndup(value, 150, "mssp.value");
+  opt->next = NULL;
+  return 1;
+}
+
 /** Set a configuration option.
  * This function sets a runtime configuration option. During the load
  * of the configuration file, it gets run twice - once to set the
@@ -992,6 +1026,24 @@
     if (source == 2)
       append_restriction("restrict_function", val, p);
     return 1;
+  } else if (!strcasecmp(opt, "restrict_attribute")) {
+    if (!restrictions || source > 0)
+      return 0;
+    for (p = val; *p && !isspace((unsigned char) *p); p++) ;
+    if (*p) {
+      *p++ = '\0';
+      if (!cnf_attribute_access(val, p)) {
+        do_rawlog(LT_ERR, "CONFIG: Couldn't restrict attribute %s to %s", val,
+                  p);
+        return 0;
+      }
+    } else {
+      do_rawlog(LT_ERR,
+                "CONFIG: restrict_attribute %s requires a restriction (use 'none' for none)",
+                val);
+      return 0;
+    }
+    return 1;
   } else if (!strcasecmp(opt, "reserve_alias")) {
     if (!restrictions)
       return 0;
@@ -1018,6 +1070,56 @@
     if (source == 2)
       append_restriction("reserve_alias", val, p);
     return 1;
+  } else if (!strcasecmp(opt, "hook_command")) {
+    if (!restrictions || source > 0)
+      return 0;
+    for (p = val; *p && !isspace((unsigned char) *p); p++) ;
+    if (*p) {
+      *p++ = '\0';
+      if (!cnf_hook_command(val, p)) {
+        do_rawlog(LT_ERR, "CONFIG: Couldn't hook command %s with options %s",
+                  val, p);
+        return 0;
+      }
+    } else {
+      do_rawlog(LT_ERR, "CONFIG: hook_command %s requires a hook type", val);
+      return 0;
+    }
+    return 1;
+  } else if (!strcasecmp(opt, "add_command")) {
+    if (!restrictions || source > 0)
+      return 0;
+    for (p = val; *p && !isspace((unsigned char) *p); p++) ;
+    if (*p) {
+      *p++ = '\0';
+      if (!cnf_add_command(val, p)) {
+        do_rawlog(LT_ERR, "CONFIG: Couldn't add command %s with flags %s", val,
+                  p);
+        return 0;
+      }
+    } else {
+      if (!cnf_add_command(val, NULL)) {
+        do_rawlog(LT_ERR, "CONFIG: Couldn't add command %s", val);
+        return 0;
+      }
+    }
+    return 1;
+  } else if (!strcasecmp(opt, "add_function")) {
+    if (!restrictions || source > 0)
+      return 0;
+    for (p = val; *p && !isspace((unsigned char) *p); p++) ;
+    if (*p) {
+      *p++ = '\0';
+      if (!cnf_add_function(val, p)) {
+        do_rawlog(LT_ERR, "CONFIG: Couldn't add function %s with options %s",
+                  val, p);
+        return 0;
+      }
+    } else {
+      do_rawlog(LT_ERR, "CONFIG: add_function %s requires an obj/attr", val);
+      return 0;
+    }
+    return 1;
   } else if (!strcasecmp(opt, "attribute_alias")) {
     if (!restrictions)
       return 0;
@@ -1085,6 +1187,16 @@
                 "CONFIG: help_command requires a command name and file name.");
       return 0;
     }
+  } else if (!strcasecmp(opt, "mssp")) {
+    if (restrictions)
+      return 0;
+    if ((p = strchr(val, '/')) != NULL) {
+      *p++ = '\0';
+      return add_mssp((char *) val, p);
+    } else {
+      do_rawlog(LT_ERR, "CONFIG: mssp requires option/value");
+      return 0;
+    }
   } else if (restrictions) {
     return 0;
   }
@@ -1510,6 +1622,23 @@
           }
         }
       }
+      if (!found) {
+        /* Try a wildcard search of option names, including local options */
+        char *wild = tprintf("*%s*", type);
+        for (cp = conftable; cp->name; cp++) {
+          if (cp->group && quick_wild(wild, cp->name)) {
+            found = 1;
+            notify(player, config_to_string(player, cp, lc));
+          }
+        }
+        for (cp = (PENNCONF *) hash_firstentry(&local_options); cp;
+             cp = (PENNCONF *) hash_nextentry(&local_options)) {
+          if (cp->group && quick_wild(wild, cp->name)) {
+            found = 1;
+            notify(player, config_to_string(player, cp, lc));
+          }
+        }
+      }
       if (!found) {
         /* Wasn't found at all. Ok. */
         notify(player, T("I only know the following types of options:"));
Index: src/attrib.c
===================================================================
--- src/attrib.c	(.../184p0)	(revision 575)
+++ src/attrib.c	(.../184p1)	(revision 575)
@@ -1795,49 +1795,62 @@
     return 0;
   strcpy(name, atr);
   upcasestr(name);
-  if (!strcmp(name, "ALIAS") && IsPlayer(thing)) {
-    old = atr_get_noparent(thing, "ALIAS");
-    tbuf1[0] = '\0';
-    if (old) {
-      /* Old alias - we're allowed to change to a different case */
-      strcpy(tbuf1, atr_value(old));
-      if (s && !*s) {
-        notify_format(player, T("'%s' is not a valid alias."), s);
-        return -1;
-      }
-      if (s && strcasecmp(s, tbuf1)) {
-        int opae_res = ok_player_alias(s, player, thing);
-        switch (opae_res) {
-        case OPAE_INVALID:
+  if (strcmp(name, "ALIAS") == 0) {
+    if (IsPlayer(thing)) {
+      old = atr_get_noparent(thing, "ALIAS");
+      tbuf1[0] = '\0';
+      if (old) {
+        /* Old alias - we're allowed to change to a different case */
+        strcpy(tbuf1, atr_value(old));
+        if (s && !*s) {
           notify_format(player, T("'%s' is not a valid alias."), s);
-          break;
-        case OPAE_TOOMANY:
-          notify_format(player, T("'%s' contains too many aliases."), s);
-          break;
-        case OPAE_NULL:
-          notify_format(player, T("Null aliases are not valid."));
-          break;
-        }
-        if (opae_res != OPAE_SUCCESS)
           return -1;
-      }
-    } else {
-      /* No old alias */
-      if (s && *s) {
-        int opae_res = ok_player_alias(s, player, thing);
-        switch (opae_res) {
-        case OPAE_INVALID:
-          notify_format(player, T("'%s' is not a valid alias."), s);
-          break;
-        case OPAE_TOOMANY:
-          notify_format(player, T("'%s' contains too many aliases."), s);
-          break;
-        case OPAE_NULL:
-          notify_format(player, T("Null aliases are not valid."));
-          break;
         }
-        if (opae_res != OPAE_SUCCESS)
+        if (s && strcasecmp(s, tbuf1)) {
+          int opae_res = ok_player_alias(s, player, thing);
+          switch (opae_res) {
+          case OPAE_INVALID:
+            notify_format(player, T("'%s' is not a valid alias."), s);
+            break;
+          case OPAE_TOOMANY:
+            notify_format(player, T("'%s' contains too many aliases."), s);
+            break;
+          case OPAE_NULL:
+            notify_format(player, T("Null aliases are not valid."));
+            break;
+          }
+          if (opae_res != OPAE_SUCCESS)
+            return -1;
+        }
+      } else {
+        /* No old alias */
+        if (s && *s) {
+          int opae_res = ok_player_alias(s, player, thing);
+          switch (opae_res) {
+          case OPAE_INVALID:
+            notify_format(player, T("'%s' is not a valid alias."), s);
+            break;
+          case OPAE_TOOMANY:
+            notify_format(player, T("'%s' contains too many aliases."), s);
+            break;
+          case OPAE_NULL:
+            notify_format(player, T("Null aliases are not valid."));
+            break;
+          }
+          if (opae_res != OPAE_SUCCESS)
+            return -1;
+        }
+      }
+    } else if (IsExit(thing) && s && *s) {
+      char *alias, *aliases;
+
+      strcpy(tbuf1, s);
+      aliases = tbuf1;
+      while ((alias = split_token(&aliases, ';')) != NULL) {
+        if (!ok_name(alias)) {
+          notify_format(player, T("'%s' is not a valid exit name."), alias);
           return -1;
+        }
       }
     }
   } else if (s && *s && (!strcmp(name, "FORWARDLIST")
@@ -2078,7 +2091,7 @@
     return;
   }
 
-  if ((!arg2 && !*arg2) || !strcasecmp(arg2, "me"))
+  if (!(arg2 && *arg2) || !strcasecmp(arg2, "me"))
     new_owner = player;
   else
     new_owner = lookup_player(arg2);
Index: src/db.c
===================================================================
--- src/db.c	(.../184p0)	(revision 575)
+++ src/db.c	(.../184p1)	(revision 575)
@@ -770,7 +770,6 @@
   char tbuf1[BUFFER_LEN];
   int err = 0;
   char *p;
-  char lastp;
   dbref owner;
   int fixmemdb = 0;
   int count = 0;
@@ -839,7 +838,6 @@
     /* now check the attribute */
     strcpy(tbuf1, atr_value(list));
     /* get rid of unprintables and hard newlines */
-    lastp = '\0';
     for (p = tbuf1; *p; p++) {
       if (!isprint((unsigned char) *p) && !isspace((unsigned char) *p) &&
           *p != TAG_START && *p != TAG_END && *p != ESC_CHAR
@@ -847,7 +845,6 @@
         *p = '!';
         err = 1;
       }
-      lastp = *p;
     }
     if (err) {
       fixmemdb = 1;
@@ -1470,9 +1467,7 @@
       /* If there are channels in the db, read 'em in */
       /* We don't support this anymore, so we just discard them */
       if (!(globals.indb_flags & DBF_NO_CHAT_SYSTEM))
-        temp = getref(f);
-      else
-        temp = 0;
+        getref(f);
 
       /* If there are warnings in the db, read 'em in */
       temp = MAYBE_GET(f, DBF_WARNINGS);
Index: src/function.c
===================================================================
--- src/function.c	(.../184p0)	(revision 575)
+++ src/function.c	(.../184p1)	(revision 575)
@@ -493,7 +493,7 @@
   {"LAST", fun_last, 1, 2, FN_REG},
   {"LATTR", fun_lattr, 1, 2, FN_REG | FN_STRIPANSI},
   {"LATTRP", fun_lattr, 1, 2, FN_REG | FN_STRIPANSI},
-  {"LCON", fun_dbwalker, 1, 1, FN_REG | FN_STRIPANSI},
+  {"LCON", fun_dbwalker, 1, 2, FN_REG | FN_STRIPANSI},
   {"LCSTR", fun_lcstr, 1, -1, FN_REG},
   {"LDELETE", fun_ldelete, 2, 3, FN_REG},
   {"LEFT", fun_left, 2, 2, FN_REG},
@@ -611,7 +611,7 @@
   {"OBJID", fun_objid, 1, 1, FN_REG | FN_STRIPANSI},
   {"OBJMEM", fun_objmem, 1, 1, FN_REG | FN_STRIPANSI},
   {"OEMIT", fun_oemit, 2, -2, FN_REG},
-  {"OPEN", fun_open, 2, 2, FN_REG},
+  {"OPEN", fun_open, 1, 3, FN_REG},
   {"OR", fun_or, 2, INT_MAX, FN_REG | FN_STRIPANSI},
   {"ORD", fun_ord, 1, 1, FN_REG | FN_STRIPANSI},
   {"ORDINAL", fun_spellnum, 1, 1, FN_REG | FN_STRIPANSI},
@@ -1340,6 +1340,95 @@
     return 1;
 }
 
+/* Add a user-defined function from cnf file */
+int
+cnf_add_function(char *name, char *opts)
+{
+  FUN *fp;
+  dbref thing;
+  int minargs[2] = { 0, 0 };
+  int maxargs[2] = { 0, 0 };
+  char *attrname, *one, *list;
+
+  name = trim_space_sep(name, ' ');
+  upcasestr(name);
+
+  if (!ok_function_name(name))
+    return 0;
+
+  /* Validate arguments */
+  list = trim_space_sep(opts, ' ');
+  if (!list)
+    return 0;
+  one = split_token(&list, ' ');
+  if ((attrname = strchr(one, '/')) == NULL)
+    return 0;
+  *attrname++ = '\0';
+  upcasestr(attrname);
+  /* Don't care if the attr exists, only if it /could/ exist */
+  if (!is_integer(one) || !good_atr_name(attrname))
+    return 0;
+  thing = (dbref) parse_integer(one);
+  if (!GoodObject(thing) || IsGarbage(thing))
+    return 0;
+  if (list) {
+    /* min/max args */
+    one = split_token(&list, ' ');
+    if (!is_strict_integer(one))
+      return 0;
+    minargs[0] = parse_integer(one);
+    minargs[1] = 1;
+    if (minargs[0] < 0 || minargs[0] > 10)
+      minargs[0] = 0;
+    if (list) {
+      /* max args */
+      one = split_token(&list, ' ');
+      if (!is_strict_integer(one))
+        return 0;
+      maxargs[0] = parse_integer(one);
+      maxargs[1] = 1;
+      if (maxargs[0] < -10)
+        maxargs[0] = -10;
+      else if (maxargs[0] > 10)
+        maxargs[0] = 10;
+    }
+  }
+
+  fp = func_hash_lookup(name);
+  if (fp) {
+    if (fp->flags & FN_BUILTIN) {
+      /* Override built-in function */
+      fp->flags |= FN_OVERRIDE;
+      fp = NULL;
+    } else {
+      if (fp->where.ufun->name) {
+        mush_free(fp->where.ufun->name, "userfn.name");
+      }
+    }
+  }
+
+  if (!fp) {
+    /* Create new userfunction */
+    fp = slab_malloc(function_slab, NULL);
+    fp->name = mush_strdup(name, "func_hash.name");
+    fp->where.ufun = mush_malloc(sizeof(USERFN_ENTRY), "userfn");
+    fp->minargs = 0;
+    fp->maxargs = 10;
+    hashadd(name, fp, &htab_user_function);
+  }
+
+  fp->where.ufun->thing = thing;
+  fp->where.ufun->name = mush_strdup(upcasestr(attrname), "userfn.name");
+  if (minargs[1])
+    fp->minargs = minargs[0];
+  if (maxargs[1])
+    fp->maxargs = maxargs[0];
+
+
+  return 1;
+
+}
+
 /** Add a user-defined function.
  * \verbatim
  * This is the implementation of the @function command. If no arguments
@@ -1828,7 +1917,6 @@
     if (first == 0)
       safe_strl(", ", 2, tbuf, &tp);
     safe_str("God", tbuf, &tp);
-    first = 0;
   }
 
   *tp = '\0';
Index: src/cmds.c
===================================================================
--- src/cmds.c	(.../184p0)	(revision 575)
+++ src/cmds.c	(.../184p1)	(revision 575)
@@ -120,6 +120,8 @@
                          player, player, cause,
                          PE_COMMAND_BRACES, PT_DEFAULT, NULL);
       *bp++ = '\0';
+    } else {
+      *(global_eval_context.break_replace) = '\0';
     }
   }
 }
@@ -135,6 +137,8 @@
                          player, player, cause,
                          PE_COMMAND_BRACES, PT_DEFAULT, NULL);
       *bp++ = '\0';
+    } else {
+      *(global_eval_context.break_replace) = '\0';
     }
   }
 }
@@ -151,12 +155,12 @@
 
 COMMAND(cmd_chzoneall)
 {
-  do_chzoneall(player, arg_left, arg_right);
+  do_chzoneall(player, arg_left, arg_right, SW_ISSET(sw, SWITCH_PRESERVE));
 }
 
 COMMAND(cmd_chzone)
 {
-  (void) do_chzone(player, arg_left, arg_right, 1);
+  do_chzone(player, arg_left, arg_right, 1, SW_ISSET(sw, SWITCH_PRESERVE));
 }
 
 COMMAND(cmd_config)
@@ -628,6 +632,10 @@
     do_mail_list(player, arg_left);
   else if (SW_ISSET(sw, SWITCH_READ))
     do_mail_read(player, arg_left);
+  else if (SW_ISSET(sw, SWITCH_UNREAD))
+    do_mail_unread(player, arg_left);
+  else if (SW_ISSET(sw, SWITCH_STATUS))
+    do_mail_status(player, arg_left, arg_right);
   else if (SW_ISSET(sw, SWITCH_CLEAR))
     do_mail_clear(player, arg_left);
   else if (SW_ISSET(sw, SWITCH_UNCLEAR))
@@ -1002,7 +1010,7 @@
   if (SW_ISSET(sw, SWITCH_BAN))
     do_sitelock(player, arg_left, NULL, NULL, SITELOCK_BAN);
   else if (SW_ISSET(sw, SWITCH_REGISTER))
-    do_sitelock(player, arg_left, NULL, NULL, SITELOCK_ADD);
+    do_sitelock(player, arg_left, NULL, NULL, SITELOCK_REGISTER);
   else if (SW_ISSET(sw, SWITCH_NAME))
     do_sitelock_name(player, arg_left);
   else if (SW_ISSET(sw, SWITCH_REMOVE))
Index: src/markup.c
===================================================================
--- src/markup.c	(.../184p0)	(revision 575)
+++ src/markup.c	(.../184p1)	(revision 575)
@@ -481,7 +481,7 @@
 }
 
 /* We need EDGE_UP to return 1 if x has bit set and y doesn't. */
-#define EDGE_UP(x,y,z) ((x.bits & z) != (y->bits & z))
+#define EDGE_UP(x,y,z) (((x).bits & (z)) != ((y)->bits & (z)))
 int
 write_raw_ansi_data(ansi_data *old, ansi_data *cur, char *buff, char **bp)
 {
@@ -517,26 +517,22 @@
   }
 
   safe_str(ANSI_BEGIN, buff, bp);
-  if (EDGE_UP(past, cur, CBIT_HILITE)) {
-    if (f++)
-      safe_chr(';', buff, bp);
-    safe_integer(COL_HILITE, buff, bp);
-  }
-  if (EDGE_UP(past, cur, CBIT_INVERT)) {
-    if (f++)
-      safe_chr(';', buff, bp);
-    safe_integer(COL_INVERT, buff, bp);
-  }
-  if (EDGE_UP(past, cur, CBIT_FLASH)) {
-    if (f++)
-      safe_chr(';', buff, bp);
-    safe_integer(COL_FLASH, buff, bp);
-  }
-  if (EDGE_UP(past, cur, CBIT_UNDERSCORE)) {
-    if (f++)
-      safe_chr(';', buff, bp);
-    safe_integer(COL_UNDERSCORE, buff, bp);
-  }
+
+#define maybe_append_code(code) \
+  do { \
+    if (EDGE_UP(past, cur, CBIT_ ## code)) {	\
+      if (f++)				  \
+	safe_chr(';', buff, bp);	  \
+      safe_integer(COL_ ## code, buff, bp); \
+    } \
+  } while (0)
+
+  maybe_append_code(HILITE);
+  maybe_append_code(INVERT);
+  maybe_append_code(FLASH);
+  maybe_append_code(UNDERSCORE);
+
+#undef maybe_append_code
 
   if (pres.fore && pres.fore != past.fore) {
     if (f++)
@@ -544,7 +540,7 @@
     safe_integer(ansi_codes[(unsigned char) pres.fore], buff, bp);
   }
   if (pres.back && pres.back != past.back) {
-    if (f++)
+    if (f)
       safe_chr(';', buff, bp);
     safe_integer(ansi_codes[(unsigned char) pres.back], buff, bp);
   }
@@ -2163,11 +2159,11 @@
 static int
 safe_markup(char const *a_tag, char *buf, char **bp, char type)
 {
-  int result = 0;
+  int result;
   char *save = buf;
-  result = safe_chr(TAG_START, buf, bp);
-  result = safe_chr(type, buf, bp);
-  result = safe_str(a_tag, buf, bp);
+  safe_chr(TAG_START, buf, bp);
+  safe_chr(type, buf, bp);
+  safe_str(a_tag, buf, bp);
   result = safe_chr(TAG_END, buf, bp);
   /* If it didn't all fit, rewind. */
   if (result)
@@ -2196,12 +2192,12 @@
 static int
 safe_markup_cancel(char const *a_tag, char *buf, char **bp, char type)
 {
-  int result = 0;
+  int result;
   char *save = buf;
-  result = safe_chr(TAG_START, buf, bp);
-  result = safe_chr(type, buf, bp);
-  result = safe_chr('/', buf, bp);
-  result = safe_str(a_tag, buf, bp);
+  safe_chr(TAG_START, buf, bp);
+  safe_chr(type, buf, bp);
+  safe_chr('/', buf, bp);
+  safe_str(a_tag, buf, bp);
   result = safe_chr(TAG_END, buf, bp);
   /* If it didn't all fit, rewind. */
   if (result)
@@ -2235,14 +2231,14 @@
   int result = 0;
   char *save = buf;
   if (SUPPORT_PUEBLO) {
-    result = safe_chr(TAG_START, buf, bp);
-    result = safe_chr(MARKUP_HTML, buf, bp);
-    result = safe_str(a_tag, buf, bp);
+    safe_chr(TAG_START, buf, bp);
+    safe_chr(MARKUP_HTML, buf, bp);
+    safe_str(a_tag, buf, bp);
     if (params && *params && ok_tag_attribute(player, params)) {
-      result = safe_chr(' ', buf, bp);
-      result = safe_str(params, buf, bp);
+      safe_chr(' ', buf, bp);
+      safe_str(params, buf, bp);
     }
-    result = safe_chr(TAG_END, buf, bp);
+    safe_chr(TAG_END, buf, bp);
   }
   result = safe_str(data, buf, bp);
   if (SUPPORT_PUEBLO) {
Index: src/access.c
===================================================================
--- src/access.c	(.../184p0)	(revision 575)
+++ src/access.c	(.../184p1)	(revision 575)
@@ -4,14 +4,14 @@
  * \brief Access control lists for PennMUSH.
  * \verbatim
  *
- * The file access.cnf in the game directory will control all 
+ * The file access.cnf in the game directory will control all
  * access-related directives, replacing lockout.cnf and sites.cnf
  *
  * The format of entries in the file will be:
  *
  * wild-host-name    [!]option [!]option [!]option ... # comment
  *
- * A wild-host-name is a wildcard pattern to match hostnames with. 
+ * A wild-host-name is a wildcard pattern to match hostnames with.
  * The wildcard "*" will work like UNIX filename globbing, so
  * *.edu will match all sites with names ending in .edu, and
  * *.*.*.*.* will match all sites with 4 periods in their name.
@@ -50,7 +50,7 @@
  *
  * @sitelock'd sites appear after the line "@sitelock" in the file
  * Using @sitelock writes out the file.
- * 
+ *
  * \endverbatim
  */
 
@@ -211,7 +211,7 @@
   const char *errptr = NULL;
 
   if (access_top) {
-    /* We're reloading the file, so we've got to delete any current 
+    /* We're reloading the file, so we've got to delete any current
      * entries
      */
     free_access_list();
@@ -327,20 +327,6 @@
   return;
 }
 
-#ifdef FORCE_IPV4
-static char *
-ip4_to_ip6(const char *addr)
-{
-  static char tbuf1[BUFFER_LEN];
-  char *bp;
-  bp = tbuf1;
-  safe_format(tbuf1, &bp, "::ffff:%s", addr);
-  *bp = '\0';
-  return tbuf1;
-}
-#endif
-
-
 /** Decide if a host can access someway.
  * \param hname a host or user+host pattern.
  * \param flag the access type we're testing.
Index: src/funmisc.c
===================================================================
--- src/funmisc.c	(.../184p0)	(revision 575)
+++ src/funmisc.c	(.../184p1)	(revision 575)
@@ -40,6 +40,8 @@
   cf_downmotd_msg[BUFFER_LEN], cf_fullmotd_msg[BUFFER_LEN];
 extern HASHTAB htab_function;
 
+extern const unsigned char *tables;
+
 /* ARGSUSED */
 FUNCTION(fun_valid)
 {
@@ -150,7 +152,10 @@
 FUNCTION(fun_remit)
 {
   int ns = (string_prefix(called_as, "NS") && Can_Nspemit(executor));
-  int flags = ns ? PEMIT_SPOOF : 0;
+  int flags = PEMIT_LIST | PEMIT_SILENT;
+
+  if (ns)
+    flags |= PEMIT_SPOOF;
 
   if (!FUNCTION_SIDE_EFFECTS) {
     safe_str(T(e_disabled), buff, bp);
@@ -383,34 +388,50 @@
 /* ARGSUSED */
 FUNCTION(fun_rand)
 {
-  uint32_t low, high;
-  if (!is_strict_uinteger(args[0])) {
-    safe_str(T(e_uint), buff, bp);
+  uint32_t low, high, rand;
+  int lowint, highint, offset = 0;
+  if (!is_strict_integer(args[0])) {
+    safe_str(T(e_int), buff, bp);
     return;
   }
   if (nargs == 1) {
-    low = 0;
-    high = parse_uinteger(args[0]);
-    if (high == 0) {
+    low = lowint = 0;
+    highint = parse_integer(args[0]);
+    if (highint == 0) {
       safe_str(T(e_range), buff, bp);
       return;
+    } else if (highint < 0) {
+      high = offset = (highint * -1);
+      offset -= 1;
+    } else {
+      high = highint;
     }
     high -= 1;
   } else {
-    if (!is_strict_uinteger(args[1])) {
-      safe_str(T(e_uints), buff, bp);
+    if (!is_strict_integer(args[1])) {
+      safe_str(T(e_ints), buff, bp);
       return;
     }
-    low = parse_uinteger(args[0]);
-    high = parse_uinteger(args[1]);
-  }
-
-  if (low > high) {
-    safe_str(T(e_range), buff, bp);
-    return;
+    lowint = parse_integer(args[0]);
+    highint = parse_integer(args[1]);
+    if (lowint > highint) {
+      /* reverse numbers */
+      offset = lowint;
+      lowint = highint;
+      highint = offset;
+      offset = 0;
+    }
+    if (lowint < 0) {
+      offset = 0 - lowint;
+      low = 0;
+      high = highint + offset;
+    } else {
+      low = lowint;
+      high = highint;
+    }
   }
-
-  safe_uinteger(get_random32(low, high), buff, bp);
+  rand = get_random32(low, high);
+  safe_integer((int) rand - offset, buff, bp);
 }
 
 /* ARGSUSED */
@@ -530,24 +551,34 @@
 {
   /* this works a bit like the @switch/regexp command */
 
-  int j, per;
+  int j, per = 0;
   char mstr[BUFFER_LEN], pstr[BUFFER_LEN], *dp;
   char const *sp;
   char *tbuf1;
-  int first = 1, found = 0, cs = 1;
+  int first = 1, found = 0, flags = 0;
+  int search, subpatterns, offsets[99];
+  pcre *re;
+  struct re_save rsave;
+  ansi_string *mas;
+  const char *errptr;
+  int erroffset;
+  pcre_extra *extra;
 
   if (strstr(called_as, "ALL"))
     first = 0;
 
   if (strcmp(called_as, "RESWITCHI") == 0
       || strcmp(called_as, "RESWITCHALLI") == 0)
-    cs = 0;
+    flags = PCRE_CASELESS;
 
   dp = mstr;
   sp = args[0];
   process_expression(mstr, &dp, &sp, executor, caller, enactor,
                      PE_DEFAULT, PT_DEFAULT, pe_info);
   *dp = '\0';
+  mas = parse_ansi_string(mstr);
+
+  save_regexp_context(&rsave);
 
   /* try matching, return match immediately when found */
 
@@ -558,24 +589,51 @@
                        PE_DEFAULT, PT_DEFAULT, pe_info);
     *dp = '\0';
 
-    if (quick_regexp_match(pstr, mstr, cs)) {
+    if ((re =
+         pcre_compile(remove_markup(pstr, NULL), flags, &errptr, &erroffset,
+                      tables)) == NULL) {
+      /* Matching error. Ignore this one, move on. */
+      continue;
+    }
+    add_check("pcre");
+    extra = default_match_limit();
+    search = 0;
+    subpatterns =
+      pcre_exec(re, extra, mas->text, mas->len, search, 0, offsets, 99);
+    if (subpatterns >= 0) {
       /* If there's a #$ in a switch's action-part, replace it with
        * the value of the conditional (mstr) before evaluating it.
        */
       tbuf1 = replace_string("#$", mstr, args[j + 1]);
-
       sp = tbuf1;
-
+      /* set regexp context here */
+      global_eval_context.re_code = re;
+      global_eval_context.re_from = mas;
+      global_eval_context.re_offsets = offsets;
+      global_eval_context.re_subpatterns = subpatterns;
       per = process_expression(buff, bp, &sp,
                                executor, caller, enactor,
-                               PE_DEFAULT, PT_DEFAULT, pe_info);
+                               PE_DEFAULT | PE_DOLLAR, PT_DEFAULT, pe_info);
       mush_free(tbuf1, "replace_string.buff");
       found = 1;
-      if (per || first)
-        return;
+    }
+    mush_free(re, "pcre");
+    if (first && found) {
+      free_ansi_string(mas);
+      restore_regexp_context(&rsave);
+      return;
+    }
+    /* clear regexp context again here */
+    global_eval_context.re_code = NULL;
+    global_eval_context.re_subpatterns = -1;
+    global_eval_context.re_offsets = NULL;
+    global_eval_context.re_from = NULL;
+    if (per) {
+      free_ansi_string(mas);
+      restore_regexp_context(&rsave);
+      return;
     }
   }
-
   if (!(nargs & 1) && !found) {
     /* Default case */
     tbuf1 = replace_string("#$", mstr, args[nargs - 1]);
@@ -584,6 +642,8 @@
                        PE_DEFAULT, PT_DEFAULT, pe_info);
     mush_free(tbuf1, "replace_string.buff");
   }
+  free_ansi_string(mas);
+  restore_regexp_context(&rsave);
 }
 
 /* ARGSUSED */
@@ -967,7 +1027,7 @@
     }
   }
 
-  for (i = 0; i < n; i++) {
+  for (i = 1; i <= n; i++) {
     uint64_t start;
     unsigned int elapsed;
     tp = tbuf;
@@ -992,10 +1052,10 @@
   if (thing != NOTHING) {
     safe_str(tbuf, buff, bp);
     notify_format(thing, T("Average: %.2f   Min: %u   Max: %u"),
-                  ((double) total) / n, min, max);
+                  ((double) total) / i, min, max);
   } else {
     safe_format(buff, bp, T("Average: %.2f   Min: %u   Max: %u"),
-                ((double) total) / n, min, max);
+                ((double) total) / i, min, max);
   }
 
   return;
Index: src/speech.c
===================================================================
--- src/speech.c	(.../184p0)	(revision 575)
+++ src/speech.c	(.../184p1)	(revision 575)
@@ -146,7 +146,9 @@
 do_say(dbref player, const char *tbuf1)
 {
   dbref loc;
-
+  const char *args[2];
+  char tbuf2[BUFFER_LEN];
+  int mod = 0;
   loc = speech_loc(player);
   if (!GoodObject(loc))
     return;
@@ -159,11 +161,20 @@
   if (*tbuf1 == SAY_TOKEN && CHAT_STRIP_QUOTE)
     tbuf1++;
 
+  args[0] = tbuf1;
+  args[1] = "\"";
+  tbuf2[0] = '\0';
+
+  if (call_attrib(player, "SPEECHMOD", args, 2, tbuf2, player, NULL)
+      && *tbuf2 != '\0')
+    mod = 1;
+
   /* notify everybody */
-  notify_format(player, T("You say, \"%s\""), tbuf1);
+  notify_format(player, T("You say, \"%s\""), (mod ? tbuf2 : tbuf1));
   notify_except(Contents(loc), player,
-                tprintf(T("%s says, \"%s\""), spname(player), tbuf1),
-                NA_INTER_HEAR);
+                tprintf(T("%s says, \"%s\""), spname(player),
+                        (mod ? tbuf2 : tbuf1)), NA_INTER_HEAR);
+
 }
 
 /** The oemit(/list) command.
@@ -585,12 +596,15 @@
 /** The pose and semipose command.
  * \param player the enactor.
  * \param tbuf1 the message to pose.
- * \param space if 1, put a space between name and pose; if 0, don't (semipose)
+ * \param space if 1, omit space between name and pose (semipose); if 0, include space (pose)
  */
 void
 do_pose(dbref player, const char *tbuf1, int space)
 {
   dbref loc;
+  const char *args[2];
+  char tbuf2[BUFFER_LEN];
+  int mod = 0;
 
   loc = speech_loc(player);
   if (!GoodObject(loc))
@@ -601,13 +615,23 @@
     return;
   }
 
+  args[0] = tbuf1;
+  args[1] = (space ? ";" : ":");
+  tbuf2[0] = '\0';
+
+  if (call_attrib(player, "SPEECHMOD", args, 2, tbuf2, player, NULL)
+      && *tbuf2 != '\0')
+    mod = 1;
+
   /* notify everybody */
   if (!space)
     notify_except(Contents(loc), NOTHING,
-                  tprintf("%s %s", spname(player), tbuf1), NA_INTER_HEAR);
+                  tprintf("%s %s", spname(player), (mod ? tbuf2 : tbuf1)),
+                  NA_INTER_HEAR);
   else
     notify_except(Contents(loc), NOTHING,
-                  tprintf("%s%s", spname(player), tbuf1), NA_INTER_HEAR);
+                  tprintf("%s%s", spname(player), (mod ? tbuf2 : tbuf1)),
+                  NA_INTER_HEAR);
 }
 
 /** The *wall commands.
@@ -976,7 +1000,8 @@
   tp = tbuf;
 
   /* Figure out the 'name' of the player */
-  if ((alias = shortalias(player)) && *alias && PAGE_ALIASES)
+  if ((alias = shortalias(player)) && *alias && PAGE_ALIASES
+      && strcasecmp(alias, Name(player)))
     current = tprintf("%s (%s)", Name(player), alias);
   else
     current = (char *) Name(player);
@@ -1306,6 +1331,9 @@
 {
   dbref loc;
   int na_flags = NA_INTER_HEAR;
+  const char *args[2];
+  char tbuf2[BUFFER_LEN];
+  int mod = 0;
 
   loc = speech_loc(player);
   if (!GoodObject(loc))
@@ -1316,10 +1344,19 @@
     return;
   }
 
+  args[0] = tbuf1;
+  args[1] = "|";
+  tbuf2[0] = '\0';
+
+  if (call_attrib(player, "SPEECHMOD", args, 2, tbuf2, player, NULL)
+      && *tbuf2 != '\0')
+    mod = 1;
+
   /* notify everybody */
   if (flags & PEMIT_SPOOF)
     na_flags |= NA_SPOOF;
-  notify_anything(player, na_loc, &loc, ns_esnotify, na_flags, tbuf1);
+  notify_anything(player, na_loc, &loc, ns_esnotify, na_flags,
+                  (mod ? tbuf2 : tbuf1));
 
   do_audible_stuff(loc, NULL, 0, tbuf1);
 }
Index: src/chunk.c
===================================================================
--- src/chunk.c	(.../184p0)	(revision 575)
+++ src/chunk.c	(.../184p1)	(revision 575)
@@ -842,7 +842,7 @@
       if (ChunkIsFree(region, offset)) {
         fprintf(fp, "next:%04x\n", ChunkNextFree(region, offset));
       } else {
-        fprintf(fp, "doff:%04"PRIdS"x len:%04x ",
+        fprintf(fp, "doff:%04" PRIdS "x len:%04x ",
                 ChunkDataPtr(region, offset) - (unsigned char *) rhp,
                 ChunkLen(region, offset));
         count = ChunkDerefs(region, offset);
Index: src/boolexp.c
===================================================================
--- src/boolexp.c	(.../184p0)	(revision 575)
+++ src/boolexp.c	(.../184p1)	(revision 575)
@@ -80,7 +80,7 @@
  * The only optimization done right now is thread jumping: If a jump
  * would move the program counter to another jump operation, it instead
  * goes to that jump's destination.
- * 
+ *
  * There's more useful room for improvement in the lock
  * @warnings. Checking things like flag and power keys for valid flags
  * comes to mind.
@@ -133,7 +133,7 @@
 } boolexp_type;
 
 /** An attribute lock specification for the parse tree.
- * This structure is a piece of a boolexp that's used to store 
+ * This structure is a piece of a boolexp that's used to store
  * attribute locks (CANDO:1), eval locks (CANDO/1), and flag locks
  * FLAG^WIZARD.
  */
@@ -314,7 +314,7 @@
  */
     extern int loading_db;
 
-/** Given a chunk id, return the bytecode for a boolexp.  
+/** Given a chunk id, return the bytecode for a boolexp.
  * \param b the boolexp to retrieve.
  * \return a malloced copy of the bytecode.
  */
@@ -329,7 +329,7 @@
   return bytecode;
 }
 
-/** Given a chunk id, return the bytecode for a boolexp.  
+/** Given a chunk id, return the bytecode for a boolexp.
  * \param b The boolexp to retrieve.
  * \param storelen the length of the bytecode.
  * \return a static copy of the bytecode.
@@ -1597,7 +1597,7 @@
 }
 
 
-/** Do some trivial optimizations of boolexp vm assembly. 
+/** Do some trivial optimizations of boolexp vm assembly.
  *
  *
  * Current optimizations: Thread jumping
@@ -1655,7 +1655,7 @@
   }
 }
 
-/** Turn assembly into bytecode. 
+/** Turn assembly into bytecode.
  * \param a the assembly list to emit.
  * \param the compiled bytecode.
  */
@@ -1788,7 +1788,7 @@
   return parse_boolexp_d(player, buf, ltype, 0);
 }
 
-/** Test to see if an eval lock passes, with a exact match.
+/** Test to see if an eval lock passes, with an exact match.
  * \param player the object attempting to pass the lock.
  * \param target the object the lock is on.
  * \param atrname the name of the attribute to evaluate on target.
@@ -1828,6 +1828,31 @@
   return !strcasecmp(buff, str);
 }
 
+/* Is this an eval (attr/result) or indirect (@obj/lock) lock?
+ * If so, @search needs to charge for it
+ */
+bool
+is_eval_lock(boolexp b)
+{
+  bvm_opcode op;
+  uint8_t *pc;
+
+  if (b == TRUE_BOOLEXP)
+    return 0;
+
+  pc = get_bytecode(b, NULL);
+  while (1) {
+    op = (bvm_opcode) *pc;
+    pc += INSN_LEN;
+    if (op == OP_TEVAL || op == OP_TIND) {
+      return 1;
+    } else if (op == OP_RET) {
+      return 0;
+    }
+  }
+
+}
+
 #ifdef DEBUG_BYTECODE
 
 /** Find the size of a parse tree node, recursively to count all child nodes.
Index: src/bsd.c
===================================================================
--- src/bsd.c	(.../184p0)	(revision 575)
+++ src/bsd.c	(.../184p1)	(revision 575)
@@ -165,6 +165,7 @@
 #endif
 int shutdown_flag = 0;          /**< Is it time to shut down? */
 void chat_player_announce(dbref player, char *msg, int ungag);
+void report_mssp(DESC *d, char *buff, char **bp);
 
 static int login_number = 0;
 static int under_limit = 1;
@@ -215,6 +216,9 @@
 #define TN_LINEMODE 34          /**< Line mode */
 #define TN_NAWS 31              /**< Negotiate About Window Size */
 #define TN_TTYPE 24             /**< Ask for termial type information */
+#define TN_MSSP 70              /**< Send MSSP info (http://tintin.sourceforge.net/mssp/) */
+#define MSSP_VAR 1              /**< MSSP option name */
+#define MSSP_VAL 2              /**< MSSP option value */
 static void test_telnet(DESC *d);
 static void setup_telnet(DESC *d);
 static int handle_telnet(DESC *d, unsigned char **q, unsigned char *qend);
@@ -357,6 +361,7 @@
 extern int queue_string_eol(DESC *d, const char *s);
 extern void freeqs(DESC *d);
 static void welcome_user(DESC *d, int telnet);
+static int count_players(void);
 static void dump_info(DESC *call_by);
 static void save_command(DESC *d, const unsigned char *command);
 static int process_input(DESC *d, int output_ready);
@@ -614,8 +619,10 @@
 
   descs_by_fd = im_new();
 
-  /* go do it */
-  load_reboot_db();
+  if (restarting) {
+    /* go do it */
+    load_reboot_db();
+  }
 
   shovechars((Port_t) TINYPORT, (Port_t) SSLPORT);
 
@@ -1383,7 +1390,7 @@
 #else
   /* Posix read code here */
   {
-    int fd, n;
+    int fd;
     struct stat sb;
 
     release_fd();
@@ -1409,7 +1416,7 @@
       return -1;
     }
 
-    if ((n = read(fd, fb->buff, sb.st_size)) != sb.st_size) {
+    if (read(fd, fb->buff, sb.st_size) != sb.st_size) {
       do_rawlog(LT_ERR, "Couldn't read all of '%s'", filename);
       close(fd);
       mush_free(fb->buff, "fcache_data");
@@ -1885,12 +1892,13 @@
      option for local echo, just remote echo. */
   d->conn_flags |= CONN_TELNET;
   if (d->conn_flags & CONN_TELNET_QUERY) {
-    /* IAC DO NAWS IAC DO TERMINAL-TYPE */
-    unsigned char extra_options[6] = "\xFF\xFD\x1F" "\xFF\xFD\x18";
+    /* IAC DO NAWS IAC DO TERMINAL-TYPE IAC WILL MSSP  */
+    unsigned char extra_options[9] =
+      "\xFF\xFD\x1F" "\xFF\xFD\x18" "\xFF\xFB\x46";
     d->conn_flags &= ~CONN_TELNET_QUERY;
     do_rawlog(LT_CONN, "[%d/%s/%s] Switching to Telnet mode.",
               d->descriptor, d->addr, d->ip);
-    queue_newwrite(d, extra_options, 6);
+    queue_newwrite(d, extra_options, 9);
     process_output(d);
   }
 }
@@ -2075,6 +2083,21 @@
 #ifdef DEBUG_TELNET
       fprintf(stderr, "GOT IAC DO SGA, sending IAC WILL SGA IAG DO SGA\n");
 #endif
+    } else if (**q == TN_MSSP) {
+      /* IAC SB MSSP MSSP_VAR "variable" MSSP_VAL "value" ... IAC SE */
+      char reply[BUFFER_LEN];
+      char *bp;
+      bp = reply;
+
+      safe_chr((char) IAC, reply, &bp);
+      safe_chr((char) SB, reply, &bp);
+      safe_chr((char) TN_MSSP, reply, &bp);
+      report_mssp((DESC *) NULL, reply, &bp);
+      safe_chr((char) IAC, reply, &bp);
+      safe_chr((char) SE, reply, &bp);
+      *bp = '\0';
+      queue_newwrite(d, (unsigned char *) reply, strlen(reply));
+      process_output(d);
     } else {
       /* Stuff we won't do */
       unsigned char reply[3];
@@ -2324,6 +2347,10 @@
     send_prefix(d);
     dump_info(d);
     send_suffix(d);
+  } else if (!strcmp(command, MSSPREQUEST_COMMAND)) {
+    send_prefix(d);
+    report_mssp(d, NULL, NULL);
+    send_suffix(d);
   } else if (!strncmp(command, PREFIX_COMMAND, strlen(PREFIX_COMMAND))) {
     set_userstring(&d->output_prefix, command + strlen(PREFIX_COMMAND));
   } else if (!strncmp(command, SUFFIX_COMMAND, strlen(SUFFIX_COMMAND))) {
@@ -2363,12 +2390,13 @@
       for (j = 0; j < NUMQ; j++)
         global_eval_context.renv[j][0] = '\0';
       global_eval_context.process_command_port = d->descriptor;
-
+      global_eval_context.pe_info = make_pe_info();
       process_command(d->player, command, d->player, 1);
       send_suffix(d);
       strcpy(global_eval_context.ccom, "");
       strcpy(global_eval_context.ucom, "");
       global_eval_context.cplr = NOTHING;
+      free_pe_info(global_eval_context.pe_info);
     } else {
       j = 0;
       if (!strncmp(command, WHO_COMMAND, strlen(WHO_COMMAND))) {
@@ -2787,7 +2815,7 @@
 int
 boot_player(dbref player, int idleonly, int silent)
 {
-  DESC *d, *ignore = NULL;
+  DESC *d, *ignore = NULL, *boot = NULL;
   int count = 0;
   time_t now = mudtime;
 
@@ -2795,19 +2823,25 @@
     ignore = least_idle_desc(player, 1);
 
   DESC_ITER_CONN(d) {
+    if (boot) {
+      boot_desc(boot);
+      boot = NULL;
+    }
     if (d->player == player
         && (!ignore || (d != ignore && difftime(now, d->last_time) > 60.0))) {
       if (!idleonly && !silent && !count)
         notify(player, T("You are politely shown to the door."));
       count++;
-      boot_desc(d);
+      boot = d;
     }
   }
+  if (boot)
+    boot_desc(boot);
   if (count && idleonly) {
     if (count == 1)
       notify(player, T("You boot an idle self."));
     else
-      notify_format(player, T("You boot %d idle selves."), count);;
+      notify_format(player, T("You boot %d idle selves."), count);
   }
 
   return count;
@@ -3096,12 +3130,11 @@
 #endif                          /* !(Mac or WIN32) */
 
 
-static void
-dump_info(DESC *call_by)
+static int
+count_players(void)
 {
   int count = 0;
   DESC *d;
-  queue_string_eol(call_by, tprintf("### Begin INFO %s", INFO_VERSION));
 
   /* Count connected players */
   for (d = descriptor_list; d; d = d->next) {
@@ -3112,18 +3145,90 @@
         count++;
     }
   }
+
+  return count;
+}
+
+static void
+dump_info(DESC *call_by)
+{
+
+  queue_string_eol(call_by, tprintf("### Begin INFO %s", INFO_VERSION));
+
   queue_string_eol(call_by, tprintf("Name: %s", options.mud_name));
   queue_string_eol(call_by, tprintf("Address: %s", options.mud_url));
   queue_string_eol(call_by,
                    tprintf("Uptime: %s",
                            show_time(globals.first_start_time, 0)));
-  queue_string_eol(call_by, tprintf("Connected: %d", count));
+  queue_string_eol(call_by, tprintf("Connected: %d", count_players()));
   queue_string_eol(call_by, tprintf("Size: %d", db_top));
   queue_string_eol(call_by,
                    tprintf("Version: PennMUSH %sp%s", VERSION, PATCHLEVEL));
   queue_string_eol(call_by, "### End INFO");
 }
 
+void
+report_mssp(DESC *d, char *buff, char **bp)
+{
+  MSSP *opt;
+
+  if (d) {
+    queue_string_eol(d, "\r\nMSSP-REPLY-START");
+    /* Required by current spec, as of 2010-08-15 */
+    queue_string_eol(d, tprintf("%s\t%s", "NAME", options.mud_name));
+    queue_string_eol(d, tprintf("%s\t%d", "PLAYERS", count_players()));
+    queue_string_eol(d, tprintf("%s\t%ld", "UPTIME", globals.first_start_time));
+    /* Not required, but we know anyway */
+    queue_string_eol(d, tprintf("%s\t%d", "PORT", options.port));
+    if (options.ssl_port)
+      queue_string_eol(d, tprintf("%s\t%d", "SSL", options.ssl_port));
+    queue_string_eol(d, tprintf("%s\t%d", "PUEBLO", options.support_pueblo));
+    queue_string_eol(d,
+                     tprintf("%s\t%s %sp%s", "CODEBASE", "PennMUSH", VERSION,
+                             PATCHLEVEL));
+    queue_string_eol(d, tprintf("%s\t%s", "FAMILY", "TinyMUD"));
+    if (strlen(options.mud_url))
+      queue_string_eol(d, tprintf("%s\t%s", "WEBSITE", options.mud_url));
+  } else {
+    safe_format(buff, bp, "%c%s%c%s", MSSP_VAR, "NAME", MSSP_VAL,
+                options.mud_name);
+    safe_format(buff, bp, "%c%s%c%d", MSSP_VAR, "PLAYERS", MSSP_VAL,
+                count_players());
+    safe_format(buff, bp, "%c%s%c%ld", MSSP_VAR, "UPTIME", MSSP_VAL,
+                globals.first_start_time);
+
+    safe_format(buff, bp, "%c%s%c%d", MSSP_VAR, "PORT", MSSP_VAL, options.port);
+    if (options.ssl_port)
+      safe_format(buff, bp, "%c%s%c%d", MSSP_VAR, "SSL", MSSP_VAL,
+                  options.ssl_port);
+    safe_format(buff, bp, "%c%s%c%d", MSSP_VAR, "PUEBLO", MSSP_VAL,
+                options.support_pueblo);
+    safe_format(buff, bp, "%c%s%cPennMUSH %sp%s", MSSP_VAR, "CODEBASE",
+                MSSP_VAL, VERSION, PATCHLEVEL);
+    safe_format(buff, bp, "%c%s%c%s", MSSP_VAR, "FAMILY", MSSP_VAL, "TinyMUD");
+    if (strlen(options.mud_url))
+      safe_format(buff, bp, "%c%s%c%s", MSSP_VAR, "WEBSITE", MSSP_VAL,
+                  options.mud_url);
+  }
+
+  if (mssp) {
+    opt = mssp;
+    if (d) {
+      while (opt) {
+        queue_string_eol(d, tprintf("%s\t%s", opt->name, opt->value));
+        opt = opt->next;
+      }
+      queue_string_eol(d, "MSSP-REPLY-END");
+    } else {
+      while (opt) {
+        safe_format(buff, bp, "%c%s%c%s", MSSP_VAR, opt->name, MSSP_VAL,
+                    opt->value);
+        opt = opt->next;
+      }
+    }
+  }
+}
+
 /** Determine if a new guest can connect at this point. If so, return
  * the dbref of the player they should connect to.
  * The algorithm looks like this:
@@ -3911,9 +4016,12 @@
   dbref who1 = NOTHING;
   int count = 0;
 
+  if (!(match && *match))
+    return NOTHING;
+
   for (d = descriptor_list; d; d = d->next) {
     if (d->connected) {
-      if (match && !string_prefix(Name(d->player), match))
+      if (!string_prefix(Name(d->player), match))
         continue;
       if (!strcasecmp(Name(d->player), match)) {
         count = 1;
@@ -5192,9 +5300,13 @@
    * So we make sure that if we get a SIGPROF in our next incarnation,
    * we ignore it until our proper handler is set up.
    */
+#ifdef __CYGWIN__
+  ignore_signal(SIGALRM);
+#else
   ignore_signal(SIGPROF);
-#endif
-#endif
+#endif                          /* __CYGWIN__ */
+#endif                          /* WIN32 */
+#endif                          /* PROFILING */
   dump_reboot_db();
 #ifdef INFO_SLAVE
   kill_info_slave();
@@ -5213,7 +5325,7 @@
       args[n++] = pidfile;
     }
     args[n++] = confname;
-    args[n++] = NULL;
+    args[n] = NULL;
 
     execv(saved_argv[0], (char **) args);
   }
Index: src/SWITCHES
===================================================================
--- src/SWITCHES	(.../184p0)	(revision 575)
+++ src/SWITCHES	(.../184p1)	(revision 575)
@@ -129,6 +129,7 @@
 SPEAK
 SPOOF
 STATS
+STATUS
 SUMMARY
 TABLES
 TAG
@@ -143,6 +144,7 @@
 UNGAG
 UNFOLDER
 UNMUTE
+UNREAD
 UNTAG
 UNTIL
 URGENT
Index: src/memcheck.c
===================================================================
--- src/memcheck.c	(.../184p0)	(revision 575)
+++ src/memcheck.c	(.../184p1)	(revision 575)
@@ -83,14 +83,13 @@
 void
 del_check(const char *ref, const char *filename, int line)
 {
-  MEM *loop, *prev = NULL;
-  int cmp;
+  MEM *loop;
 
   if (!options.mem_check)
     return;
 
   for (loop = my_check; loop; loop = loop->next) {
-    cmp = strcmp(ref, loop->ref_name);
+    int cmp = strcmp(ref, loop->ref_name);
     if (cmp == 0) {
       loop->ref_count--;
       if (loop->ref_count < 0)
@@ -104,7 +103,6 @@
                 ref, filename, line);
       break;
     }
-    prev = loop;
   }
 }
 
Index: src/funstr.c
===================================================================
--- src/funstr.c	(.../184p0)	(revision 575)
+++ src/funstr.c	(.../184p1)	(revision 575)
@@ -1689,7 +1689,7 @@
   static char line[BUFFER_LEN];
   static char segment[BUFFER_LEN];
   char *sp;
-  char *ptr, *tptr;
+  char *ptr;
   char *lp;
   char *lastspace;
   int i, j, k;
@@ -1774,8 +1774,9 @@
         safe_ansi_string(as[i], ptrs[i] - (as[i]->text), len, segment, &sp);
       }
       ptrs[i] = ptr + 1;
-      ptr = tptr;
     } else if (lastspace) {
+      char *tptr;
+
       ptr = lastspace;
       skipspace = 1;
       for (tptr = ptr;
Index: src/rob.c
===================================================================
--- src/rob.c	(.../184p0)	(revision 575)
+++ src/rob.c	(.../184p1)	(revision 575)
@@ -250,7 +250,7 @@
               boughtit = price;
             }
           } else if ((plus = strchr(cost, '+'))) {
-            *(plus++) = '\0';
+            *plus = '\0';
             if (!is_strict_integer(cost))
               continue;
             low = parse_integer(cost);
@@ -449,14 +449,18 @@
   } else {
     char *pay_env[10] = { NULL };
     char paid[SBUF_LEN], *pb;
+    ATTR *a;
 
     pay_env[0] = pb = paid;
 
-    /* objects work differently */
-    if (IsThing(who)) {
-      /* give pennies to an object */
+    a = atr_get(who, "COST");
+    if (!a && !IsPlayer(who)) {
+      notify_format(player, T("%s refuses your money."), Name(who));
+      giveto(player, amount);
+      return;
+    } else if (a) {
+      /* give pennies to object with COST */
       int cost = 0;
-      ATTR *a;
       char *preserveq[NUMQ];
       char *preserves[10];
       char fbuff[BUFFER_LEN];
@@ -489,8 +493,11 @@
         giveto(player, amount);
         return;
       }
-      if (cost < 0)
+      if (cost < 0) {
+        notify_format(player, T("%s refuses your money."), Name(who));
+        giveto(player, amount);
         return;
+      }
       if ((amount - cost) > 0) {
         notify_format(player, T("You get %d in change."), amount - cost);
       } else {
Index: src/funufun.c
===================================================================
--- src/funufun.c	(.../184p0)	(revision 575)
+++ src/funufun.c	(.../184p1)	(revision 575)
@@ -19,6 +19,7 @@
 #include "dbdefs.h"
 #include "flags.h"
 #include "lock.h"
+#include "function.h"
 #include "confmagic.h"
 
 void do_userfn(char *buff, char **bp, dbref obj, ATTR *attrib, int nargs,
@@ -50,6 +51,15 @@
   p = args[0];
   process_expression(tbuf, &tp, &p, executor, caller,
                      enactor, PE_DEFAULT, PT_DEFAULT, pe_info);
+  *tp = '\0';
+  /* Make sure a builtin function with the name actually exists */
+  if (!builtin_func_hash_lookup(tbuf)) {
+    safe_str(T("#-1 FUNCTION ("), buff, bp);
+    safe_str(tbuf, buff, bp);
+    safe_str(T(") NOT FOUND"), buff, bp);
+    return;
+  }
+
   safe_chr('(', tbuf, &tp);
   for (i = 1; i < nargs; i++) {
     if (i > 1)
Index: src/sort.c
===================================================================
--- src/sort.c	(.../184p0)	(revision 575)
+++ src/sort.c	(.../184p1)	(revision 575)
@@ -19,6 +19,11 @@
 
 #define EPSILON 0.000000001  /**< limit of precision for float equality */
 
+/** If sort_order is positive, sort forward. If negative, it sorts backward. */
+#define ASCENDING 1
+#define DESCENDING -1
+int sort_order = ASCENDING;
+
 /** qsort() comparision routine for int */
 int
 int_comp(const void *s1, const void *s2)
@@ -31,9 +36,9 @@
   if (a == b)
     return 0;
   else if (a < b)
-    return -1;
+    return -1 * sort_order;
   else
-    return 1;
+    return 1 * sort_order;
 }
 
 
@@ -49,9 +54,9 @@
   if (a == b)
     return 0;
   else if (a < b)
-    return -1;
+    return -1 * sort_order;
   else
-    return 1;
+    return 1 * sort_order;
 }
 
 
@@ -62,7 +67,7 @@
   const NVAL *x = a, *y = b;
   const double epsilon = pow(10.0, -FLOAT_PRECISION);
   int eq = (fabs(*x - *y) <= (epsilon * fabs(*x)));
-  return eq ? 0 : (*x > *y ? 1 : -1);
+  return eq ? 0 : ((*x > *y ? 1 : -1) * sort_order);
 }
 
 
@@ -77,7 +82,7 @@
   a = *(const char **) s1;
   b = *(const char **) s2;
 
-  return strcmp(a, b);
+  return strcmp(a, b) * sort_order;
 }
 
 /** qsort() comparision routine for strings.
@@ -92,7 +97,7 @@
   a = *(const char **) s1;
   b = *(const char **) s2;
 
-  return strcasecmp(a, b);
+  return strcasecmp(a, b) * sort_order;
 }
 
 /** qsort() comparision routine for dbrefs. */
@@ -107,9 +112,9 @@
   if (a == b)
     return 0;
   else if (a < b)
-    return -1;
+    return -1 * sort_order;
   else
-    return 1;
+    return 1 * sort_order;
 }
 
 
@@ -143,7 +148,7 @@
     return 0;
   n = parse_integer(result);
 
-  return n;
+  return n * sort_order;
 }
 
 
@@ -259,8 +264,6 @@
   }
 }
 
-#define RealGoodObject(x) (GoodObject(x) && !IsGarbage(x))
-
 GENRECORD(gen_magic)
 {
   static char buff[BUFFER_LEN];
@@ -495,7 +498,7 @@
   const s_rec *sr2 = (const s_rec *) s2;
   int res = 0;
   res = strcoll(sr1->memo.str.s, sr2->memo.str.s);
-  return Compare(res, sr1, sr2);
+  return Compare(res, sr1, sr2) * sort_order;
 }
 
 static int
@@ -505,7 +508,7 @@
   const s_rec *sr2 = (const s_rec *) s2;
   int res = 0;
   res = strcasecoll(sr1->memo.str.s, sr2->memo.str.s);
-  return Compare(res, sr1, sr2);
+  return Compare(res, sr1, sr2) * sort_order;
 }
 
 static int
@@ -513,7 +516,7 @@
 {
   const s_rec *sr1 = (const s_rec *) s1;
   const s_rec *sr2 = (const s_rec *) s2;
-  return Compare2(sr1->memo.num, sr2->memo.num, sr1, sr2);
+  return Compare2(sr1->memo.num, sr2->memo.num, sr1, sr2) * sort_order;
 }
 
 static int
@@ -522,7 +525,7 @@
   const s_rec *sr1 = (const s_rec *) s1;
   const s_rec *sr2 = (const s_rec *) s2;
   double r = difftime(sr1->memo.tm, sr2->memo.tm);
-  return CompareF(r, sr1, sr2);
+  return CompareF(r, sr1, sr2) * sort_order;
 }
 
 static int
@@ -530,7 +533,7 @@
 {
   const s_rec *sr1 = (const s_rec *) s1;
   const s_rec *sr2 = (const s_rec *) s2;
-  return Compare2F(sr1->memo.numval, sr2->memo.numval, sr1, sr2);
+  return Compare2F(sr1->memo.numval, sr2->memo.numval, sr1, sr2) * sort_order;
 }
 
 typedef struct _list_type_list_ {
@@ -587,13 +590,15 @@
   static char stype[BUFFER_LEN];
   int i;
   char *str;
+  sort_order = ASCENDING;
   if (nargs >= type_pos) {
     str = args[type_pos - 1];
-    if (*str) {
-      strcpy(stype, str);
-      str = strchr(stype, ':');
-      if (str)
-        *(str++) = '\0';
+    if (str && *str == '-') {
+      str++;
+      sort_order = DESCENDING;
+    }
+    if (str && *str) {
+      copy_up_to(stype, str, ':');
       for (i = 0; ltypelist[i].name && strcasecmp(ltypelist[i].name, stype);
            i++) ;
       /* return ltypelist[i].name; */
@@ -611,13 +616,15 @@
   static char stype[BUFFER_LEN];
   int i;
   char *str;
+  sort_order = ASCENDING;
   if (nargs >= type_pos) {
     str = args[type_pos - 1];
     if (*str) {
-      strcpy(stype, str);
-      str = strchr(stype, ':');
-      if (str)
-        *(str++) = '\0';
+      if (*str == '-') {
+        str++;
+        sort_order = DESCENDING;
+      }
+      copy_up_to(stype, str, ':');
       for (i = 0; ltypelist[i].name && strcasecmp(ltypelist[i].name, stype);
            i++) ;
       /* return ltypelist[i].name; */
@@ -695,13 +702,18 @@
   int i, sorti;
   s_rec *sp;
   ptr = NULL;
+  sort_order = ASCENDING;
+  if (sort_type && *sort_type == '-') {
+    sort_type++;
+    sort_order = DESCENDING;
+  }
   if (!sort_type || !*sort_type) {
     /* Advance sorti to the default */
     for (sorti = 0; ltypelist[sorti].name; sorti++) ;
   } else if (strchr(sort_type, ':') != NULL) {
     strcpy(stype, sort_type);
     ptr = strchr(stype, ':');
-    *(ptr++) = '\0';
+    *ptr++ = '\0';
     if (!*ptr)
       ptr = NULL;
     for (sorti = 0;
Index: src/flags.c
===================================================================
--- src/flags.c	(.../184p0)	(revision 575)
+++ src/flags.c	(.../184p1)	(revision 575)
@@ -1498,7 +1498,9 @@
   FLAGSPACE *n;
   if (IsGarbage(thing))
     return;
-  n = (FLAGSPACE *) hashfind(ns, &htab_flagspaces);
+  n = hashfind(ns, &htab_flagspaces);
+  if (!n)
+    return;
   f = flag_hash_lookup(n, flag, Typeof(thing));
   if (f && (n->flag_table != type_table))
     twiddle_flag(n, thing, f, negate);
@@ -1527,7 +1529,12 @@
   FLAGSPACE *n;
   int current;
 
-  n = (FLAGSPACE *) hashfind("FLAG", &htab_flagspaces);
+  n = hashfind("FLAG", &htab_flagspaces);
+  if (!n) {
+    notify_format(player, T("Internal error: Unable to find flagspace '%s'!"),
+                  "FLAG");
+    return;
+  }
   if ((f = flag_hash_lookup(n, flag, Typeof(thing))) == NULL) {
     notify_format(player, T("%s - I don't recognize that flag."), flag);
     return;
@@ -1684,8 +1691,15 @@
   FLAG *f;
   FLAGSPACE *n;
   char tbuf1[BUFFER_LEN], *tp;
+  int current;
+
+  n = hashfind("POWER", &htab_flagspaces);
+  if (!n) {
+    notify_format(player, T("Internal error: Unable to find flagspace '%s'!"),
+                  "POWER");
+    return;
+  }
 
-  n = (FLAGSPACE *) hashfind("POWER", &htab_flagspaces);
   if ((f = flag_hash_lookup(n, flag, Typeof(thing))) == NULL) {
     notify_format(player, T("%s - I don't recognize that power."), flag);
     return;
@@ -1696,17 +1710,31 @@
     return;
   }
 
+  current = sees_flag("POWER", player, thing, f->name);
+
   twiddle_flag(n, thing, f, negate);
 
   if (!AreQuiet(player, thing)) {
     tp = tbuf1;
-    safe_str(Name(thing), tbuf1, &tp);
-    safe_str(" - ", tbuf1, &tp);
-    safe_str(f->name, tbuf1, &tp);
-    safe_str(negate ? T(" removed.") : T(" granted."), tbuf1, &tp);
+    if (negate) {
+      if (current) {
+        safe_format(tbuf1, &tp, T("%s - %s removed."), Name(thing), f->name);
+      } else {
+        safe_format(tbuf1, &tp, T("%s - %s (already) removed."), Name(thing),
+                    f->name);
+      }
+    } else {
+      if (current) {
+        safe_format(tbuf1, &tp, T("%s - %s (already) granted."), Name(thing),
+                    f->name);
+      } else {
+        safe_format(tbuf1, &tp, T("%s - %s granted."), Name(thing), f->name);
+      }
+    }
     *tp = '\0';
     notify(player, tbuf1);
   }
+
   if (f->perms & F_LOG)
     do_log(LT_WIZ, player, thing, "%s POWER %s", f->name,
            negate ? T("CLEARED") : T("SET"));
@@ -1731,11 +1759,10 @@
 {
   char *s;
   FLAG *fp;
-  int negate, temp;
+  int negate = 0, temp = 0;
   int ret = type;
   FLAGSPACE *n;
 
-  negate = temp = 0;
   if (!GoodObject(it))
     return 0;
   if (!(n = (FLAGSPACE *) hashfind(ns, &htab_flagspaces))) {
@@ -1827,10 +1854,10 @@
 {
   char *s, *copy, *sp;
   FLAG *fp;
-  int negate, temp;
+  int negate = 0, temp = 0;
   int ret = type;
   FLAGSPACE *n;
-  negate = temp = 0;
+
   if (!GoodObject(it))
     return 0;
   if (!(n = (FLAGSPACE *) hashfind(ns, &htab_flagspaces))) {
@@ -2252,7 +2279,7 @@
   /* Ok, let's do it. */
   add_flag_generic(ns, name, letter, type, perms, negate_perms);
   /* Did it work? */
-  if ((f = match_flag_ns(n, name)))
+  if (match_flag_ns(n, name))
     do_flag_info(ns, player, name);
   else
     notify_format(player, T("Unknown failure adding %s."), strlower(ns));
@@ -2296,6 +2323,11 @@
     return;
   }
   n = hashfind(ns, &htab_flagspaces);
+  if (!n) {
+    notify_format(player, T("Internal error: Unknown flag space '%s'!"), ns);
+    return;
+  }
+
   af = match_flag_ns(n, alias);
   if (!delete && af) {
     notify_format(player, T("That alias already matches the %s %s."),
@@ -2324,7 +2356,7 @@
       return;
     }
     ptab_delete(n->tab, alias);
-    if ((af = match_flag_ns(n, alias)))
+    if (match_flag_ns(n, alias))
       notify(player, T("Unknown failure deleting alias."));
     else
       do_flag_info(ns, player, f->name);
@@ -2368,7 +2400,7 @@
 
   ptab_insert_one(n->tab, strupper(alias), f);
 
-  return ((f = match_flag_ns(n, alias)) ? 1 : 0);
+  return (match_flag_ns(n, alias) ? 1 : 0);
 }
 
 
@@ -2480,7 +2512,11 @@
     notify(player, T("You don't look like God."));
     return;
   }
-  n = (FLAGSPACE *) hashfind(ns, &htab_flagspaces);
+  n = hashfind(ns, &htab_flagspaces);
+  if (!n) {
+    notify_format(player, T("Internal error: Unknown flagspace '%s'!"), ns);
+    return;
+  }
   f = ptab_find_exact(n->tab, name);
   if (!f) {
     notify_format(player, T("I don't know that %s."), strlower(ns));
Index: src/extmail.c
===================================================================
--- src/extmail.c	(.../184p0)	(revision 575)
+++ src/extmail.c	(.../184p1)	(revision 575)
@@ -384,6 +384,50 @@
   do_mail_flags(player, msglist, M_CLEARED, 1);
 }
 
+/** Unread a set of mail messages.
+ * \param player the enactor
+ * \param msglist string specifying messages to unclear.
+ */
+void
+do_mail_unread(dbref player, const char *msglist)
+{
+  do_mail_flags(player, msglist, M_MSGREAD, 1);
+}
+
+/** Change the status for a set of mail messages.
+ * \param player the enactor
+ * \param msglist string specifying messages to unclear.
+ * \param status the status to set for the messages
+ */
+void
+do_mail_status(dbref player, const char *msglist, const char *status)
+{
+  int flag;
+  bool negate = 0;
+
+  if (!status || !*status) {
+    notify(player, T("MAIL: What do you want to do with the messages?"));
+    return;
+  }
+
+  if (string_prefix("read", status) || string_prefix("unread", status))
+    flag = M_MSGREAD;
+  else if (string_prefix("cleared", status)
+           || string_prefix("uncleared", status))
+    flag = M_CLEARED;
+  else if (string_prefix("tagged", status) || string_prefix("untagged", status))
+    flag = M_TAG;
+  else {
+    notify(player, T("MAIL: Unknown status."));
+    return;
+  }
+
+  if (*status == 'u' || *status == 'U')
+    negate = 1;
+
+  do_mail_flags(player, msglist, flag, negate);
+}
+
 
 /** Set or clear a flag on a set of messages.
  * \param player the enactor.
@@ -396,16 +440,14 @@
 {
   MAIL *mp;
   struct mail_selector ms;
-  int j;
   mail_flag folder;
   folder_array i;
-  int notified = 0;
+  int notified = 0, j = 0;
 
   if (!parse_msglist(msglist, &ms, player)) {
     return;
   }
-  FA_Init(i, j);
-  j = 0;
+  FA_Init(i);
   folder = AllInFolder(ms) ? player_folder(player) : MSFolder(ms);
   for (mp = find_exact_starting_point(player);
        mp && (mp->to == player); mp = mp->next) {
@@ -465,6 +507,27 @@
             }
           }
           break;
+        case M_MSGREAD:
+          if (All(ms)) {
+            if (!notified) {
+              if (negate) {
+                notify(player, T("MAIL: All messages in all folders unread."));
+              } else {
+                notify(player,
+                       T("MAIL: All messages in all folders marked as read."));
+              }
+              notified++;
+            }
+          } else {
+            if (negate) {
+              notify_format(player, T("MAIL: Msg #%d:%d unread"),
+                            (int) Folder(mp), i[Folder(mp)]);
+            } else {
+              notify_format(player, T("MAIL: Msg #%d:%d marked as read"),
+                            (int) Folder(mp), i[Folder(mp)]);
+            }
+          }
+          break;
         }
       }
     }
@@ -489,10 +552,10 @@
 {
   MAIL *mp;
   struct mail_selector ms;
-  int j, foldernum;
+  int foldernum;
   mail_flag origfold;
   folder_array i;
-  int notified = 0;
+  int notified = 0, j = 0;
 
   if (!parse_msglist(msglist, &ms, player)) {
     return;
@@ -501,8 +564,7 @@
     notify(player, T("MAIL: Invalid folder specification"));
     return;
   }
-  FA_Init(i, j);
-  j = 0;
+  FA_Init(i);
   origfold = AllInFolder(ms) ? player_folder(player) : MSFolder(ms);
   for (mp = find_exact_starting_point(player);
        mp && (mp->to == player); mp = mp->next) {
@@ -547,16 +609,15 @@
   char tbuf1[BUFFER_LEN];
   char folderheader[BUFFER_LEN];
   struct mail_selector ms;
-  int j;
   mail_flag folder;
   folder_array i;
+  int j = 0;
 
   if (!parse_msglist(msglist, &ms, player)) {
     return;
   }
   folder = AllInFolder(ms) ? player_folder(player) : MSFolder(ms);
-  FA_Init(i, j);
-  j = 0;
+  FA_Init(i);
   for (mp = find_exact_starting_point(player);
        mp && (mp->to == player); mp = mp->next) {
     if ((mp->to == player) && (All(ms) || Folder(mp) == folder)) {
@@ -605,7 +666,6 @@
   return;
 }
 
-
 /** List the flags, number, sender, subject, and date of messages in a
  * concise format.
  * \param player the enactor.
@@ -618,15 +678,13 @@
   char sender[30];
   MAIL *mp;
   struct mail_selector ms;
-  int j;
   mail_flag folder;
   folder_array i;
 
   if (!parse_msglist(msglist, &ms, player)) {
     return;
   }
-  FA_Init(i, j);
-  j = 0;
+  FA_Init(i);
   folder = AllInFolder(ms) ? player_folder(player) : MSFolder(ms);
   if (SUPPORT_PUEBLO)
     notify_noenter(player, open_tag("SAMP"));
@@ -757,7 +815,7 @@
   MAIL *mp;
   MAIL *last;
   struct mail_selector ms;
-  int j, num;
+  int num;
   mail_flag folder;
   folder_array i;
   const char *head;
@@ -788,7 +846,7 @@
   while (last->next && (last->next->to == player))
     last = last->next;
 
-  FA_Init(i, j);
+  FA_Init(i);
   while (mp && (mp->to == player) && (mp != last->next)) {
     if ((mp->to == player) && (All(ms) || (Folder(mp) == folder))) {
       i[Folder(mp)]++;
@@ -1021,8 +1079,7 @@
   a = atr_get_noparent(target, "MAILFORWARDLIST");
   if (!a) {
     /* Easy, no forwarding */
-    good =
-      real_send_mail(player, target, subject, message, flags, silent, nosig);
+    real_send_mail(player, target, subject, message, flags, silent, nosig);
     return;
   } else {
     /* We have a forward list. Run through it. */
Index: src/wait.c
===================================================================
--- src/wait.c	(.../184p0)	(revision 575)
+++ src/wait.c	(.../184p1)	(revision 575)
@@ -131,7 +131,7 @@
   if (newprio > 20)
     newprio = 20;
 
-#ifdef HAVE_SET_PRIORITY
+#ifdef HAVE_SETPRIORITY
   return setpriority(PRIO_PROCESS, pid, newprio);
 #else
   return 0;
Index: src/funcrypt.c
===================================================================
--- src/funcrypt.c	(.../184p0)	(revision 575)
+++ src/funcrypt.c	(.../184p1)	(revision 575)
@@ -71,7 +71,7 @@
     return false;
   }
 
-  len = BIO_flush(bio);
+  (void) BIO_flush(bio);
 
   len = BIO_get_mem_data(bmem, &membuf);
 
@@ -213,7 +213,7 @@
   int mod = end - start + 1;
   char *p, *q, *r;
 
-  if (!text && !*text)
+  if (!(text && *text))
     return (char *) "";
   if (!code || !*code)
     return text;
Index: src/mymalloc.c
===================================================================
--- src/mymalloc.c	(.../184p0)	(revision 575)
+++ src/mymalloc.c	(.../184p1)	(revision 575)
@@ -361,10 +361,8 @@
     return slab_alloc_obj(last->next);
   } else {
     struct slab_page *page, *last = NULL;
-    ptrdiff_t pgsize;
     /* Okay. We have a hint for where to allocate the object. Find the
        page the hint is on. */
-    pgsize = getpagesize();
     for (page = sl->slabs; page; page = page->next) {
       if (hint > (void *) page && hint <= page->last_obj) {
         /* If there's space, use this page, otherwise, if using
@@ -403,7 +401,6 @@
 slab_free(slab *sl, void *obj)
 {
   struct slab_page *page, *last;
-  ptrdiff_t pgsize;
 
   /* If objects are too big to fit in a single page, use plain free */
   if (sl->items_per_page == 0) {
@@ -412,7 +409,6 @@
   }
 
   /* Find the page the object is on and push it into that page's free list */
-  pgsize = getpagesize();
   last = NULL;
   for (page = sl->slabs; page; page = page->next) {
     if (obj > (void *) page && obj <= page->last_obj) {
Index: src/plyrlist.c
===================================================================
--- src/plyrlist.c	(.../184p0)	(revision 575)
+++ src/plyrlist.c	(.../184p1)	(revision 575)
@@ -193,10 +193,8 @@
 {
   char tbuf1[BUFFER_LEN];
   char tbuf2[BUFFER_LEN];
-  if (!oldname) {
-    oldname = Name(player);
+  if (!oldname)
     name = Name(player);
-  }
   if (oldalias) {
     mush_strncpy(tbuf1, oldalias, BUFFER_LEN);
     if (alias) {
Index: src/funlist.c
===================================================================
--- src/funlist.c	(.../184p0)	(revision 575)
+++ src/funlist.c	(.../184p1)	(revision 575)
@@ -36,14 +36,8 @@
 static void do_itemfuns(char *buff, char **bp, char *str, char *num,
                         char *word, char *sep, enum itemfun_op flag);
 
-char *iter_rep[MAX_ITERS];  /**< itext values */
-int iter_place[MAX_ITERS];  /**< inum numbers */
-int inum = 0;               /**< iter depth */
-int inum_limit = 0;         /**< limit of iter depth */
 extern const unsigned char *tables;
 
-#define RealGoodObject(x) (GoodObject(x) && !IsGarbage(x))
-
 /** Convert list to array.
  * Chops up a list of words into an array of words. The list is
  * destructively modified. The array returned consists of
@@ -59,7 +53,6 @@
 {
   char *p, *lp;
   int i;
-  int first;
   ansi_string *as;
   char *aptr;
 
@@ -70,7 +63,6 @@
 
   lp = list;
   p = split_token(&aptr, sep);
-  first = 0;
   for (i = 0; p && (i < max); i++, p = split_token(&aptr, sep)) {
     lp = list;
     safe_ansi_string(as, p - (as->text), strlen(p), list, &lp);
@@ -93,9 +85,8 @@
 int
 list2arr(char *r[], int max, char *list, char sep)
 {
-  char *p, *lp;
+  char *p;
   int i;
-  int first;
   char *aptr;
   size_t len;
 
@@ -105,9 +96,7 @@
 
   aptr = trim_space_sep(list, sep);
 
-  lp = list;
   p = split_token(&aptr, sep);
-  first = 0;
   for (i = 0; p && (i < max); i++, p = split_token(&aptr, sep)) {
     r[i] = p;
   }
@@ -1364,7 +1353,7 @@
   if (!s || !*s)                /* ran off the end of the string */
     return;
 
-  /* Chop off the end, and copy. No length checking needed. */
+  /* Chop off the end, tand copy. No length checking needed. */
   r = s;
   if (s && *s)
     (void) split_token(&s, sep);
@@ -2219,7 +2208,7 @@
   const char *replace[2];
 
 
-  if (inum >= MAX_ITERS) {
+  if (pe_info->iter_nesting >= MAX_ITERS) {
     safe_str(T("#-1 TOO MANY ITERS"), buff, bp);
     return;
   }
@@ -2262,8 +2251,8 @@
     return;
   }
 
-  inum++;
-  place = &iter_place[inum];
+  pe_info->iter_nesting++;
+  place = &pe_info->iter_inum[pe_info->iter_nesting];
   *place = 0;
   funccount = pe_info->fun_invocations;
   oldbp = *bp;
@@ -2272,7 +2261,7 @@
       safe_str(outsep, buff, bp);
     }
     *place = *place + 1;
-    iter_rep[inum] = tbuf1 = split_token(&lp, sep);
+    pe_info->iter_itext[pe_info->iter_nesting] = tbuf1 = split_token(&lp, sep);
     replace[0] = tbuf1;
     replace[1] = unparse_integer(*place);
     tbuf2 = replace_string2(standard_tokens, replace, args[1]);
@@ -2291,8 +2280,8 @@
     mush_free(tbuf2, "replace_string.buff");
   }
   *place = 0;
-  iter_rep[inum] = NULL;
-  inum--;
+  pe_info->iter_itext[pe_info->iter_nesting] = NULL;
+  pe_info->iter_nesting--;
   mush_free(outsep, "string");
   mush_free(list, "string");
 }
@@ -2300,7 +2289,7 @@
 /* ARGSUSED */
 FUNCTION(fun_ilev)
 {
-  safe_integer(inum - 1, buff, bp);
+  safe_integer(pe_info->iter_nesting, buff, bp);
 }
 
 /* ARGSUSED */
@@ -2314,12 +2303,12 @@
   }
   i = parse_integer(args[0]);
 
-  if (i < 0 || i >= inum || (inum - i) <= inum_limit) {
+  if (i < 0 || i > pe_info->iter_nesting || (pe_info->iter_nesting - i) < 0) {
     safe_str(T("#-1 ARGUMENT OUT OF RANGE"), buff, bp);
     return;
   }
 
-  safe_str(iter_rep[inum - i], buff, bp);
+  safe_str(pe_info->iter_itext[pe_info->iter_nesting - i], buff, bp);
 }
 
 /* ARGSUSED */
@@ -2333,12 +2322,12 @@
   }
   i = parse_integer(args[0]);
 
-  if (i < 0 || i >= inum || (inum - i) <= inum_limit) {
+  if (i < 0 || i > pe_info->iter_nesting || (pe_info->iter_nesting - i) < 0) {
     safe_str(T("#-1 ARGUMENT OUT OF RANGE"), buff, bp);
     return;
   }
 
-  safe_integer(iter_place[inum - i], buff, bp);
+  safe_integer(pe_info->iter_inum[pe_info->iter_nesting - i], buff, bp);
 }
 
 /* ARGSUSED */
Index: src/lock.c
===================================================================
--- src/lock.c	(.../184p0)	(revision 575)
+++ src/lock.c	(.../184p1)	(revision 575)
@@ -463,7 +463,6 @@
 add_lock(dbref player, dbref thing, lock_type type, boolexp key, privbits flags)
 {
   lock_list *ll, **t;
-  lock_type real_type = type;
 
   if (!GoodObject(thing)) {
     return 0;
@@ -488,7 +487,7 @@
       /* Oh, this sucks */
       do_log(LT_ERR, 0, 0, "Unable to malloc memory for lock_list!");
     } else {
-      real_type = st_insert(type, &lock_names);
+      lock_type real_type = st_insert(type, &lock_names);
       ll->type = real_type;
       ll->key = key;
       ll->creator = player;
Index: src/destroy.c
===================================================================
--- src/destroy.c	(.../184p0)	(revision 575)
+++ src/destroy.c	(.../184p1)	(revision 575)
@@ -576,7 +576,7 @@
     }
     break;
   default:
-    do_log(LT_ERR, NOTHING, NOTHING, "Surprising type in un_destroy.");
+    do_log(LT_ERR, NOTHING, NOTHING, "Surprising type in undestroy.");
     return 0;
   }
   return 1;
Index: src/match.c
===================================================================
--- src/match.c	(.../184p0)	(revision 575)
+++ src/match.c	(.../184p1)	(revision 575)
@@ -167,11 +167,14 @@
           /* Ignore any previous partial matches now we have an exact match */ \
           exact = 1; \
           curr = 1; \
+          right_type = 0; \
         } \
       } else { \
         /* Another partial match */ \
         curr++; \
       } \
+      if (type != NOTYPE && (Typeof(bestmatch) & type)) \
+        right_type++; \
     } else { \
       curr++; \
       if (curr == final) { \
@@ -306,18 +309,16 @@
     return 0;
   }
 
-  if (IsExit(match)) {
-    return check_alias(name, Name(match));
-  } else {
+  if (IsExit(match) && check_alias(name, Name(match)))
+    return 1;
+  else {
     char tbuf1[BUFFER_LEN];
     ATTR *a = atr_get_noparent(match, "ALIAS");
-    if (!a) {
+    if (!a)
       return 0;
-    }
     mush_strncpy(tbuf1, atr_value(a), BUFFER_LEN);
     return check_alias(name, tbuf1);
   }
-
 }
 
 dbref
@@ -330,6 +331,7 @@
   int final = 0;                /* the Xth object we want, with english matching (5th foo) */
   int curr = 0;                 /* the number of matches found so far, when 'final' is used */
   int nocontrol = 0;            /* set when we've matched an object, but don't control it and MAT_CONTROL is given */
+  int right_type = 0;           /* number of objects of preferred type found, when we have a type but MAT_TYPE isn't given */
   int exact = 0;                /* set to 1 when we've found an exact match, not just a partial one */
   int done = 0;                 /* set to 1 when we're using final, and have found the Xth object */
   int goodwho = GoodObject(who);
@@ -362,10 +364,13 @@
       ((type & TYPE_PLAYER) || !(flags & MAT_TYPE))) {
     match = match_player(who, xname, !(flags & MAT_EXACT));
     if (GoodObject(match)) {
-      if (MATCH_CONTROLS) {
-        return match;
-      } else {
-        nocontrol = 1;
+      if (!(flags & MAT_NEAR) || Long_Fingers(who) ||
+          (nearby(who, match) || controls(who, match))) {
+        if (MATCH_CONTROLS) {
+          return match;
+        } else {
+          nocontrol = 1;
+        }
       }
     } else {
       bestmatch = BEST_MATCH;
@@ -374,7 +379,7 @@
 
   /* dbref match */
   match = abs;
-  if (GoodObject(match) && (flags & MAT_ABSOLUTE) && MATCH_TYPE) {
+  if (RealGoodObject(match) && (flags & MAT_ABSOLUTE) && MATCH_TYPE) {
     if (!(flags & MAT_NEAR) || Long_Fingers(who)
         || (nearby(who, match) || controls(who, match))) {
       /* valid dbref match */
@@ -464,7 +469,8 @@
     /* we never found the Nth item */
     bestmatch = NOTHING;
   } else if (!final && curr > 1) {
-    if (!(flags & MAT_LAST)) {
+    /* If we had a preferred type, and only found 1 of that type, give that, otherwise ambiguous */
+    if (right_type != 1 && !(flags & MAT_LAST)) {
       bestmatch = AMBIGUOUS;
     }
   }
Index: src/ident.c
===================================================================
--- src/ident.c	(.../184p0)	(revision 575)
+++ src/ident.c	(.../184p1)	(revision 575)
@@ -455,7 +455,7 @@
   if (id->buf[pos - 1] != '\n')
     return 0;
 
-  id->buf[pos++] = '\0';
+  id->buf[pos] = '\0';
 
   /* Get first field (<lport> , <fport>) */
   cp = xstrtok(id->buf, ":", &c);
Index: src/look.c
===================================================================
--- src/look.c	(.../184p0)	(revision 575)
+++ src/look.c	(.../184p1)	(revision 575)
@@ -635,6 +635,7 @@
 {
   dbref thing;
   dbref loc;
+  int near;
 
   if (!GoodObject(Location(player)))
     return;
@@ -665,13 +666,14 @@
       notify(player, T("I don't know which one you mean."));
       return;
     }
+    near = (loc == Location(thing));
   } else {                      /* regular look */
     if (*name == '\0') {
       look_room(player, Location(player), LOOK_NORMAL);
       return;
     }
     /* look at a thing in location */
-    if ((thing = match_result(player, name, NOTYPE, MAT_NEARBY)) == NOTHING) {
+    if ((thing = match_result(player, name, NOTYPE, MAT_EVERYTHING)) == NOTHING) {
       dbref box;
       const char *boxname;
       char objnamebuf[BUFFER_LEN], *objname;
@@ -731,6 +733,7 @@
       notify(player, T("I can't tell which one you mean."));
       return;
     }
+    near = nearby(player, thing);
   }
 
   /* once we've determined the object to look at, it doesn't matter whether
@@ -743,7 +746,17 @@
   if (Location(player) == thing) {
     look_room(player, thing, LOOK_NORMAL);
     return;
+  } else if (!near && !Long_Fingers(player) && !See_All(player)) {
+    ATTR *desc;
+
+    desc = atr_get(thing, "DESCRIBE");
+    if ((desc && AF_Nearby(desc)) || (!desc && !READ_REMOTE_DESC)) {
+      notify_format(player, T("You can't see that from here."));
+      return;
+    }
   }
+
+
   switch (Typeof(thing)) {
   case TYPE_ROOM:
     look_room(player, thing, LOOK_NORMAL);
@@ -1145,7 +1158,6 @@
 do_sweep(dbref player, const char *arg1)
 {
   char tbuf1[BUFFER_LEN];
-  char *p;
   dbref here = Location(player);
   int connect_flag = 0;
   int here_flag = 0;
@@ -1225,9 +1237,7 @@
       /* listening exits only work if the room is AUDIBLE */
       for (here = Exits(Location(player)); here != NOTHING; here = Next(here)) {
         if (Audible(here)) {
-          strcpy(tbuf1, Name(here));
-          p = seek_char(tbuf1, ';');
-          *p = '\0';
+          copy_up_to(tbuf1, Name(here), ';');
           notify_format(player, T("%s [broadcasting]."), tbuf1);
         }
       }
Index: src/info_master.c
===================================================================
--- src/info_master.c	(.../184p0)	(revision 575)
+++ src/info_master.c	(.../184p1)	(revision 575)
@@ -369,7 +369,6 @@
 kill_info_slave(void)
 {
   WAIT_TYPE my_stat;
-  pid_t pid;
 
   if (info_slave_state != INFO_SLAVE_DOWN) {
     if (info_slave_pid > 0) {
@@ -383,7 +382,7 @@
          die. This will hopefully be enough time. */
       usleep(100);
 
-      pid = mush_wait(info_slave_pid, &my_stat, WNOHANG);
+      mush_wait(info_slave_pid, &my_stat, WNOHANG);
       info_slave_pid = -1;
       unblock_a_signal(SIGCHLD);
     }
Index: src/strutil.c
===================================================================
--- src/strutil.c	(.../184p0)	(revision 575)
+++ src/strutil.c	(.../184p1)	(revision 575)
@@ -30,12 +30,9 @@
 
 int format_long(intmax_t val, char *buff, char **bp, int maxlen, int base);
 
+/* Duplicate the first len characters of s */
 char *
 mush_strndup(const char *src, size_t len, const char *check)
-  __attribute_malloc__;
-
-/* Duplicate the first len characters of s */
-    char *mush_strndup(const char *src, size_t len, const char *check)
 {
   char *copy;
   size_t rlen = strlen(src);
@@ -1001,6 +998,29 @@
 
 }
 
+/* Copy a string up until a specific character (Or end of string.)
+ * Replaces the strcpy()/strchr()/*p=0 pattern.
+ * Input and output buffers shouldn't overlap.
+ * 
+ * \param dest buffer to copy into.
+ * \param src string to copy from.
+ * \param c character to stop at.
+ * \return pointer to the start of the string
+ */
+char *
+copy_up_to(char *RESTRICT dest, const char *RESTRICT src, char c)
+{
+  char *d;
+  d = dest;
+
+  for (d = dest; *src && *src != c; src++)
+    *d++ = *src;
+
+  *d = '\0';
+
+  return dest;
+}
+
 /** Given a string and a separator, trim leading and trailing spaces
  * if the separator is a space. This destructively modifies the string.
  * \param str string to trim.
Index: src/notify.c
===================================================================
--- src/notify.c	(.../184p0)	(revision 575)
+++ src/notify.c	(.../184p1)	(revision 575)
@@ -267,7 +267,6 @@
   char *o;
   const unsigned char *p;
   char *t;
-  int color = 0;
   int strip = 0;
   int pueblo = 0;
   static char tbuf[BUFFER_LEN];
@@ -392,7 +391,6 @@
   case NA_COLOR:
   case NA_TCOLOR:
   case NA_NCOLOR:
-    color = 1;
     /* FALLTHROUGH */
   case NA_ANSI:
   case NA_TANSI:
@@ -404,6 +402,8 @@
       case IAC:
         if (type == NA_TANSI || type == NA_TCOLOR)
           safe_strl("\xFF\xFF", 2, t, &o);
+        else if (pueblo)
+          safe_format(t, &o, "&#%d;", IAC);
         else if (strip && accent_table[IAC].base)
           safe_str(accent_table[IAC].base, t, &o);
         else
@@ -956,7 +956,7 @@
     /* If object is flagged AUDIBLE and has a @FORWARDLIST, send
      *  stuff on */
     if ((!(flags & NA_NORELAY) || (flags & NA_PUPPET)) && Audible(target)
-        && ((a = atr_get_noparent(target, "FORWARDLIST")) != NULL)
+        && atr_get_noparent(target, "FORWARDLIST") != NULL
         && !filter_found(target, msgbuf, 0)) {
       notify_list(speaker, target, "FORWARDLIST", msgbuf, flags);
 
@@ -1405,13 +1405,10 @@
   unsigned char *n;
   enum na_type poutput;
   struct notify_strings messages[MESSAGE_TYPES];
-  dbref target;
   int ret;
 
   zero_strings(messages);
 
-  target = d->player;
-
   poutput = notify_type(d);
 
   n = notify_makestring(s, messages, poutput, 0);
Index: src/game.c
===================================================================
--- src/game.c	(.../184p0)	(revision 575)
+++ src/game.c	(.../184p1)	(revision 575)
@@ -245,10 +245,8 @@
 rusage_stats(void)
 {
   struct rusage usage;
-  int pid;
   int psize;
 
-  pid = getpid();
   psize = getpagesize();
   getrusage(RUSAGE_SELF, &usage);
 
@@ -316,9 +314,13 @@
 
 #ifndef PROFILING
 #ifndef WIN32
+#ifdef __CYGWIN__
+  ignore_signal(SIGALRM);
+#else
   ignore_signal(SIGPROF);
-#endif
-#endif
+#endif                          /* __CYGWIN__ */
+#endif                          /* WIN32 */
+#endif                          /* PROFILING */
 
   if (setjmp(db_err)) {
     /* The dump failed. Disk might be full or something went bad with the
@@ -330,9 +332,13 @@
       penn_fclose(f);
 #ifndef PROFILING
 #ifdef HAS_ITIMER
+#ifdef __CYGWIN__
+    install_sig_handler(SIGALRM, signal_cpu_limit);
+#else
     install_sig_handler(SIGPROF, signal_cpu_limit);
-#endif
-#endif
+#endif                          /* __CYGWIN__ */
+#endif                          /* HAS_ITIMER */
+#endif                          /* PROFILING */
     return false;
   } else {
     local_dump_database();
@@ -407,9 +413,13 @@
 
 #ifndef PROFILING
 #ifdef HAS_ITIMER
+#ifdef __CYGWIN__
+  install_sig_handler(SIGALRM, signal_cpu_limit);
+#else
   install_sig_handler(SIGPROF, signal_cpu_limit);
 #endif
 #endif
+#endif
 
   return true;
 }
@@ -1248,9 +1258,11 @@
   /* command has been executed. Free up memory. */
 
 done:
-  mush_free(errdblist, "errdblist");
-  errdblist = errdbtail = NULL;
-  errdbsize = ERRDB_INITIAL_SIZE;
+  if (errdblist) {
+    mush_free(errdblist, "errdblist");
+    errdblist = errdbtail = NULL;
+    errdbsize = ERRDB_INITIAL_SIZE;
+  }
 }
 
 
@@ -1260,9 +1272,23 @@
   char *cptr = arg_right;
   dbref errdb;
 
-  what = noisy_match_result(player, arg_left, NOTYPE, MAT_NEARBY);
+  what = noisy_match_result(player, arg_left, NOTYPE, MAT_EVERYTHING);
   if (!GoodObject(what))
     return;
+  if (!(nearby(player, what) || Long_Fingers(player) || controls(player, what))) {
+    if (SW_ISSET(sw, SWITCH_ROOM)) {
+      if (what != MASTER_ROOM && what != Zone(player)) {
+        notify(player, T("I don't see that here."));
+        return;
+      } else if (what == Zone(player) && !IsRoom(what)) {
+        notify(player, T("Make room! Make room!"));
+        return;
+      }
+    } else if (what != Zone(player) || IsRoom(what)) {
+      notify(player, T("I don't see that here."));
+      return;
+    }
+  }
 
   errdbtail = errdblist;
   errdb = NOTHING;
@@ -1275,7 +1301,7 @@
   } else {
     /* Run commands on objects in a masterish room */
 
-    if (!IsRoom(what)) {
+    if (!IsRoom(what) && what != Location(player)) {
       notify(player, T("Make room! Make room!"));
       return;
     }
Index: src/parse.c
===================================================================
--- src/parse.c	(.../184p0)	(revision 575)
+++ src/parse.c	(.../184p1)	(revision 575)
@@ -371,11 +371,10 @@
 is_strict_number(char const *str)
 {
   char *end;
-  NVAL val;
   if (!str)
     return 0;
   errno = 0;
-  val = strtod(str, &end);
+  strtod(str, &end);
   if (errno == ERANGE || *end != '\0')
     return 0;
   return end > str;
@@ -415,11 +414,10 @@
 is_strict_integer(char const *str)
 {
   char *end;
-  int val;
   if (!str)
     return 0;
   errno = 0;
-  val = parse_int(str, &end, 10);
+  parse_int(str, &end, 10);
   if (errno == ERANGE || *end != '\0')
     return 0;
   return end > str;
@@ -585,6 +583,33 @@
 #pragma warning( disable : 4761)        /* NJG: disable warning re conversion */
 #endif
 
+PE_Info *
+make_pe_info()
+{
+  PE_Info *pe_info;
+
+  pe_info = (PE_Info *) mush_malloc(sizeof(PE_Info),
+                                    "process_expression.pe_info");
+  pe_info->fun_invocations = 0;
+  pe_info->fun_depth = 0;
+  pe_info->nest_depth = 0;
+  pe_info->call_depth = 0;
+  pe_info->debug_strings = NULL;
+  pe_info->arg_count = 0;
+  pe_info->iter_nesting = -1;
+
+  return pe_info;
+}
+
+void
+free_pe_info(PE_Info *pe_info)
+{
+  mush_free(pe_info, "process_expression.pe_info");
+  return;
+}
+
+
+
 
 /** Function and other substitution evaluation.
  * This is the PennMUSH function/expression parser. Big stuff.
@@ -650,7 +675,6 @@
   int had_space = 0;
   char temp[3];
   int temp_eflags;
-  int old_iter_limit;
   int qindex;
   int retval = 0;
 
@@ -679,19 +703,8 @@
     return 0;
 
   if (!pe_info) {
-    old_iter_limit = inum_limit;
-    inum_limit = inum;
     made_info = 1;
-    pe_info = (PE_Info *) mush_malloc(sizeof(PE_Info),
-                                      "process_expression.pe_info");
-    pe_info->fun_invocations = 0;
-    pe_info->fun_depth = 0;
-    pe_info->nest_depth = 0;
-    pe_info->call_depth = 0;
-    pe_info->debug_strings = NULL;
-    pe_info->arg_count = 0;
-  } else {
-    old_iter_limit = -1;
+    pe_info = make_pe_info();
   }
 
   /* If we've been asked to evaluate, log the expression if:
@@ -724,7 +737,6 @@
     goto exit_sequence;
   }
 
-
   if (eflags != PE_NOTHING) {
     debugging = (Debug(executor) || (eflags & PE_DEBUG))
       && (Connected(Owner(executor)) || atr_get(executor, "DEBUGFORWARDLIST"));
@@ -1023,11 +1035,12 @@
             break;
           }
           inum_this = nextc - '0';
-          if (inum_this < 0 || inum_this >= inum
-              || (inum - inum_this) <= inum_limit) {
+          if (inum_this < 0 || inum_this > pe_info->iter_nesting
+              || (pe_info->iter_nesting - inum_this) < 0) {
             safe_str(T("#-1 ARGUMENT OUT OF RANGE"), buff, bp);
           } else {
-            safe_str(iter_rep[inum - inum_this], buff, bp);
+            safe_str(pe_info->iter_itext[pe_info->iter_nesting - inum_this],
+                     buff, bp);
           }
           break;
         case 'U':
@@ -1572,10 +1585,7 @@
   if (pe_info && CALL_LIMIT && pe_info->call_depth <= CALL_LIMIT)
     pe_info->call_depth--;
   if (made_info)
-    mush_free(pe_info, "process_expression.pe_info");
-  if (old_iter_limit != -1) {
-    inum_limit = old_iter_limit;
-  }
+    free_pe_info(pe_info);
   return retval;
 }
 
Index: src/atr_tab.c
===================================================================
--- src/atr_tab.c	(.../184p0)	(revision 575)
+++ src/atr_tab.c	(.../184p1)	(revision 575)
@@ -156,6 +156,39 @@
   return (ATTR *) ptab_find_exact(&ptab_attrib, atrname);
 }
 
+/* Add a new, or restrict an existing, standard attribute from cnf file */
+int
+cnf_attribute_access(char *attrname, char *opts)
+{
+  ATTR *a;
+  privbits flags = 0;
+
+  upcasestr(attrname);
+  if (!good_atr_name(attrname))
+    return 0;
+
+  if (strcasecmp(opts, "none")) {
+    flags = list_to_privs(attr_privs_set, opts, 0);
+    if (!flags)
+      return 0;
+  }
+
+  a = (ATTR *) ptab_find_exact(&ptab_attrib, attrname);
+  if (a) {
+    if (AF_Internal(a))
+      return 0;
+  } else {
+    a = (ATTR *) mush_malloc(sizeof(ATTR), "ATTR");
+    if (!a)
+      return 0;
+    AL_NAME(a) = strdup(attrname);
+    a->data = NULL_CHUNK_REFERENCE;
+    ptab_insert_one(&ptab_attrib, attrname, a);
+  }
+  AL_FLAGS(a) = flags;
+  AL_CREATOR(a) = GOD;
+  return 1;
+}
 
 /** Add new standard attributes, or change permissions on them.
  * \verbatim
@@ -224,13 +257,16 @@
   }
 
   /* Ok, now we need to see if there are any attributes of this name
-   * set on objects in the db. If so, and if we're retroactive, set 
-   * perms/creator 
+   * set on objects in the db. If so, and if we're retroactive, set
+   * perms/creator
    */
   if (retroactive) {
     for (i = 0; i < db_top; i++) {
       if ((ap2 = atr_get_noparent(i, name))) {
-        AL_FLAGS(ap2) = flags;
+        if (AL_FLAGS(ap2) & AF_ROOT)
+          AL_FLAGS(ap2) = flags | AF_ROOT;
+        else
+          AL_FLAGS(ap2) = flags;
         AL_CREATOR(ap2) = player;
       }
     }
Index: src/command.c
===================================================================
--- src/command.c	(.../184p0)	(revision 575)
+++ src/command.c	(.../184p1)	(revision 575)
@@ -73,7 +73,7 @@
 const char *CommandLock = "CommandLock";
 
 /** The list of standard commands. Additional commands can be added
- * at runtime with add_command().
+ * at runtime with command_add().
  */
 COMLIST commands[] = {
 
@@ -107,9 +107,9 @@
 
   {"@CHOWN", "PRESERVE", cmd_chown,
    CMD_T_ANY | CMD_T_EQSPLIT | CMD_T_NOGAGGED, 0, 0},
-  {"@CHZONEALL", NULL, cmd_chzoneall, CMD_T_ANY | CMD_T_EQSPLIT, 0, 0},
+  {"@CHZONEALL", "PRESERVE", cmd_chzoneall, CMD_T_ANY | CMD_T_EQSPLIT, 0, 0},
 
-  {"@CHZONE", NULL, cmd_chzone,
+  {"@CHZONE", "PRESERVE", cmd_chzone,
    CMD_T_ANY | CMD_T_EQSPLIT | CMD_T_NOGAGGED, 0, 0},
   {"@CONFIG", "SET SAVE LOWERCASE LIST", cmd_config, CMD_T_ANY | CMD_T_EQSPLIT,
    0, 0},
@@ -198,7 +198,7 @@
   {"@LSET", NULL, cmd_lset,
    CMD_T_ANY | CMD_T_EQSPLIT | CMD_T_NOGAGGED, 0, 0},
   {"@MAIL",
-   "NOEVAL NOSIG STATS DSTATS FSTATS DEBUG NUKE FOLDERS UNFOLDER LIST READ CLEAR UNCLEAR PURGE FILE TAG UNTAG FWD FORWARD SEND SILENT URGENT",
+   "NOEVAL NOSIG STATS DSTATS FSTATS DEBUG NUKE FOLDERS UNFOLDER LIST READ UNREAD CLEAR UNCLEAR STATUS PURGE FILE TAG UNTAG FWD FORWARD SEND SILENT URGENT",
    cmd_mail, CMD_T_ANY | CMD_T_EQSPLIT, 0, 0},
 
   {"@MALIAS",
@@ -502,6 +502,7 @@
   cmd = slab_malloc(command_slab, NULL);
   memset(cmd, 0, sizeof(COMMAND_INFO));
   cmd->name = name;
+  cmd->cmdlock = TRUE_BOOLEXP;
   cmd->restrict_message = NULL;
   cmd->func = func;
   cmd->type = type;
@@ -551,6 +552,7 @@
       safe_chr('(', buff, &bp);
       safe_str(unparse_boolexp(NOTHING, cmd->cmdlock, UB_DBREF), buff, &bp);
       safe_str(")&", buff, &bp);
+      free_boolexp(cmd->cmdlock);
     }
     if (flagstr && *flagstr) {
       strcpy(list, flagstr);
@@ -600,6 +602,40 @@
   return command_find(name);
 }
 
+/* Add a new command from a .cnf file's "add_command" statement */
+int
+cnf_add_command(char *name, char *opts)
+{
+  COMMAND_INFO *command;
+  int flags = 0;
+  char *p, *one;
+
+  if (opts && *opts) {
+    p = trim_space_sep(opts, ' ');
+    while ((one = split_token(&p, ' '))) {
+      if (string_prefix("noparse", one)) {
+        flags |= CMD_T_NOPARSE;
+      } else if (string_prefix("rsargs", one)) {
+        flags |= CMD_T_RS_ARGS;
+      } else if (string_prefix("lsargs", one)) {
+        flags |= CMD_T_LS_ARGS;
+      } else if (string_prefix("eqsplit", one)) {
+        flags |= CMD_T_EQSPLIT;
+      } else {
+        return 0;               /* unknown option */
+      }
+    }
+  }
+
+  name = trim_space_sep(name, ' ');
+  upcasestr(name);
+  command = command_find(name);
+  if (command || !ok_command_name(name))
+    return 0;
+  command_add(mush_strdup(name, "command_add"), flags, NULL, 0,
+              (flags & CMD_T_NOPARSE ? NULL : "NOEVAL"), cmd_unimplemented);
+  return (command_find(name) != NULL);
+}
 
 /** Search for a command by (partial) name.
  * This function searches the command table for a (partial) name match
@@ -641,36 +677,6 @@
   return (COMMAND_INFO *) ptab_find_exact(&ptab_command, cmdname);
 }
 
-
-/** Modify a command's entry in the table.
- * Given a command name and other parameters, look up the command
- * in the table, and if it's there, modify the parameters.
- * \param name name of command to modify.
- * \param type new types for command, or -1 to leave unchanged.
- * \param key new boolexp to restrict command, or NULL to leave unchanged.
- * \param sw new mask of switches for command, or NULL to leave unchanged.
- * \param func new function to call, or NULL to leave unchanged.
- * \return pointer to modified command entry, or NULL.
- */
-COMMAND_INFO *
-command_modify(const char *name, int type,
-               boolexp key, switch_mask sw, command_func func)
-{
-  COMMAND_INFO *cmd;
-  cmd = command_find(name);
-  if (!cmd)
-    return NULL;
-  if (type != -1)
-    cmd->type = type;
-  if (key)
-    cmd->cmdlock = key;
-  if (sw)
-    SW_COPY(cmd->sw.mask, sw);
-  if (func)
-    cmd->func = func;
-  return cmd;
-}
-
 /** Convert a switch string to a switch mask.
  * Given a space-separated list of switches in string form, return
  * a pointer to a static switch mask.
@@ -816,7 +822,6 @@
 {
   struct bst_data sw_data;
   COMMAND_INFO *c;
-  size_t sl_size;
 
   command_state = CMD_LOAD_DONE;
 
@@ -828,7 +833,6 @@
   sw_data.table = dyn_switch_list;
   sw_data.n = 0;
   sw_data.start = sizeof switch_list / sizeof(SWITCH_VALUE);
-  sl_size = sw_data.start - 2;
   st_walk(&switch_names, build_switch_table, &sw_data);
   num_switches = sw_data.start;
   dyn_switch_list[sw_data.n].name = NULL;
@@ -945,7 +949,8 @@
     while (*f == ' ')
       f++;
     if (process_expression(to, &t, (const char **) &f, player, cause, cause,
-                           parse, (split | args), NULL)) {
+                           parse, (split | args),
+                           global_eval_context.pe_info)) {
       done = 1;
     }
     *t = '\0';
@@ -1167,7 +1172,8 @@
     process_expression(command, &c, (const char **) &p, player, cause, cause,
                        noevtoken ? PE_NOTHING :
                        ((PE_DEFAULT & ~PE_FUNCTION_CHECK) |
-                        PE_COMMAND_BRACES), PT_SPACE, NULL);
+                        PE_COMMAND_BRACES), PT_SPACE,
+                       global_eval_context.pe_info);
     *c = '\0';
     strcpy(commandraw, command);
     upcasestr(command);
@@ -1192,39 +1198,11 @@
     }
   }
 
-  /* Set up commandraw for future use. This will contain the canonicalization
-   * of the command name and may later have the parsed rest of the input
-   * appended at the position pointed to by c2.
-   */
-  c2 = c;
-  if (!cmd) {
-    c2 = commandraw + strlen(commandraw);
-  } else {
-    if (replacer) {
-      /* These commands don't allow switches, and need a space
-       * added after their canonical name
-       */
-      c2 = commandraw;
-      safe_str(cmd->name, commandraw, &c2);
-      safe_chr(' ', commandraw, &c2);
-    } else if (*c2 == '/') {
-      /* Oh... DAMN */
-      c2 = commandraw;
-      strcpy(switches, commandraw);
-      safe_str(cmd->name, commandraw, &c2);
-      t = strchr(switches, '/');
-      safe_str(t, commandraw, &c2);
-    } else {
-      c2 = commandraw;
-      safe_str(cmd->name, commandraw, &c2);
-    }
-  }
-
   /* Test if this either isn't a command, or is a disabled one
    * If so, return Fully Parsed string for further processing.
    */
-
   if (!cmd || (cmd->type & CMD_T_DISABLED)) {
+    c2 = commandraw + strlen(commandraw);
     if (*p) {
       if (*p == ' ') {
         safe_chr(' ', commandraw, &c2);
@@ -1233,17 +1211,42 @@
       process_expression(commandraw, &c2, (const char **) &p, player, cause,
                          cause, noevtoken ? PE_NOTHING :
                          ((PE_DEFAULT & ~PE_FUNCTION_CHECK) |
-                          PE_COMMAND_BRACES), PT_DEFAULT, NULL);
+                          PE_COMMAND_BRACES), PT_DEFAULT,
+                         global_eval_context.pe_info);
     }
     *c2 = '\0';
     command_parse_free_args;
     return commandraw;
-  }
-  /* Check the permissions */
-  if (!command_check(player, cmd, 1)) {
+  } else if (!command_check(player, cmd, 1)) {
+    /* No permission to use command, stop processing */
     command_parse_free_args;
     return NULL;
   }
+
+  /* Set up commandraw for future use. This will contain the canonicalization
+   * of the command name and will later have the parsed rest of the input
+   * appended at the position pointed to by c2.
+   */
+  c2 = c;
+  if (replacer) {
+    /* These commands don't allow switches, and need a space
+     * added after their canonical name
+     */
+    c2 = commandraw;
+    safe_str(cmd->name, commandraw, &c2);
+    safe_chr(' ', commandraw, &c2);
+  } else if (*c2 == '/') {
+    /* Oh... DAMN */
+    c2 = commandraw;
+    strcpy(switches, commandraw);
+    safe_str(cmd->name, commandraw, &c2);
+    t = strchr(switches, '/');
+    safe_str(t, commandraw, &c2);
+  } else {
+    c2 = commandraw;
+    safe_str(cmd->name, commandraw, &c2);
+  }
+
   /* Parse out any switches */
   sw = SW_ALLOC();
   swp = switches;
@@ -1400,10 +1403,10 @@
 #undef command_parse_free_args
 
 int
-run_command(COMMAND_INFO *cmd, dbref player, dbref cause, const char *commandraw,
-            switch_mask sw, char switch_err[BUFFER_LEN], const char *string,
-            char *swp, char *ap, char *ls, char *lsa[MAX_ARG], char *rs,
-            char *rsa[MAX_ARG])
+run_command(COMMAND_INFO *cmd, dbref player, dbref cause,
+            const char *commandraw, switch_mask sw, char switch_err[BUFFER_LEN],
+            const char *string, char *swp, char *ap, char *ls,
+            char *lsa[MAX_ARG], char *rs, char *rsa[MAX_ARG])
 {
 
   char *saveregs[NUMQ];
@@ -1522,6 +1525,11 @@
       command->restrict_message = mush_strdup(message, "cmd_restrict_message");
   }
 
+  if (command->cmdlock != TRUE_BOOLEXP) {
+    free_boolexp(command->cmdlock);
+    command->cmdlock = TRUE_BOOLEXP;
+  }
+
   key = parse_boolexp(player, restriction, CommandLock);
   if (key != TRUE_BOOLEXP) {
     /* A valid boolexp lock. Hooray. */
@@ -1587,8 +1595,8 @@
     restriction = tp;
   }
 
-  if ((command->
-       type & (CMD_T_GOD | CMD_T_NOGAGGED | CMD_T_NOGUEST | CMD_T_NOFIXED)))
+  if ((command->type &
+       (CMD_T_GOD | CMD_T_NOGAGGED | CMD_T_NOGUEST | CMD_T_NOFIXED)))
     make_boolexp = 1;
   else if ((command->type & CMD_T_ANY) != CMD_T_ANY)
     make_boolexp = 1;
@@ -1758,7 +1766,9 @@
   if (c1->restrict_message)
     c2->restrict_message =
       mush_strdup(c1->restrict_message, "cmd_restrict_message");
-  c2->cmdlock = c1->cmdlock;
+  if (c2->cmdlock != TRUE_BOOLEXP)
+    free_boolexp(c2->cmdlock);
+  c2->cmdlock = dup_bool(c1->cmdlock);
 
   if (c1->hooks.before.obj)
     c2->hooks.before.obj = c1->hooks.before.obj;
@@ -2168,6 +2178,85 @@
   }
 }
 
+/* Add/modify a hook from a cnf file */
+int
+cnf_hook_command(char *command, char *opts)
+{
+  dbref thing;
+  char *attrname, *p, *one;
+  enum hook_type flag;
+  COMMAND_INFO *cmd;
+  struct hook_data *h;
+
+  if (!opts || !*opts)
+    return 0;
+
+  cmd = command_find(command);
+  if (!cmd)
+    return 0;
+
+  p = trim_space_sep(opts, ' ');
+  if (!(one = split_token(&p, ' ')))
+    return 0;
+
+  if (string_prefix("before", one)) {
+    flag = HOOK_BEFORE;
+    h = &cmd->hooks.before;
+  } else if (string_prefix("after", one)) {
+    flag = HOOK_AFTER;
+    h = &cmd->hooks.after;
+  } else if (string_prefix("override", one)) {
+    flag = HOOK_OVERRIDE;
+    h = &cmd->hooks.override;
+  } else if (string_prefix("ignore", one)) {
+    flag = HOOK_IGNORE;
+    h = &cmd->hooks.ignore;
+  } else {
+    return 0;
+  }
+
+  if (!(one = split_token(&p, ' '))) {
+    /* Clear existing hook */
+    h->obj = NOTHING;
+    if (h->attrname) {
+      mush_free(h->attrname, "hook.attr");
+      h->attrname = NULL;
+    }
+    return 1;
+  }
+
+  if ((attrname = strchr(one, '/')) == NULL) {
+    if (flag != HOOK_OVERRIDE) {
+      return 0;                 /* attribute required */
+    }
+  } else {
+    *attrname++ = '\0';
+    upcasestr(attrname);
+  }
+
+  if (!is_strict_integer(one))
+    return 0;
+
+  thing = (dbref) parse_integer(one);
+  if (!GoodObject(thing) || IsGarbage(thing))
+    return 0;
+
+  if (attrname && !good_atr_name(attrname))
+    return 0;
+
+  h->obj = thing;
+  if (h->attrname) {
+    mush_free(h->attrname, "hook.attr");
+  }
+
+  if (attrname)
+    h->attrname = mush_strdup(attrname, "hook.attr");
+  else
+    h->attrname = NULL;
+  return 1;
+
+}
+
 /** Set up or remove a command hook.
  * \verbatim
  * This is the top-level function for @hook. If an object and attribute
@@ -2212,8 +2301,10 @@
   if (!obj && !attrname) {
     notify_format(player, T("Hook removed from %s."), cmd->name);
     h->obj = NOTHING;
-    mush_free(h->attrname, "hook.attr");
-    h->attrname = NULL;
+    if (h->attrname) {
+      mush_free(h->attrname, "hook.attr");
+      h->attrname = NULL;
+    }
   } else if (!obj || !*obj
              || (flag != HOOK_OVERRIDE && (!attrname || !*attrname))) {
     if (flag == HOOK_OVERRIDE) {
Index: src/timer.c
===================================================================
--- src/timer.c	(.../184p0)	(revision 575)
+++ src/timer.c	(.../184p1)	(revision 575)
@@ -96,9 +96,13 @@
 #endif
 #ifndef PROFILING
 #ifdef HAS_ITIMER
+#ifdef __CYGWIN__
+  install_sig_handler(SIGALRM, signal_cpu_limit);
+#else
   install_sig_handler(SIGPROF, signal_cpu_limit);
 #endif
 #endif
+#endif
 }
 
 /** Migrate some number of chunks.
@@ -287,7 +291,11 @@
 signal_cpu_limit(int signo __attribute__ ((__unused__)))
 {
   cpu_time_limit_hit = 1;
+#ifdef __CYGWIN__
+  reload_sig_handler(SIGALRM, signal_cpu_limit);
+#else
   reload_sig_handler(SIGPROF, signal_cpu_limit);
+#endif
 }
 #elif defined(WIN32)
 #if _MSC_VER <= 1100 && !defined(UINT_PTR)
@@ -323,7 +331,11 @@
       time_limit.it_value.tv_usec = t.rem * 1000;
       time_limit.it_interval.tv_sec = 0;
       time_limit.it_interval.tv_usec = 0;
+#ifdef __CYGWIN__
+      if (setitimer(ITIMER_REAL, &time_limit, NULL)) {
+#else
       if (setitimer(ITIMER_PROF, &time_limit, NULL)) {
+#endif                          /* __CYGWIN__ */
         penn_perror("setitimer");
         timer_set = 0;
       }
@@ -336,8 +348,8 @@
                         (TIMERPROC) win32_timer);
   else
     timer_set = 0;
-#endif
-#endif
+#endif                          /* HAS_ITIMER / WIN32 */
+#endif                          /* PROFILING */
 }
 
 /** Reset the cpu timer (after running a command).
@@ -353,14 +365,18 @@
     time_limit.it_value.tv_usec = 0;
     time_limit.it_interval.tv_sec = 0;
     time_limit.it_interval.tv_usec = 0;
+#ifdef __CYGWIN__
+    if (setitimer(ITIMER_REAL, &time_limit, &time_left))
+#else
     if (setitimer(ITIMER_PROF, &time_limit, &time_left))
+#endif                          /* __CYGWIN__ */
       penn_perror("setitimer");
 #elif defined(WIN32)
     KillTimer(NULL, timer_id);
-#endif
+#endif                          /* HAS_ITIMER / WIN32 */
   }
   cpu_time_limit_hit = 0;
   cpu_limit_warning_sent = 0;
   timer_set = 0;
-#endif
+#endif                          /* PROFILING */
 }
Index: src/help.c
===================================================================
--- src/help.c	(.../184p0)	(revision 575)
+++ src/help.c	(.../184p1)	(revision 575)
@@ -6,14 +6,14 @@
  *
  */
 #include "config.h"
-#define _XOPEN_SOURCE 600
+/* This might have to be uncommented on some linux distros... */
+/* #define _XOPEN_SOURCE 600 */
 #include <stdlib.h>
 #include <string.h>
 #include <ctype.h>
 #include <stdio.h>
 #include <errno.h>
 #include <fcntl.h>
-#include <strings.h>
 #include "conf.h"
 #include "externs.h"
 #include "command.h"
@@ -454,7 +454,8 @@
 
   /* Handle last topic */
   write_topic(pos);
-  qsort(topics, num_topics, sizeof(help_indx), topic_cmp);
+  if (topics)
+    qsort(topics, num_topics, sizeof(help_indx), topic_cmp);
   h->entries = num_topics;
   h->indx = topics;
   add_check("help_index");
Index: src/pcre.c
===================================================================
--- src/pcre.c	(.../184p0)	(revision 575)
+++ src/pcre.c	(.../184p1)	(revision 575)
@@ -1269,6 +1269,8 @@
 
 
 
+
+
 pcre_get_substring_list(const char *subject, int *ovector, int stringcount,
                         const char ***listptr);
 
@@ -1365,6 +1367,8 @@
 
 
 
+
+
 pcre_get_substring(const char *subject, int *ovector, int stringcount,
                    int stringnumber, const char **stringptr);
 
@@ -1428,6 +1432,8 @@
 
 
 
+
+
 pcre_get_named_substring(const pcre * code, const char *subject, int *ovector,
                          int stringcount, const char *stringname,
                          const char **stringptr);
@@ -2312,6 +2318,8 @@
 
 
 
+
+
 
 
 
Index: src/predicat.c
===================================================================
--- src/predicat.c	(.../184p0)	(revision 575)
+++ src/predicat.c	(.../184p1)	(revision 575)
@@ -667,9 +667,7 @@
 {
   char buf[BUFFER_LEN], *newlin, *ptr;
   FILE *fp;
-  char *upname;
 
-  upname = strupper(name);
   fp = fopen(NAMES_FILE, FOPEN_READ);
   if (!fp)
     return 0;
@@ -852,7 +850,7 @@
 /** Is a name ok for a command?
  * It must contain only uppercase alpha, numbers, or punctuation.
  * It must contain at least one uppercase alpha.
- * It may not begin with " : ; & ] \ and # (the special tokens).
+ * It may not begin with " : ; & [ ] \ and # (the special tokens).
  * \param name name to check.
  * \retval 1 name is acceptable.
  * \retval 0 name is not acceptable.
@@ -871,6 +869,7 @@
   case NOEVAL_TOKEN:
   case NUMBER_TOKEN:
   case '&':
+  case '[':
     return 0;
   default:
     if (!isupper((unsigned char) *name) && !isdigit((unsigned char) *name)
Index: src/switchinc.c
===================================================================
--- src/switchinc.c	(.../184p0)	(revision 575)
+++ src/switchinc.c	(.../184p1)	(revision 575)
@@ -131,6 +131,7 @@
   {"SPEAK", SWITCH_SPEAK},
   {"SPOOF", SWITCH_SPOOF},
   {"STATS", SWITCH_STATS},
+  {"STATUS", SWITCH_STATUS},
   {"SUMMARY", SWITCH_SUMMARY},
   {"TABLES", SWITCH_TABLES},
   {"TAG", SWITCH_TAG},
@@ -145,6 +146,7 @@
   {"UNGAG", SWITCH_UNGAG},
   {"UNHIDE", SWITCH_UNHIDE},
   {"UNMUTE", SWITCH_UNMUTE},
+  {"UNREAD", SWITCH_UNREAD},
   {"UNTAG", SWITCH_UNTAG},
   {"UNTIL", SWITCH_UNTIL},
   {"URGENT", SWITCH_URGENT},
Index: src/set.c
===================================================================
--- src/set.c	(.../184p0)	(revision 575)
+++ src/set.c	(.../184p1)	(revision 575)
@@ -100,7 +100,7 @@
         while (*eon && !isspace((unsigned char) *eon))
           eon++;
         if (*eon)
-          *(eon++) = '\0';
+          *eon = '\0';
       }
       if (!ok_player_name(bon, player, thing)) {
         notify(player, T("You can't give a player that name."));
@@ -349,7 +349,8 @@
  * \retval 1 successfully changed zone.
  */
 int
-do_chzone(dbref player, char const *name, char const *newobj, int noisy)
+do_chzone(dbref player, char const *name, char const *newobj, bool noisy,
+          bool preserve)
 {
   dbref thing;
   dbref zone;
@@ -432,10 +433,14 @@
   }
   /* everything is okay, do the change */
   Zone(thing) = zone;
+
   /* If we're not unzoning, and we're working with a non-player object,
-   * we'll remove wizard, royalty, inherit, and powers, for security.
+   * we'll remove wizard, royalty, inherit, and powers, for security, unless
+   * a wizard is changing the zone and explicitly says not to.
    */
-  if ((zone != NOTHING) && !IsPlayer(thing)) {
+  if (!Wizard(player))
+    preserve = 0;
+  if (!preserve && ((zone != NOTHING) && !IsPlayer(thing))) {
     /* if the object is a player, resetting these flags is rather
      * inconvenient -- although this may pose a bit of a security
      * risk. Be careful when @chzone'ing wizard or royal players.
@@ -792,7 +797,6 @@
     /* insert replacement string between every character */
     ansi_string *haystack;
     size_t last = 0;
-    int too_long = 0;
 
     haystack = parse_ansi_string(s);
 
@@ -802,7 +806,6 @@
         for (last = 0; last < (size_t) haystack->len; last++) {
           /* Add the next character */
           if (safe_ansi_string(haystack, last, 1, tbuf1, &tbufp)) {
-            too_long = 1;
             break;
           }
           if (!ansi_long_flag) {
@@ -811,7 +814,6 @@
           }
           /* Copy in r */
           if (safe_str(r, tbuf1, &tbufp)) {
-            too_long = 1;
             break;
           }
           if (!ansi_long_flag) {
Index: src/cque.c
===================================================================
--- src/cque.c	(.../184p0)	(revision 575)
+++ src/cque.c	(.../184p1)	(revision 575)
@@ -666,13 +666,16 @@
       local_break_called = 0;
       break_count = 100;
       *(global_eval_context.break_replace) = '\0';
-      if (!include_recurses)
+      if (!include_recurses) {
         start_cpu_timer();
+        global_eval_context.pe_info = make_pe_info();
+      }
       while (!cpu_time_limit_hit && *s) {
         r = global_eval_context.ccom;
         process_expression(global_eval_context.ccom, &r, &s,
                            global_eval_context.cplr, entry->cause,
-                           entry->cause, PE_NOTHING, PT_SEMI, NULL);
+                           entry->cause, PE_NOTHING, PT_SEMI,
+                           global_eval_context.pe_info);
         *r = '\0';
         if (*s == ';')
           s++;
@@ -727,10 +730,11 @@
             }
           }
           for (a = 0; a < NUMQ; a++)
-            if (!entry->rval[a])
+            if (!global_eval_context.renv[a] || !*global_eval_context.renv[a])
               tmp->rval[a] = NULL;
             else {
-              tmp->rval[a] = mush_strdup(entry->rval[a], "cqueue.rval");
+              tmp->rval[a] =
+                mush_strdup(global_eval_context.renv[a], "cqueue.rval");
             }
           global_eval_context.include_called = 0;
           /* Put the included actions in the clone */
@@ -746,8 +750,11 @@
           }
         }
       }
-      if (!include_recurses)
+      if (!include_recurses) {
         reset_cpu_timer();
+        free_pe_info(global_eval_context.pe_info);
+        global_eval_context.pe_info = NULL;
+      }
     }
   }
   return local_break_called;
Index: game/restrictcnf.dst
===================================================================
--- game/restrictcnf.dst	(.../184p0)	(revision 575)
+++ game/restrictcnf.dst	(.../184p1)	(revision 575)
@@ -25,6 +25,15 @@
 #
 # Command restrictions typically also apply to side-effect functions that
 # emulate the command.
+# See 'help restrict' for more informtation.
+
+# You can also create and/or restrict standard attributes, using:
+# restrict_attribute <attribute> <restriction>
+# where <restriction> is "none" for a standard attribute with no restrictions,
+# or a space-separated list of attribute flags, as per 
+# @attribute/access <attribute>=<restriction>. See 'help @attribute' and
+# 'help attribute flags' for more information.
+# For example, restrict_attribute stats wizard mortal_dark no_command no_inherit
 
 # Don't let guests mess with the database
 # (This replaces the HARSH_GUEST compile-time define)
Index: game/txt/hlp/pennchat.hlp
===================================================================
--- game/txt/hlp/pennchat.hlp	(.../184p0)	(revision 575)
+++ game/txt/hlp/pennchat.hlp	(.../184p1)	(revision 575)
@@ -268,6 +268,8 @@
   See "help @channel6" for more.
 & @channel6
 & @channel/mogrifier
+& mogrifier
+& mogrify
   @channel/mogrifier <channel>=<object>
 
   The Mogrifier lets you tweak every aspect of a channel's output, before
Index: game/txt/hlp/pennmail.hlp
===================================================================
--- game/txt/hlp/pennmail.hlp	(.../184p0)	(revision 575)
+++ game/txt/hlp/pennmail.hlp	(.../184p1)	(revision 575)
@@ -88,8 +88,8 @@
         Actually deletes all messages marked for clearing with @mail/clear.
         This is done automatically when you log out.
 
-  @mail/tag [<msg-list> | all>]
-  @mail/untag [<msg-list> | all>]
+  @mail/tag [<msg-list> | all]
+  @mail/untag [<msg-list> | all]
         These commands tag or untag mail in the current folder.
         Tagged mail can be later acted on en masse by using "tagged" as
         the msg-list for other commands (which does *not* untag them
@@ -98,6 +98,16 @@
         msg-list, all mail in *all* folders is tagged/untagged.
         (Ex: To clear all mail from Paul and Chani, @mail/tag *paul,
         @mail/tag *chani, @mail/clear tagged, @mail/untag all).
+        
+  @mail/unread [<msg-list> | all]
+        Mark messages which have already been read as new/unread.
+        
+  @mail/status [<msg-list> | all]=<status>
+        Set the status of the given messages. <status> can be one of tagged,
+        untagged, cleared, uncleared, read or unread. read marks a new
+        message as read without reading it, the others are equivilent to
+        @mail/tag, @mail/untag, @mail/clear, @mail/unclear and @mail/unread
+        respectively.
 & mail-folders
   The MUSH mail system allows each player 16 folders, numbered from 0
   to 15. Mail can only be in 1 folder at a time. Folder 0 is the
Index: game/txt/hlp/pennconf.hlp
===================================================================
--- game/txt/hlp/pennconf.hlp	(.../184p0)	(revision 575)
+++ game/txt/hlp/pennconf.hlp	(.../184p1)	(revision 575)
@@ -83,7 +83,7 @@
   rwall_prefix=<string>: Prefix for @rwall messages.
   wall_prefix=<string>: Prefix for @wall messages.
   announce_connects=<boolean>: Should (dis)connects be announced to 
-    non-MONITOR players and to channels?
+    non-HEAR_CONNECT players and to channels?
   chat_strip_quote=<boolean>:  Does +chan "foo strip the "?
   newline_one_char=<boolean>: Is strlen(%r) equal to 1?
   only_ascii_in_names=<boolean>: Names are ascii-only or are extended
@@ -100,7 +100,6 @@
   quota_cost=<number>: How much @quota goes down by for each object.
   find_cost=<number>: How many pennies it costs to use @search, @find,
    @entrances, and their function versions.
-  page_cost=<number>: How many pennies it costs to use page.  
   kill_default_cost=<number>: Default cost for kill.
   kill_min_cost=<number>: Smallest amount of pennies for kill.
   kill_bonus=<number>: What percent of the pennies spent for a successful
@@ -208,7 +207,7 @@
 
   max_aliases=<number>: The maximum number of aliases a player can have.
   keepalive_timeout=<time>: How often should an 'Are you still there?' query
-   be sent to connects, to stop players' routers booting idle connections?
+   be sent to clients, to stop players' routers booting idle connections?
   max_parents=<number>: The maximum number of levels of parenting allowed.
   call_limit=<number>: The maximum number of times the parser can be called
    recursively for any one expression.
Index: game/txt/hlp/index.hlp
===================================================================
--- game/txt/hlp/index.hlp	(.../184p0)	(revision 575)
+++ game/txt/hlp/index.hlp	(.../184p1)	(revision 575)
@@ -5,149 +5,150 @@
  $-commands2               %                         %!                       
  %#                        %2                        %3                       
  %4                        %:                        %@                       
- %a                        %i                        %n                       
- %o                        %p                        %s                       
- %~                        +                         1.50p6                   
- 1.50p7                    1.50p8                    1.50p9                   
- 1.50p10                   1.50p11                   1.50p12                  
- 1.50p13                   1.50p14                   1.50pdune1               
- 1.50pdune2                1.6.0p0                   1.6.0p3                  
- 1.6.0p4                   1.6.0p5                   1.6.1p0                  
- 1.6.1p1                   1.6.10p0                  1.6.10p1                 
- 1.6.10p2                  1.6.10p3                  1.6.10p4                 
- 1.6.10p5                  1.6.10p6                  1.6.2p0                  
- 1.6.2p1                   1.6.3p0                   1.6.3p1                  
+ %a                        %i                        %i0                      
+ %n                        %o                        %p                       
+ %s                        %~                        +                        
+ 1.50p6                    1.50p7                    1.50p8                   
+ 1.50p9                    1.50p10                   1.50p11                  
+ 1.50p12                   1.50p13                   1.50p14                  
+ 1.50pdune1                1.50pdune2                1.6.0p0                  
+ 1.6.0p3                   1.6.0p4                   1.6.0p5                  
+ 1.6.1p0                   1.6.1p1                   1.6.10p0                 
+ 1.6.10p1                  1.6.10p2                  1.6.10p3                 
+ 1.6.10p4                  1.6.10p5                  1.6.10p6                 
+ 1.6.2p0                   1.6.2p1                   1.6.3p0                  
 
 For more, see Entries-2
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-2
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
- 1.6.3p2                   1.6.3p3                   1.6.3p4                  
- 1.6.3p5                   1.6.3p6                   1.6.3p7                  
- 1.6.4p0                   1.6.4p1                   1.6.4p2                  
- 1.6.5p0                   1.6.5p1                   1.6.5p2                  
- 1.6.5p3                   1.6.5p4                   1.6.6p0                  
- 1.6.7p0                   1.6.7p1                   1.6.7p2                  
- 1.6.7p3                   1.6.7p4                   1.6.7p5                  
- 1.6.7p6                   1.6.8p0                   1.6.8p1                  
- 1.6.9p0                   1.6.9p1                   1.6.9p2                  
- 1.6.9p3                   1.6.9p4                   1.6.9p5                  
- 1.6.9p6                   1.6.9p7                   1.6.9p8                  
- 1.6.9p9                   1.7.0p0                   1.7.0p1                  
- 1.7.0p2                   1.7.0p3                   1.7.0p4                  
- 1.7.0p5                   1.7.0p6                   1.7.0p7                  
- 1.7.0p8                   1.7.0p9                   1.7.0p10                 
- 1.7.0p11                  1.7.1p0                   1.7.1p1                  
+ 1.6.3p1                   1.6.3p2                   1.6.3p3                  
+ 1.6.3p4                   1.6.3p5                   1.6.3p6                  
+ 1.6.3p7                   1.6.4p0                   1.6.4p1                  
+ 1.6.4p2                   1.6.5p0                   1.6.5p1                  
+ 1.6.5p2                   1.6.5p3                   1.6.5p4                  
+ 1.6.6p0                   1.6.7p0                   1.6.7p1                  
+ 1.6.7p2                   1.6.7p3                   1.6.7p4                  
+ 1.6.7p5                   1.6.7p6                   1.6.8p0                  
+ 1.6.8p1                   1.6.9p0                   1.6.9p1                  
+ 1.6.9p2                   1.6.9p3                   1.6.9p4                  
+ 1.6.9p5                   1.6.9p6                   1.6.9p7                  
+ 1.6.9p8                   1.6.9p9                   1.7.0p0                  
+ 1.7.0p1                   1.7.0p2                   1.7.0p3                  
+ 1.7.0p4                   1.7.0p5                   1.7.0p6                  
+ 1.7.0p7                   1.7.0p8                   1.7.0p9                  
+ 1.7.0p10                  1.7.0p11                  1.7.1p0                  
 
 For more, see Entries-3
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-3
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
- 1.7.1p2                   1.7.1p3                   1.7.2p0                  
- 1.7.2p1                   1.7.2p2                   1.7.2p3                  
- 1.7.2p4                   1.7.2p5                   1.7.2p6                  
- 1.7.2p7                   1.7.2p8                   1.7.2p9                  
- 1.7.2p10                  1.7.2p11                  1.7.2p12                 
- 1.7.2p13                  1.7.2p14                  1.7.2p15                 
- 1.7.2p16                  1.7.2p17                  1.7.2p18                 
- 1.7.2p19                  1.7.2p20                  1.7.2p21                 
- 1.7.2p22                  1.7.2p23                  1.7.2p24                 
- 1.7.2p25                  1.7.2p26                  1.7.2p27                 
- 1.7.2p28                  1.7.2p29                  1.7.2p30                 
- 1.7.2p31                  1.7.2p32                  1.7.2p33                 
- 1.7.2p34                  1.7.2p35                  1.7.3p0                  
- 1.7.3p1                   1.7.3p2                   1.7.3p3                  
- 1.7.3p4                   1.7.3p5                   1.7.3p6                  
- 1.7.3p7                   1.7.3p8                   1.7.3p9                  
+ 1.7.1p1                   1.7.1p2                   1.7.1p3                  
+ 1.7.2p0                   1.7.2p1                   1.7.2p2                  
+ 1.7.2p3                   1.7.2p4                   1.7.2p5                  
+ 1.7.2p6                   1.7.2p7                   1.7.2p8                  
+ 1.7.2p9                   1.7.2p10                  1.7.2p11                 
+ 1.7.2p12                  1.7.2p13                  1.7.2p14                 
+ 1.7.2p15                  1.7.2p16                  1.7.2p17                 
+ 1.7.2p18                  1.7.2p19                  1.7.2p20                 
+ 1.7.2p21                  1.7.2p22                  1.7.2p23                 
+ 1.7.2p24                  1.7.2p25                  1.7.2p26                 
+ 1.7.2p27                  1.7.2p28                  1.7.2p29                 
+ 1.7.2p30                  1.7.2p31                  1.7.2p32                 
+ 1.7.2p33                  1.7.2p34                  1.7.2p35                 
+ 1.7.3p0                   1.7.3p1                   1.7.3p2                  
+ 1.7.3p3                   1.7.3p4                   1.7.3p5                  
+ 1.7.3p6                   1.7.3p7                   1.7.3p8                  
 
 For more, see Entries-4
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-4
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
- 1.7.3p10                  1.7.3p11                  1.7.3p12                 
- 1.7.3p13                  1.7.3p14                  1.7.4p0                  
- 1.7.4p1                   1.7.4p2                   1.7.4p3                  
- 1.7.4p4                   1.7.4p5                   1.7.4p6                  
- 1.7.4p7                   1.7.4p8                   1.7.4p9                  
- 1.7.4p10                  1.7.4p11                  1.7.4p12                 
- 1.7.4p13                  1.7.4p14                  1.7.4p15                 
- 1.7.4p16                  1.7.4p17                  1.7.4p18                 
- 1.7.4p19                  1.7.4p20                  1.7.5p0                  
- 1.7.5p1                   1.7.5p2                   1.7.5p3                  
- 1.7.5p4                   1.7.5p5                   1.7.5p6                  
- 1.7.5p7                   1.7.5p8                   1.7.5p9                  
- 1.7.5p10                  1.7.5p11                  1.7.5p12                 
- 1.7.6p0                   1.7.6p1                   1.7.6p2                  
- 1.7.6p3                   1.7.6p4                   1.7.6p5                  
- 1.7.6p6                   1.7.6p7                   1.7.6p8                  
+ 1.7.3p9                   1.7.3p10                  1.7.3p11                 
+ 1.7.3p12                  1.7.3p13                  1.7.3p14                 
+ 1.7.4p0                   1.7.4p1                   1.7.4p2                  
+ 1.7.4p3                   1.7.4p4                   1.7.4p5                  
+ 1.7.4p6                   1.7.4p7                   1.7.4p8                  
+ 1.7.4p9                   1.7.4p10                  1.7.4p11                 
+ 1.7.4p12                  1.7.4p13                  1.7.4p14                 
+ 1.7.4p15                  1.7.4p16                  1.7.4p17                 
+ 1.7.4p18                  1.7.4p19                  1.7.4p20                 
+ 1.7.5p0                   1.7.5p1                   1.7.5p2                  
+ 1.7.5p3                   1.7.5p4                   1.7.5p5                  
+ 1.7.5p6                   1.7.5p7                   1.7.5p8                  
+ 1.7.5p9                   1.7.5p10                  1.7.5p11                 
+ 1.7.5p12                  1.7.6p0                   1.7.6p1                  
+ 1.7.6p2                   1.7.6p3                   1.7.6p4                  
+ 1.7.6p5                   1.7.6p6                   1.7.6p7                  
 
 For more, see Entries-5
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-5
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
- 1.7.6p9                   1.7.6p10                  1.7.6p11                 
- 1.7.6p12                  1.7.6p13                  1.7.6p14                 
- 1.7.6p15                  1.7.6p16                  1.7.7p0                  
- 1.7.7p1                   1.7.7p2                   1.7.7p3                  
- 1.7.7p4                   1.7.7p5                   1.7.7p6                  
- 1.7.7p7                   1.7.7p8                   1.7.7p9                  
- 1.7.7p10                  1.7.7p11                  1.7.7p12                 
- 1.7.7p13                  1.7.7p14                  1.7.7p15                 
- 1.7.7p16                  1.7.7p17                  1.7.7p18                 
- 1.7.7p19                  1.7.7p20                  1.7.7p21                 
- 1.7.7p22                  1.7.7p23                  1.7.7p24                 
- 1.7.7p25                  1.7.7p26                  1.7.7p27                 
- 1.7.7p28                  1.7.7p29                  1.7.7p30                 
- 1.7.7p31                  1.7.7p32                  1.7.7p33                 
- 1.7.7p34                  1.7.7p35                  1.7.7p36                 
- 1.7.7p37                  1.7.7p38                  1.7.7p39                 
+ 1.7.6p8                   1.7.6p9                   1.7.6p10                 
+ 1.7.6p11                  1.7.6p12                  1.7.6p13                 
+ 1.7.6p14                  1.7.6p15                  1.7.6p16                 
+ 1.7.7p0                   1.7.7p1                   1.7.7p2                  
+ 1.7.7p3                   1.7.7p4                   1.7.7p5                  
+ 1.7.7p6                   1.7.7p7                   1.7.7p8                  
+ 1.7.7p9                   1.7.7p10                  1.7.7p11                 
+ 1.7.7p12                  1.7.7p13                  1.7.7p14                 
+ 1.7.7p15                  1.7.7p16                  1.7.7p17                 
+ 1.7.7p18                  1.7.7p19                  1.7.7p20                 
+ 1.7.7p21                  1.7.7p22                  1.7.7p23                 
+ 1.7.7p24                  1.7.7p25                  1.7.7p26                 
+ 1.7.7p27                  1.7.7p28                  1.7.7p29                 
+ 1.7.7p30                  1.7.7p31                  1.7.7p32                 
+ 1.7.7p33                  1.7.7p34                  1.7.7p35                 
+ 1.7.7p36                  1.7.7p37                  1.7.7p38                 
 
 For more, see Entries-6
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-6
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
- 1.7.7p40                  1.8.0p0                   1.8.0p1                  
- 1.8.0p2                   1.8.0p3                   1.8.0p4                  
- 1.8.0p5                   1.8.0p6                   1.8.0p7                  
- 1.8.0p8                   1.8.0p9                   1.8.0p10                 
- 1.8.0p11                  1.8.0p12                  1.8.0p13                 
- 1.8.1p0                   1.8.1p1                   1.8.1p2                  
- 1.8.1p3                   1.8.1p4                   1.8.1p5                  
- 1.8.1p6                   1.8.1p7                   1.8.1p8                  
- 1.8.1p9                   1.8.1p10                  1.8.2p0                  
- 1.8.2p1                   1.8.2p2                   1.8.2p3                  
- 1.8.2p4                   1.8.2p5                   1.8.2p6                  
- 1.8.2p7                   1.8.2p8                   1.8.3p0                  
- 1.8.3p1                   1.8.3p2                   1.8.3p3                  
- 1.8.3p4                   1.8.3p5                   1.8.3p6                  
- 1.8.3p7                   1.8.3p8                   1.8.3p9                  
- 1.8.3p10                  1.8.3p11                  1.8.3p12                 
+ 1.7.7p39                  1.7.7p40                  1.8.0p0                  
+ 1.8.0p1                   1.8.0p2                   1.8.0p3                  
+ 1.8.0p4                   1.8.0p5                   1.8.0p6                  
+ 1.8.0p7                   1.8.0p8                   1.8.0p9                  
+ 1.8.0p10                  1.8.0p11                  1.8.0p12                 
+ 1.8.0p13                  1.8.1p0                   1.8.1p1                  
+ 1.8.1p2                   1.8.1p3                   1.8.1p4                  
+ 1.8.1p5                   1.8.1p6                   1.8.1p7                  
+ 1.8.1p8                   1.8.1p9                   1.8.1p10                 
+ 1.8.2p0                   1.8.2p1                   1.8.2p2                  
+ 1.8.2p3                   1.8.2p4                   1.8.2p5                  
+ 1.8.2p6                   1.8.2p7                   1.8.2p8                  
+ 1.8.3p0                   1.8.3p1                   1.8.3p2                  
+ 1.8.3p3                   1.8.3p4                   1.8.3p5                  
+ 1.8.3p6                   1.8.3p7                   1.8.3p8                  
+ 1.8.3p9                   1.8.3p10                  1.8.3p11                 
 
 For more, see Entries-7
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-7
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
- 1.8.3p13                  1.8.4p0                   :                        
- ;                         @-attributes              @-building               
- @-general                 @-wizard                  @@                       
- @@()                      @aahear                   @abuy                    
- @aclone                   @aconnect                 @adeath                  
- @adescribe                @adestroy                 @adisconnect             
- @adrop                    @aefail                   @aenter                  
- @afailure                 @afollow                  @agive                   
- @ahear                    @aidescribe               @aleave                  
- @alfail                   @alias                    @allhalt                 
- @allquota                 @amhear                   @amove                   
+ 1.8.3p12                  1.8.3p13                  1.8.4p0                  
+ 1.8.4p1                   :                         ;                        
+ @-attributes              @-building                @-general                
+ @-wizard                  @@                        @@()                     
+ @aahear                   @abuy                     @aclone                  
+ @aconnect                 @adeath                   @adescribe               
+ @adestroy                 @adisconnect              @adrop                   
+ @aefail                   @aenter                   @afailure                
+ @afollow                  @agive                    @ahear                   
+ @aidescribe               @aleave                   @alfail                  
+ @alias                    @allhalt                  @allquota                
+ @amail                    @amhear                   @amove                   
  @aname                    @apayment                 @areceive                
  @assert                   @asuccess                 @atport                  
  @atrchown                 @atrlock                  @attribute               
  @attribute2               @aufail                   @aunfollow               
- @ause                     @away                     @azenter                 
 
 For more, see Entries-8
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-8
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
+ @ause                     @away                     @azenter                 
  @azleave                  @boot                     @break                   
  @buy                      @cemit                    @channel                 
  @channel/add              @channel/buffer           @channel/chown           
@@ -163,12 +164,12 @@
  @chatformat2              @chatformat3              @chown                   
  @chownall                 @chzone                   @chzone2                 
  @chzoneall                @clock                    @clock2                  
- @clone                    @command                  @command2                
 
 For more, see Entries-9
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-9
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
+ @clone                    @command                  @command2                
  @command3                 @comment                  @config                  
  @config attribs           @config chat              @config cmds             
  @config cosmetic          @config cosmetic2         @config costs            
@@ -184,12 +185,12 @@
  @dig                      @dig2                     @disable                 
  @doing                    @dolist                   @drain                   
  @drop                     @dump                     @ealias                  
- @edit                     @efail                    @elock                   
 
 For more, see Entries-10
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-10
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
+ @edit                     @efail                    @elock                   
  @emit                     @enable                   @enter                   
  @entrances                @eunlock                  @exitformat              
  @failure                  @filter                   @filter2                 
@@ -205,12 +206,12 @@
  @invformat                @kick                     @lalias                  
  @leave                    @lemit                    @lfail                   
  @link                     @list                     @listen                  
- @listen2                  @listmotd                 @lock                    
 
 For more, see Entries-11
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-11
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
+ @listen2                  @listmotd                 @lock                    
  @lock-attribute           @lock-bit                 @lock-carry              
  @lock-channel             @lock-complex             @lock-eval2              
  @lock-evaluation          @lock-evaluation2         @lock-flag               
@@ -220,354 +221,356 @@
  @logwipe                  @lset                     @mail                    
  @mailfilter               @mailforwardlist          @malias                  
  @malias2                  @malias3                  @malias4                 
- @malias5                  @message                  @motd                    
- @move                     @mvattr                   @name                    
- @nameaccent               @nameformat               @newpassword             
- @notify                   @nscemit                  @nsemit                  
- @nslemit                  @nsoemit                  @nspemit                 
- @nsprompt                 @nsremit                  @nszemit                 
- @nuke                     @obuy                     @odeath                  
+ @malias5                  @message                  @message2                
+ @motd                     @move                     @mvattr                  
+ @name                     @nameaccent               @nameformat              
+ @newpassword              @notify                   @nscemit                 
+ @nsemit                   @nslemit                  @nsoemit                 
+ @nspemit                  @nsprompt                 @nsremit                 
 
 For more, see Entries-12
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-12
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
- @odescribe                @odrop                    @oefail                  
- @oemit                    @oenter                   @ofailure                
- @ofollow                  @ogive                    @oidescribe              
- @oleave                   @olfail                   @omove                   
- @oname                    @opayment                 @open                    
- @oreceive                 @osuccess                 @otport                  
- @oufail                   @ounfollow                @ouse                    
- @outpageformat            @outpageformat2           @oxenter                 
- @oxleave                  @oxmove                   @oxtport                 
- @ozenter                  @ozleave                  @pageformat              
- @pageformat2              @parent                   @password                
- @payment                  @pcreate                  @pemit                   
- @pemit2                   @poll                     @poor                    
- @power                    @power2                   @power3                  
- @prefix                   @pricelist                @prompt                  
- @ps                       @purge                    @quota                   
+ @nszemit                  @nuke                     @obuy                    
+ @odeath                   @odescribe                @odrop                   
+ @oefail                   @oemit                    @oenter                  
+ @ofailure                 @ofollow                  @ogive                   
+ @oidescribe               @oleave                   @olfail                  
+ @omove                    @oname                    @opayment                
+ @open                     @oreceive                 @osuccess                
+ @otport                   @oufail                   @ounfollow               
+ @ouse                     @outpageformat            @outpageformat2          
+ @oxenter                  @oxleave                  @oxmove                  
+ @oxtport                  @ozenter                  @ozleave                 
+ @pageformat               @pageformat2              @parent                  
+ @password                 @payment                  @pcreate                 
+ @pemit                    @pemit2                   @poll                    
+ @poor                     @power                    @power2                  
+ @power3                   @prefix                   @pricelist               
 
 For more, see Entries-13
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-13
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
- @readcache                @receive                  @recycle                 
- @rejectmotd               @remit                    @restart                 
- @runout                   @rwall                    @scan                    
- @search                   @search2                  @search3                 
- @search4                  @search5                  @select                  
- @set                      @sex                      @shutdown                
- @sitelock                 @sitelock2                @sitelock3               
- @sql                      @squota                   @startup                 
- @stats                    @success                  @sweep                   
- @switch                   @switch2                  @teleport                
- @tport                    @trigger                  @trigger2                
- @tz                       @ufail                    @ulock                   
- @undestroy                @unfollow                 @unlink                  
- @unlock                   @unrecycle                @uptime                  
- @uptime2                  @use                      @uunlock                 
- @verb                     @verb2                    @verb3                   
+ @prompt                   @ps                       @purge                   
+ @quota                    @readcache                @receive                 
+ @recycle                  @rejectmotd               @remit                   
+ @restart                  @runout                   @rwall                   
+ @scan                     @search                   @search2                 
+ @search3                  @search4                  @search5                 
+ @select                   @set                      @sex                     
+ @shutdown                 @sitelock                 @sitelock2               
+ @sitelock3                @speechmod                @sql                     
+ @squota                   @startup                  @stats                   
+ @success                  @sweep                    @switch                  
+ @switch2                  @teleport                 @tport                   
+ @trigger                  @trigger2                 @tz                      
+ @ufail                    @ulock                    @undestroy               
+ @unfollow                 @unlink                   @unlock                  
+ @unrecycle                @uptime                   @uptime2                 
 
 For more, see Entries-14
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-14
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
- @verb4                    @version                  @vrml_url                
- @wait                     @wait2                    @wait3                   
- @wall                     @warnings                 @warnings2               
- @warnings3                @wcheck                   @whereis                 
- @wipe                     @wizmotd                  @wizwall                 
- @zemit                    @zenter                   @zleave                  
- \                         ]                         ^                        
- ^-listens                 `                         `2                       
- `3                        `4                        abode                    
- abs()                     accent()                  accent2                  
- accent3                   accent4                   accname()                
- acos()                    action lists              action2                  
- add()                     after()                   ahelp                    
- alias()                   align()                   align2                   
- align3                    align4                    allof()                  
- alphamax()                alphamin()                ancestors                
+ @use                      @uunlock                  @verb                    
+ @verb2                    @verb3                    @verb4                   
+ @version                  @vrml_url                 @wait                    
+ @wait2                    @wait3                    @wall                    
+ @warnings                 @warnings2                @warnings3               
+ @wcheck                   @whereis                  @wipe                    
+ @wizmotd                  @wizwall                  @zemit                   
+ @zenter                   @zleave                   \                        
+ ]                         ^                         ^-listens                
+ `                         `2                        `3                       
+ `4                        abode                     abs()                    
+ accent()                  accent2                   accent3                  
+ accent4                   accname()                 acos()                   
+ action lists              action2                   add()                    
+ after()                   ahelp                     alias()                  
+ align()                   align2                    align3                   
 
 For more, see Entries-15
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-15
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
- and()                     andflags()                andlpowers()             
- anews                     angles                    anonymous attributes     
- anonymous2                anonymous3                anonymous4               
- ansi                      ansi()                    aposs()                  
- art()                     asin()                    atan()                   
- atan2()                   atrlock()                 attr trees               
- attr trees2               attr trees3               attr trees4              
- attrcnt()                 attrib trees              attrib trees2            
- attrib trees3             attrib trees4             attrib-ownership         
- attrib_set()              attribute flags           attribute flags2         
- attribute flags3          attribute functions       attribute list           
- attribute trees           attribute trees2          attribute trees3         
- attribute trees4          attributes                attributes list          
- attributes2               attributes3               attributes4              
- attrpcnt()                audible                   band()                   
- baseconv()                beep()                    before()                 
+ align4                    allof()                   alphamax()               
+ alphamin()                ancestors                 and()                    
+ andflags()                andlpowers()              anews                    
+ angles                    anonymous attributes      anonymous2               
+ anonymous3                anonymous4                ansi                     
+ ansi()                    aposs()                   art()                    
+ asin()                    atan()                    atan2()                  
+ atrlock()                 attr trees                attr trees2              
+ attr trees3               attr trees4               attrcnt()                
+ attrib trees              attrib trees2             attrib trees3            
+ attrib trees4             attrib-ownership          attrib_set()             
+ attribute flags           attribute flags2          attribute flags3         
+ attribute functions       attribute list            attribute trees          
+ attribute trees2          attribute trees3          attribute trees4         
+ attributes                attributes list           attributes2              
+ attributes3               attributes4               attrpcnt()               
 
 For more, see Entries-16
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-16
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
- being killed              benchmark()               bitwise functions        
- bnand()                   bnot()                    boolean functions        
- boolean values            boolean2                  boolean3                 
- bor()                     bound()                   brackets()               
- brief                     builder                   buy                      
- bxor()                    caller                    cand()                   
- capstr()                  case()                    caseall()                
- cat()                     cbuffer()                 cbufferadd()             
- cd                        cdesc()                   ceil()                   
- cemit()                   center()                  cflags()                 
- ch                        chan_usefirstmatch        changes                  
- channel functions         channel-list              channels()               
- charges2                  chat                      checkpass()              
- children()                chown_ok                  chr()                    
- clflags()                 clients                   clock()                  
- clone()                   cloudy                    cmds()                   
+ audible                   band()                    baseconv()               
+ beep()                    before()                  being killed             
+ benchmark()               bitwise functions         bnand()                  
+ bnot()                    boolean functions         boolean values           
+ boolean2                  boolean3                  bor()                    
+ bound()                   brackets()                brief                    
+ builder                   buy                       bxor()                   
+ caller                    cand()                    capstr()                 
+ case()                    caseall()                 cat()                    
+ cbuffer()                 cbufferadd()              cd                       
+ cdesc()                   ceil()                    cemit()                  
+ center()                  cflags()                  ch                       
+ chan_usefirstmatch        changes                   channel functions        
+ channel-list              channels()                charges2                 
+ chat                      checkpass()               children()               
+ chown_ok                  chr()                     clflags()                
 
 For more, see Entries-17
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-17
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
- cmsgs()                   code                      color                    
- commands                  communication functions   comp()                   
- comsys                    con()                     cond()                   
- condall()                 config()                  conn()                   
- connected                 connection functions      contact                  
- control                   controls()                convsecs()               
- convtime()                convutcsecs()             copyright                
- copyrite                  cor()                     cos()                    
- costs                     cowner()                  create()                 
- crecall()                 credits                   csecs()                  
- cstatus()                 ctime()                   ctitle()                 
- ctu()                     cusers()                  cv                       
- cwho()                    dark                      database                 
- dbref #                   dbref functions           dbref number             
- dbref2                    dbrefs                    debug                    
- debug2                    debugforwardlist          dec()                    
+ clients                   clock()                   clone()                  
+ cloudy                    cmds()                    cmsgs()                  
+ code                      color                     commands                 
+ communication functions   comp()                    comsys                   
+ con()                     cond()                    condall()                
+ config()                  conn()                    connected                
+ connection functions      contact                   control                  
+ controls()                convsecs()                convtime()               
+ convutcsecs()             copyright                 copyrite                 
+ cor()                     cos()                     costs                    
+ cowner()                  create()                  crecall()                
+ credits                   csecs()                   cstatus()                
+ ctime()                   ctitle()                  ctu()                    
+ cusers()                  cv                        cwho()                   
+ dark                      database                  dbref #                  
+ dbref functions           dbref number              dbref2                   
 
 For more, see Entries-18
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-18
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
- decode64()                decompose()               decrypt()                
- default()                 delete()                  desert                   
- destroy_ok                die()                     dig()                    
- digest()                  dismiss                   dist2d()                 
- dist3d()                  div()                     doing                    
- doing()                   download                  drop                     
- drop-tos                  droptos                   dynhelp()                
- e()                       edefault()                edit()                   
- element()                 elements()                elist()                  
- elock()                   emit()                    empty                    
- enactor                   encode64()                encrypt()                
- endtag()                  enter                     enter_ok                 
- entrances()               eq()                      escape()                 
- etimefmt()                etimefmt2                 etimefmt3                
- eval()                    evaluation order          evaluation2              
- events                    examine                   executor                 
+ dbrefs                    debug                     debug2                   
+ debugforwardlist          dec()                     decode64()               
+ decompose()               decrypt()                 default()                
+ delete()                  desert                    destroy_ok               
+ die()                     dig()                     digest()                 
+ dismiss                   dist2d()                  dist3d()                 
+ div()                     doing                     doing()                  
+ download                  drop                      drop-tos                 
+ droptos                   dynhelp()                 e()                      
+ edefault()                edit()                    element()                
+ elements()                elist()                   elock()                  
+ emit()                    empty                     enactor                  
+ encode64()                encrypt()                 endtag()                 
+ enter                     enter_ok                  entrances()              
+ eq()                      escape()                  etimefmt()               
+ etimefmt2                 etimefmt3                 eval()                   
 
 For more, see Entries-19
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-19
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
- exit()                    exits                     exp()                    
- extract()                 failure                   fdiv()                   
- filter()                  filterbool()              findable()               
- first()                   firstof()                 fixed                    
- flag list                 flag permissions          flags                    
- flags list                flags()                   flags2                   
- flip()                    floating                  floor()                  
- floordiv()                fmod()                    fn()                     
- fold()                    fold2                     folderstats()            
- follow                    followers()               following()              
- foreach()                 foreach2                  forwardlist              
- fraction()                fullalias()               fullname()               
- function list             functions                 functions()              
- functions2                gagged                    gender                   
- get                       get()                     get_eval()               
- getpids()                 give                      global commands          
+ evaluation order          evaluation2               events                   
+ examine                   executor                  exit()                   
+ exits                     exp()                     extract()                
+ failure                   fdiv()                    filter()                 
+ filterbool()              findable()                first()                  
+ firstof()                 fixed                     flag list                
+ flag permissions          flags                     flags list               
+ flags()                   flags2                    flip()                   
+ floating                  floor()                   floordiv()               
+ fmod()                    fn()                      fold()                   
+ fold2                     folderstats()             follow                   
+ followers()               following()               foreach()                
+ foreach2                  forwardlist               fraction()               
+ fullalias()               fullname()                function list            
+ functions                 functions()               functions2               
+ gagged                    gender                    get                      
 
 For more, see Entries-20
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-20
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
- globals                   go                        going                    
- going_twice               goto                      grab()                   
- graball()                 grep()                    grepi()                  
- gt()                      gte()                     halt                     
- hasattr()                 hasattrp()                hasattrpval()            
- hasattrval()              hasflag()                 haspower()               
- hastype()                 haven                     hear_connect             
- heavy                     height()                  help                     
- here                      hidden()                  home                     
- home()                    homes                     host()                   
- hostname()                html                      html functions           
- html()                    i18n                      idle                     
- idle()                    idlesecs()                if()                     
- ifelse()                  ilev()                    iname()                  
- inc()                     index                     index()                  
- info                      information functions     inherit                  
+ get()                     get_eval()                getpids()                
+ give                      global commands           globals                  
+ go                        going                     going_twice              
+ goto                      grab()                    graball()                
+ grep()                    grepi()                   gt()                     
+ gte()                     halt                      hasattr()                
+ hasattrp()                hasattrpval()             hasattrval()             
+ hasflag()                 haspower()                hastype()                
+ haven                     hear_connect              heavy                    
+ height()                  help                      here                     
+ hidden()                  home                      home()                   
+ homes                     host()                    hostname()               
+ html                      html functions            html()                   
+ i18n                      idle                      idle()                   
+ idlesecs()                if()                      ifelse()                 
+ ilev()                    iname()                   inc()                    
 
 For more, see Entries-21
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-21
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
- insert()                  interiors                 interiors2               
- internationalization      inum()                    inventory                
- ipaddr()                  isdaylight()              isdbref()                
- isint()                   isnum()                   isobjid()                
- isword()                  itemize()                 items()                  
- iter()                    iter2                     itext()                  
- judge                     jump_ok                   jury_ok                  
- keepalive                 kill                      lalign()                 
- lambda                    last                      last & lastlogout        
- last()                    lastip                    lastlogout               
- lastsite                  lattr()                   lattrp()                 
- lcon()                    lcstr()                   ldelete()                
- leave                     left()                    lemit()                  
- letq()                    lexits()                  lflags()                 
- license                   light                     link()                   
- link_ok                   linking                   list functions           
+ index                     index()                   info                     
+ information functions     inherit                   insert()                 
+ interiors                 interiors2                internationalization     
+ inum()                    inventory                 ipaddr()                 
+ isdaylight()              isdbref()                 isint()                  
+ isnum()                   isobjid()                 isword()                 
+ itemize()                 items()                   iter()                   
+ iter2                     itext()                   judge                    
+ jump_ok                   jury_ok                   keepalive                
+ kill                      lalign()                  lambda                   
+ last                      last & lastlogout         last()                   
+ lastip                    lastlogout                lastsite                 
+ lattr()                   lattrp()                  lcon()                   
+ lcstr()                   ldelete()                 leave                    
+ left()                    lemit()                   letq()                   
+ lexits()                  lflags()                  license                  
 
 For more, see Entries-22
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-22
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
- list()                    listen_parent             listening                
- listening2                listening3                lists                    
- lit()                     ljust()                   llockflags()             
- llocks()                  lmath()                   ln()                     
- lnum()                    loc()                     locale                   
- localize()                locate()                  locate2                  
- locate3                   lock keys                 lock list                
- lock types                lock types2               lock()                   
- lockflags()               locking                   lockkeys                 
- locklist                  lockowner()               locks                    
- locks()                   locktypes                 locktypes2               
- log()                     logout                    look                     
- look2                     looping                   loud                     
- lparent()                 lpids()                   lplayers()               
- lports()                  lpos()                    lsearch()                
- lsearch2                  lsearchr()                lset()                   
+ light                     link()                    link_ok                  
+ linking                   list functions            list()                   
+ listen_parent             listening                 listening2               
+ listening3                lists                     lit()                    
+ ljust()                   llockflags()              llocks()                 
+ lmath()                   ln()                      lnum()                   
+ loc()                     locale                    localize()               
+ locate()                  locate2                   locate3                  
+ lock keys                 lock list                 lock types               
+ lock types2               lock()                    lockflags()              
+ locking                   lockkeys                  locklist                 
+ lockowner()               locks                     locks()                  
+ locktypes                 locktypes2                log()                    
+ logout                    look                      look2                    
+ looping                   loud                      lparent()                
+ lpids()                   lplayers()                lports()                 
 
 For more, see Entries-23
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-23
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
- lstats()                  lt()                      lte()                    
- lthings()                 lvcon()                   lvexits()                
- lvplayers()               lvthings()                lwho()                   
- lwhoid()                  macros                    macros2                  
- mail                      mail functions            mail()                   
- mail-admin                mail-folders              mail-forward             
- mail-other                mail-reading              mail-sending             
- maildstats()              mailfilter                mailfrom()               
- mailfstats()              mailsend()                mailstats()              
- mailstatus()              mailsubject()             mailtime()               
- malias()                  map()                     mapsql()                 
- master room               match()                   matchall()               
- matching                  math functions            max()                    
- me                        mean()                    median()                 
- member()                  merge()                   message()                
- mid()                     min()                     mistrust                 
+ lpos()                    lsearch()                 lsearch2                 
+ lsearchr()                lset()                    lstats()                 
+ lt()                      lte()                     lthings()                
+ lvcon()                   lvexits()                 lvplayers()              
+ lvthings()                lwho()                    lwhoid()                 
+ macros                    macros2                   mail                     
+ mail functions            mail()                    mail-admin               
+ mail-folders              mail-forward              mail-other               
+ mail-reading              mail-sending              maildstats()             
+ mailfilter                mailfrom()                mailfstats()             
+ mailsend()                mailstats()               mailstatus()             
+ mailsubject()             mailtime()                malias()                 
+ map()                     mapsql()                  master room              
+ match()                   matchall()                matching                 
+ math functions            max()                     me                       
+ mean()                    median()                  member()                 
 
 For more, see Entries-24
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-24
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
- mix()                     mix2                      mod()                    
- modulo()                  modulus()                 money                    
- money()                   monitor                   move                     
- msecs()                   mtime()                   mudname()                
- mul()                     munge()                   munge2                   
- munge3                    mushcode                  mushcode2                
- mwho()                    mwhoid()                  myopic                   
- name()                    namegrab()                namegraball()            
- namelist()                nand()                    nattr()                  
- nattrp()                  ncand()                   nchildren()              
- ncon()                    ncond()                   ncondall()               
- ncor()                    nearby()                  neq()                    
- newbie                    newbie2                   newbie3                  
- news                      nexits()                  next()                   
- nextdbref()               nlsearch()                nmwho()                  
- no_command                no_leave                  no_log                   
+ merge()                   message()                 mid()                    
+ min()                     mistrust                  mix()                    
+ mix2                      mod()                     modulo()                 
+ modulus()                 mogrifier                 mogrify                  
+ money                     money()                   monitor                  
+ move                      msecs()                   mssp-request             
+ mtime()                   mudname()                 mul()                    
+ munge()                   munge2                    munge3                   
+ mushcode                  mushcode2                 mwho()                   
+ mwhoid()                  myopic                    name()                   
+ namegrab()                namegraball()             namelist()               
+ nand()                    nattr()                   nattrp()                 
+ ncand()                   nchildren()               ncon()                   
+ ncond()                   ncondall()                ncor()                   
+ nearby()                  neq()                     newbie                   
+ newbie2                   newbie3                   news                     
 
 For more, see Entries-25
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-25
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
- no_tel                    no_warn                   noaccents                
- noleave                   non-standard attributes   noname                   
- nor()                     nospace                   nospoof                  
- not()                     nowarn                    nplayers()               
- nsearch()                 nsemit()                  nslemit()                
- nsoemit()                 nspemit()                 nsprompt()               
- nsremit()                 nszemit()                 nthings()                
- null()                    num()                     numversion()             
- nvcon()                   nvexits()                 nvplayers()              
- nvthings()                nwho()                    obj()                    
- object parents            objects                   objeval()                
- objid()                   objmem()                  oemit()                  
- on-vacation               opaque                    open()                   
- open_ok                   or()                      ord()                    
- ordinal()                 orflags()                 orlflags()               
- orlpowers()               orphan                    outputprefix             
+ nexits()                  next()                    nextdbref()              
+ nlsearch()                nmwho()                   no_command               
+ no_leave                  no_log                    no_tel                   
+ no_warn                   noaccents                 noleave                  
+ non-standard attributes   noname                    nor()                    
+ nospace                   nospoof                   not()                    
+ nowarn                    nplayers()                nsearch()                
+ nsemit()                  nslemit()                 nsoemit()                
+ nspemit()                 nsprompt()                nsremit()                
+ nszemit()                 nthings()                 null()                   
+ num()                     numversion()              nvcon()                  
+ nvexits()                 nvplayers()               nvthings()               
+ nwho()                    obj()                     object parents           
+ objects                   objeval()                 objid()                  
+ objmem()                  oemit()                   on-vacation              
+ opaque                    open()                    open_ok                  
 
 For more, see Entries-26
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-26
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
- outputsuffix              owner()                   page                     
- page2                     paranoid                  parent                   
- parent()                  parents                   parents2                 
- parents3                  parents4                  parents5                 
- parse()                   patchlevels               pcreate()                
- pemit()                   pfun()                    pfun2                    
- pfun3                     pi()                      pickrand()               
- pidinfo()                 player()                  playermem()              
- players                   pmatch()                  poll()                   
- ports()                   pos()                     pose                     
- pose2                     poss()                    power()                  
- powers list               powers list2              powers()                 
- powers2                   prompt()                  prompt_newlines          
- pueblo                    pueblo features           pueblo()                 
- puppet                    puppets                   puppets2                 
- queue                     quiet                     quit                     
+ or()                      ord()                     ordinal()                
+ orflags()                 orlflags()                orlpowers()              
+ orphan                    outputprefix              outputsuffix             
+ owner()                   page                      page2                    
+ paranoid                  parent                    parent()                 
+ parents                   parents2                  parents3                 
+ parents4                  parents5                  parse()                  
+ patchlevels               pcreate()                 pemit()                  
+ pfun()                    pfun2                     pfun3                    
+ pi()                      pickrand()                pidinfo()                
+ player()                  playermem()               players                  
+ pmatch()                  poll()                    ports()                  
+ pos()                     pose                      pose2                    
+ poss()                    power()                   powers list              
+ powers list2              powers()                  powers2                  
+ prompt()                  prompt_newlines           pueblo                   
 
 For more, see Entries-27
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-27
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
- quota()                   r()                       r-function               
- rand()                    randword()                read                     
- recv()                    regedit()                 regeditall()             
- regeditalli()             regediti()                regexp                   
- regexp classes            regexp classes2           regexp examples          
- regexp syntax             regexp syntax2            regexp syntax3           
- regexp syntax4            regexp syntax5            regexp syntax6           
- regexp syntax7            regexp syntax8            regexps                  
- regexps2                  registers                 registers2               
- reglattr()                reglattrp()               regmatch()               
- regmatchi()               regnattr()                regnattrp()              
- regrab()                  regraball()               regraballi()             
- regrabi()                 regrep()                  regrepi()                
- regular expression functions                        regxattr()               
- regxattrp()               remainder()               remit()                  
- remove()                  repeat()                  replace()                
+ pueblo features           pueblo()                  puppet                   
+ puppets                   puppets2                  queue                    
+ quiet                     quit                      quota()                  
+ r()                       r-function                rand()                   
+ randword()                read                      recv()                   
+ regedit()                 regeditall()              regeditalli()            
+ regediti()                regexp                    regexp classes           
+ regexp classes2           regexp examples           regexp syntax            
+ regexp syntax2            regexp syntax3            regexp syntax4           
+ regexp syntax5            regexp syntax6            regexp syntax7           
+ regexp syntax8            regexps                   regexps2                 
+ registers                 registers2                reglattr()               
+ reglattrp()               regmatch()                regmatchi()              
+ regnattr()                regnattrp()               regrab()                 
+ regraball()               regraballi()              regrabi()                
+ regrep()                  regrepi()                                          
 
 For more, see Entries-28
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-28
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
+ regular expression functions                        regxattr()               
+ regxattrp()               remainder()               remit()                  
+ remove()                  repeat()                  replace()                
  rest()                    restarts()                restarttime()            
  restrict                  restrict2                 restrict3                
  reswitch()                reswitchall()             reswitchalli()           
@@ -581,14 +584,14 @@
  scramble()                screenheight              screenwidth              
  search()                  search2                   secs()                   
  secure()                  semaphores                semaphores2              
- semaphores3               semaphores4               semaphores5              
- semaphores6               semipose                  sent()                   
- session                   set()                     setdiff()                
 
 For more, see Entries-29
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-29
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
+ semaphores3               semaphores4               semaphores5              
+ semaphores6               semipose                  sent()                   
+ session                   set()                     setdiff()                
  setinter()                setq()                    setq2                    
  setq3                     setr()                    setting-attributes       
  setunion()                sex                       sha0()                   
@@ -602,14 +605,14 @@
  speak2                    speak3                    speak4                   
  speak5                    speak6                    speak7                   
  speakpenn()               spellnum()                splice()                 
- spoofing                  sql examples              sql functions            
- sql()                     sqlescape()               sqrt()                   
- squish()                  ssl()                     stack                    
 
 For more, see Entries-30
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-30
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
+ spoofing                  sql examples              sql functions            
+ sql()                     sqlescape()               sqrt()                   
+ squish()                  ssl()                     stack                    
  starttime()               stats()                   stddev()                 
  step()                    sticky                    strallof()               
  strcat()                  strfirstof()              string functions         
@@ -623,14 +626,14 @@
  t()                       table()                   tag()                    
  tagwrap()                 take                      tan()                    
  teach                     tel()                     tel_ok                   
- terminfo()                terse                     testlock()               
- textentries()             textfile()                things                   
- think                     time functions            time()                   
 
 For more, see Entries-31
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-31
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
+ terminfo()                terse                     testlock()               
+ textentries()             textfile()                things                   
+ think                     time functions            time()                   
  timefmt()                 timefmt2                  timestring()             
  topics                    topics2                   tr()                     
  track_money               translation               transparent              
@@ -644,14 +647,14 @@
  unfollow                  uninspected               unique()                 
  unregistered              unsetq()                  use                      
  user-defined commands     user-defined2             utctime()                
- utility functions         v()                       v-function               
- vadd()                    val()                     valid()                  
- vcross()                  vdim()                    vdot()                   
 
 For more, see Entries-32
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-32
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
+ utility functions         v()                       v-function               
+ vadd()                    val()                     valid()                  
+ vcross()                  vdim()                    vdot()                   
  vector functions          verbose                   verbs                    
  verbs2                    version()                 visible()                
  visual                    vmag()                    vmax()                   
@@ -665,14 +668,14 @@
  words()                   wrap()                    xattr()                  
  xattrp()                  xcon()                    xexits()                 
  xget                      xmwho()                   xmwhoid()                
- xor()                     xplayers()                xthings()                
- xvcon()                   xvexits()                 xvplayers()              
- xvthings()                xwho()                    xwhoid()                 
 
 For more, see Entries-33
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 & Entries-33
 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
+ xor()                     xplayers()                xthings()                
+ xvcon()                   xvexits()                 xvplayers()              
+ xvthings()                xwho()                    xwhoid()                 
  z_tel                     zemit()                   zfun()                   
  zmo                       zmp                       zmr                      
  zmt                       zmwho()                   zone                     
Index: game/txt/hlp/pennfunc.hlp
===================================================================
--- game/txt/hlp/pennfunc.hlp	(.../184p0)	(revision 575)
+++ game/txt/hlp/pennfunc.hlp	(.../184p1)	(revision 575)
@@ -363,7 +363,7 @@
  
   Examples:
     > say after(foo bar baz,bar)
-    You say, "baz"
+    You say, " baz"
     
     > say after(foo bar baz,ba)
     You say, "r baz"
@@ -1056,6 +1056,7 @@
 
   As a refresher, there are 180 degrees in pi radians in 200 gradians.
 
+See also: acos(), asin(), atan(), cos(), ctu(), sin(), tan()
 & CTU()
   ctu(<angle>, <from>, <to>)
 
@@ -1161,7 +1162,7 @@
     > say delete(abcdefgh, 3, -2)
     You say, "abefgh"
 
-See also: strreplace()
+See also: strreplace(), strinsert(), mid()
 & DIE()
   die(<number of times to roll die>, <number of sides on die>[, <show>])
  
@@ -1719,7 +1720,7 @@
   
 See also: list(), config()
 & GET()
-& XGET
+& XGET()
   get(<object>/<attribute>)
   xget(<object>, <attribute>)
 
@@ -2145,6 +2146,7 @@
 & ITEXT()
 & INUM()
 & %i
+& %i0
   ilev()
   itext(<n>)
   %i<n>
@@ -2245,7 +2247,7 @@
 
 See also: lattr(), hasattr(), xattr(), wildcards
 & LCON()
-  lcon(<object>)
+  lcon(<object>[, <type>])
 
   Returns a list of the dbrefs of objects which are located in <object>.
 
@@ -2256,8 +2258,16 @@
   regardless of whether or not you have objects in it.
   
   When used on exits, this function returns #-1.
+  
+  For compatability with other codebases, a <type> can be given to limit
+  the results. Valid <type>s are:
+    player             - equivilent to lplayers(<object>)
+    connect            - equivilent to lvplayers(<object>)
+    thing (or object)  - equivilent to lthings(<object>)
+    listen             - return only listening objects
+    puppet             - return only THINGs set PUPPET
 
-See also: lexits(), lplayers(), con(), next(), lvcon()
+See also: lexits(), lplayers(), lthings(), con(), next(), lvcon()
 & LCSTR()
   lcstr(<string>)
 
@@ -2440,12 +2450,15 @@
   exits, and #-3 for exits @linked to "home".
   
   You must be able to examine <object>, or be near it, for this function
-  to work.
+  to work. A special case exists when <object> is a player: As long as
+  <object> is not set UNFINDABLE, and you are allowed to use the @whereis
+  command, you can get <object>'s location.
   
   You can also get the location of the enactor using the %L substitution,
   whether you are near to/can examine it or not.
   
-See also: locate(), rloc(), home(), where(), rnum(), room(), @link
+See also: locate(), rloc(), home(), where(), rnum(), room(), @link,
+  UNFINDABLE, @whereis
 & LOCALIZE()
   localize(<code>)
 
@@ -3369,14 +3382,16 @@
   nsoemit() works like @nsoemit.
 
 & OPEN()
-  open(<exit name>, <room>)
+  open(<exit name>[, <destination>[, <source>]])
+  
+  This function attempts to open an exit named <exit name>. The exit will be
+  opened in the room <source>, if given, or the caller's current location if
+  no <source> is specified.
+  
+  If a <destination> is given, it will attempt to link the exit to 
+  <destination> after opening it.
  
-  This function opens an exit called <exit name> in the caller's current
-  location, and then attempts to link it to the room <room>, as per
-  @open <exit name>=<room>. If you want to open an unlinked exit, use
-  an empty string for <room>.
-
-See also: @open, @link 
+See also: @open, @link
 & OR()
 & COR()
   or(<boolean1>, <boolean2>[, ... , <booleanN>])
@@ -3404,7 +3419,7 @@
     > say orflags(%#, WD!A)
     > say orlflags(%#, wizard dark !ansi)
   
-See also: andflags(), flags(), lflags()
+See also: andflags(), flags(), lflags(), orlpowers()
 & ORLPOWERS()
   orlpowers(<object>, <list of powers>)
 
@@ -3420,7 +3435,7 @@
   If a name does not correspond to any power, orlpowers() returns 
   "#-1 INVALID POWER".
   
-See also: powers(), andlpowers(), POWERS LIST, @power
+See also: powers(), andlpowers(), POWERS LIST, @power, orlflags()
 & OWNER()
   owner(<object>[/<attribute>])
  
@@ -3613,9 +3628,9 @@
   
   Return a random number.
   
-  The first form returns an integer between 0 and <num>-1, inclusive.
-  The second returns an integer between <min> and <max>, inclusive. Both 
-  numbers must be positive.
+  The first form returns an integer between 0 and <num>-1, inclusive (or
+  between 0 and <num>+1, for negative <num>s).
+  The second returns an integer between <min> and <max>, inclusive.
 
   If called with an invalid argument, rand() returns an error message
   beginning with #-1.
@@ -3693,12 +3708,15 @@
 See also: regrab(), regedit()
 & REMIT()
 & NSREMIT()
-  remit(<object>, <message>)
-  nsremit(<object>, <message>)
+  remit(<object list>, <message>)
+  nsremit(<object list>, <message>)
 
-  Sends a message to the contents of <object>, as per @remit.
+  Sends a message to the contents of all the objects specified in
+  <object list>, as per @remit/list.
 
-  nsremit() works like @nsremit.
+  nsremit() works like @nsremit/list.
+  
+See also: @remit, pemit(), lemit()
 & REMOVE()
   remove(<list>, <words>[, <delimiter>])
 
@@ -3853,7 +3871,7 @@
   fn(<function name>[, <arg0>[, ... , <argN>]])
 
   fn() executes the built-in/hardcoded function <function name>, even if the
-  function has been disabled or overridden with @function. It is primarily 
+  function has been deleted or overridden with @function. It is primarily 
   useful within @functions that override built-ins in order to be able to 
   call the built-in.
   
@@ -3868,6 +3886,9 @@
   from skirting softcoded replacements), use @function/restrict
   fn=userfn.
 
+  To prevent deleted functions from being used with fn(), @function/disable
+  them prior to deleting.
+
 See also: @function, RESTRICT
 & S()
 & S-FUNCTION
@@ -4109,7 +4130,7 @@
     > say sign(0)
     You say, "0"
   
-See also: abs(), bound
+See also: abs(), bound()
 & SIN()
   sin(<angle>[, <angle type>])
  
@@ -4205,6 +4226,9 @@
   &factions or &species attrs. attr is probably case-sensitive, and
   attri is case-insensitive.
 
+  Prefixing the sort type with a minus sign, -, reverses the order of
+  the sort.
+
   Whether or not the 'a' sort type is case-sensitive or not depends on
   the particular mush and its environment.
 
@@ -4679,7 +4703,7 @@
   > think strinsert(Myname, 2, %b)
   My name
 
-See also: strdelete(), insert(), strreplace()
+See also: delete(), insert(), strreplace()
 & STRIPACCENTS()
   stripaccents(<string>)
 
@@ -4739,7 +4763,7 @@
   > think strreplace(Fix teh typo, 4, 3, the)
   Fix the typo
 
-See also: delete(), strinsert(), strdelete(), ldelete(), replace()
+See also: delete(), strinsert(), ldelete(), replace()
 & SUB()
   sub(<number1>, <number2>)
  
@@ -4772,9 +4796,14 @@
   reswitch() and reswitchi() return the <list> which corresponds to the first
   matched <re>, while reswitchall() and reswitchalli() return the <list>s
   corresponding to all matched <re>s. If no <re>s match, all four functions
-  return <default>
-
-See also: switch()
+  return <default>.
+  
+  The string "#$" in the <list>s will be replaced with the value of <str>,
+  /before/ <list> is evaluated. You can also use $N in <list> to refer to the
+  Nth subpattern which matched in <re>, with $0 being the entire matching
+  string. Use $<name> (the '<>' are literal) to refer to named subpatterns.
+  
+See also: switch(), regmatch(), regedit()
 & SWITCH()
 & SWITCHALL()
 & CASE()
@@ -4801,7 +4830,7 @@
   
   See 'help switch2' for examples.
  
-See also: reswitch(), if(), cond()
+See also: reswitch(), if(), cond(), firstof()
 & SWITCH2
   Examples:
     > say switch(test, *a*, foo, *b*, bar, *t*, neat, baz)
@@ -5191,7 +5220,7 @@
     ParentFoo
   
   Continued in 'help pfun2'.
-& pfun2
+& PFUN2
 
   This function does not have the security problems of using 
   
@@ -5208,7 +5237,7 @@
   See 'help pfun3' for an example.
   
 See also: ufun(), get(), parent(), zfun(), PARENTS
-& pfun3
+& PFUN3
 
   Example:
   
Index: game/txt/hlp/pennv184.hlp
===================================================================
--- game/txt/hlp/pennv184.hlp	(.../184p0)	(revision 575)
+++ game/txt/hlp/pennv184.hlp	(.../184p1)	(revision 575)
@@ -1,4 +1,4 @@
-& 1.8.4p0
+& 1.8.4p1
 & changes
 This is a list of changes in this patchlevel which are probably of
 interest to players. More information about new commands and functions
@@ -11,6 +11,99 @@
 A list of the patchlevels associated with each release can
 be read in 'help patchlevels'.
 
+Version 1.8.4 patchlevel 1                                 Sep 05,  2010
+
+Major Changes:
+ * You can now do the equivilent of @command/add, @hook, @function and
+   @attribute/access from alias.cnf and restrict.cnf, to add/configure
+   commands, functions and standard attributes. Suggested by Paige. [MG]
+ * Exits now use @alias for alternate names. The old style of
+   including aliases directly in names is still supported, but
+   depreciated in new construction. Suggested by [MG]. [SW]
+
+Minor Changes:
+ * @power now reports when you try and set a power which is already set (or
+   clear one which isn't set), similar to @set. Suggested by Paige. [MG]
+ * Sorting methods now take - as a prefix to sort type in order to sort
+   in descending order. Suggested by Minion. [GM]
+ * The matching code no longer matches players who aren't nearby with
+   "*playername" when MAT_NEAR is given, more in line with other checks.
+   (This has virtually no impact for most players.) [MG]
+ * The internal pe_info (which manages the function invocation limit, among
+   other things) is now managed per-queue, not per-command argument. [MG]
+ * @chan/decompile now uses "*name" for players, and dbrefs for other
+   objects, when printing "@chan/on" statements. [MG]
+ * cpu_limit now works on Cygwin (though not quite as well as on unix).
+   A slightly higher limit may be needed than other platforms. [MG]
+ * The output from say, pose, semipose and @emit is now passed through the
+   SPEECHMOD attribute before being outputted. Suggested by Paige, based on
+   MUX and TinyMUSH. [MG]
+ * @config/list now accepts wildcard patterns to match against option names.
+   Suggested by Trinsec. [MG]
+ * The dreaded <Output flushed> message should show up a lot less frequently
+   on spammy debug output and the like. By popular demand. [SW]
+ * Added support for MSSP (Mud Server Status Protocol), based on patches by
+   Javelin and Teal. See mush.cnf for details. [MG]
+ * The script for updating config files is smarter about adding new alias
+   lines. [SW]
+ * @search now only charges for elock searches which use eval or indirect
+   locks.
+ * Added @mail/unread, to mark mail you've already read as new, and 
+   @mail/status to change read/cleared/tagged status for messages.. Suggested
+   by qa'toq. [MG]
+
+Commands:
+ * Add /preserve switch to @chzone and @chzoneall, like @chown/preserve.
+ * Rooms/exits must now have an @COST attribute in order to be given
+   pennies. Use @cost <ancestor>=%0 to enable giving to all rooms/exits. [MG]
+ * with/room can now check for commands in the Master Room or your ZMR, and
+   with can check for commands on your ZMT. [MG]
+ * @sitelock/register <host> now sets the access rules for <host> to be
+   "!create register", rather than "!create". Suggested by Trinsec. [MG]
+   
+Functions:
+ * remit() now works like @remit/list. Suggested by Minion. [MG]
+ * rand() now accepts negative arguments again. [MG]
+ * lcon() can now take a second argument to make it behave like lthings()
+   or l[v]players(), or makes it return only puppets/listening objects,
+   for MUX/Rhost compatability. Suggested by Bane. [MG]
+ * open() can now open rooms remotely. Suggested by Minion. [MG]
+ * reswitch() and co now perform $-replacements for subexpressions. [MG]
+
+Fixes:
+ * Help fixes.
+ * @search's output can now include garbage objects, like lsearch().
+   Reported by Minion. [MG]
+ * The command parser incorrectly expanded the names of disabled built-in
+   commands prior to $-command matching. Reported by Mercutio. [MG]
+ * benchmark()'s average would be thrown off when the CPU limit was 
+   exceeded during evaluation. Reported by Amberyl. [MG]
+ * Fix a few bugs in handling of command locks. [SW]
+ * Garbage objects could be matched by dbref. Reported by Paige. [MG]
+ * No longer complain about reboot.db not being present when we're not
+   doing a @shutdown/reboot anyway. Reported by Paige. [MG]
+ * The Telnet escape code was not properly escaped when sent literally to
+   Pueblo-aware clients. [MG]
+ * namelist() did not accept names in quotes. Reported by Amberyl. [MG]
+ * @attrib/access/retroactive could remove the 'root' flag from attribute
+   trees, making nasty things happen. Reported by Cooee. [MG]
+ * Fix fn() to check that the first arugment is actually the name of a
+   built-in function. Reported by Time and Cheetah. [DC]
+ * Nested @asserts/@breaks with no '=' would loop unintentionally.
+   Reported by Minion. [MG]
+ * Fixed a couple of small bugs in give/@cost. [MG]
+ * You can now always look at remote objects whose descs are not set nearby,
+   and can never look at remote objects with nearby descs. [MG]
+ * The chatdb didn't load correctly with invalid objects on channels. [MG]
+ * Fixed a crashbug in @boot on Windows. Reported by Daniel Powell. [MG]
+ * %q-registers did not carry over into @includes correctly. Reported by
+   Reaver. [MG]
+ * Double-free in follow command fixed. Reported by Anya@ST:DW. [MG]
+ * locate() sometimes returned #-2 when two objects matched, even if only
+   one of them was the preferred type. Reported by Minion. [MG]
+
+
+& 1.8.4p0
 Version 1.8.4 patchlevel 0                                 May 09,  2010
 
 Major Changes:
@@ -25,7 +118,7 @@
  * mindb+maxdb classes for lsearch/@search no longer reset to default
    values when > db_top or < 0 is given: Instead treated as an integer
    comparison. [GM]
- * @open can now open exits in remove locations, as well as your current
+ * @open can now open exits in remote locations, as well as your current
    location. Suggested by Bane. [MG]
  * New OPEN_OK flag allows anyone to open exits in a room, and @lock/open
    to restrict who can. Based on patch by ranmir@M*U*S*H. [MG]
Index: game/txt/hlp/penntop.hlp
===================================================================
--- game/txt/hlp/penntop.hlp	(.../184p0)	(revision 575)
+++ game/txt/hlp/penntop.hlp	(.../184p1)	(revision 575)
@@ -2047,20 +2047,22 @@
 This is the AHELP index.
 & RESTRICT
 
- Commands and functions can have their permission levels controlled in
- the mush config files, or by wizards from the game via @command and
- @function.
+ Commands, functions and attributes can have their permission levels
+ controlled in the mush config files, or by wizards from the game via
+ @command, @function and @attribute.
  
  In the config file, the syntax is:
   restrict_command <command-name> <restriction> [" <error message>]
   restrict_function <function-name> <restriction>
+  restrict_attribute <attribute-name> <restriction>
 
  From the game:
   @command/restrict <command-name>=<restriction> [" <error message>]
   @function/restrict <function-name>=<restriction>
+  @attribute/access <attribute-name>=<restriction>
  
-For commands, if <error message> is given, that message is sent to the
-player who runs it instead of a generic, unhelpful error message.
+ For commands, if <error message> is given, that message is sent to the
+ player who runs it instead of a generic, unhelpful error message.
 
   Continued in 'help restrict2'.
 & RESTRICT2
@@ -2068,7 +2070,9 @@
   For commands, <restriction> should be an @lock-style boolexp (though,
   for backwards compatability, the restrictions below can be used, and will
   be converted into an @lock automatically). For functions, <restriction>
-  should be any combination of the phrases below.
+  should be any combination of the phrases below. For attributes, 
+  <restriction> is a list of attribute flags, or "none" to create a standard
+  attribute with no restrictions (see 'help attribute flags').
 
    god        Command or function is usable only by God.
    wizard     Usable only by wizards.
@@ -2116,5 +2120,5 @@
     > @command/restrict @emit=logname
     > @command/restrict @emit=!flag^suspect&!flag^gagged
 
-See also: @command, @function, @lock
+See also: @command, @function, @attribute, @lock
 
Index: game/txt/hlp/penncmd.hlp
===================================================================
--- game/txt/hlp/penncmd.hlp	(.../184p0)	(revision 575)
+++ game/txt/hlp/penncmd.hlp	(.../184p1)	(revision 575)
@@ -32,12 +32,13 @@
 These '@' command set other standard attributes on objects that don't
 follow the pattern above:
 
-  @aahear        @aclone        @aconnect      @adisconnect   @amhear
-  @away          @charges       @cost          @conformat     @descformat
-  @ealias        @exitformat    @filter        @forwardlist   @haven         
-  @idescformat   @idle          @infilter      @inprefix      @lalias        
-  @listen        @nameformat    @oxenter       @oxleave       @oxmove        
-  @oxtport       @prefix        @runout        @sex           @startup       
+  @aahear        @aclone        @aconnect      @adisconnect   @amail
+  @amhear        @away          @charges       @conformat     @cost
+  @descformat    @ealias        @exitformat    @filter        @forwardlist
+  @haven         @idescformat   @idle          @infilter      @inprefix
+  @lalias        @listen        @nameformat    @oxenter       @oxleave
+  @oxmove        @oxtport       @prefix        @runout        @sex
+  @startup       
 
 See also: ATTRIBUTES, NON-STANDARD ATTRIBUTES
 & @-BUILDING
@@ -136,6 +137,14 @@
     > @aconnect me=+who ; +bbscan
 
 See also: @adisconnect, ACTION LISTS
+& @amail
+  @amail <object>=<action list>
+
+  Sets the actions to be taken by <object> whenever it receives @mail. 
+  Admin-only, and is only triggered if enabled via the amail configuration
+  option.
+
+See also: @mail
 & @death
 & @adeath
 & @odeath
@@ -173,10 +182,12 @@
 & @adestroy
   @adestroy <object>[=<action list>]
  
-  The adestroy attribute is triggered when <object> is destroyed. It can
-  only be set by wizards.
+  The adestroy attribute is triggered when <object> is @destroyed. It can
+  only be set by wizards. Because the attribute is triggered when <object>
+  is @destroyed, not when the object is actually purged from the database,
+  it's possible for <object> to be @undestroyed after the adestroy has run.
   
-See also: @destroy, @nuke
+See also: @destroy, @undestroy
 & @adisconnect
   @adisconnect <object>[=<action list>]
 
@@ -338,21 +349,24 @@
   @alias <player>[=<name1>[;<name2>[;...;<nameN>]]]
   @alias <object>[=<string>]
  
-  For players, the ALIAS attribute has special meaning: it contains a list
-  of aliases (separated by semicolons) which can be used instead of his name
-  to refer to the player.
+  For players and exits, the ALIAS attribute has special meaning: it
+  contains a list of aliases (separated by semicolons) which can be
+  used instead of its name to refer to the player or exit.
   
-  The number aliases allowed is controlled by the 'max_aliases' @config
-  option. The same rules which apply to player names also apply to aliases,
-  and you cannot use another player's name as your alias (though you can
-  include your own name in your aliases, and can change your name to one of
-  your aliases).
+  The number of aliases allowed is controlled by the 'max_aliases'
+  @config option. The same rules which apply to player names also
+  apply to aliases, and you cannot use another player's name as your
+  alias (though you can include your own name in your aliases, and can
+  change your name to one of your aliases).
   
-  If the page_aliases @config option is on, the first alias in the list is 
-  shown along with the player's name when they page others.
+  If the page_aliases @config option is on, the first alias in the
+  list is shown along with the player's name when they page others.
   
-  For other types of object, @alias has no special meaning. (Exit aliases
-  are part of the exit's name - see 'help @name' for details.)
+  Exits also support including the aliases directly in their name, but
+  doing so in new construction is depreciated and @alias should be used
+  instead.
+ 
+  For other types of object, @alias has no special meaning.www
 
 See also: @name, alias(), fullalias()
 & @allquota
@@ -505,8 +519,8 @@
   attributes (see "@list/attribs" for a list of them).
   
   *** Unlike TinyMUSH, changes to the PennMUSH attribute table are not saved 
-  *** across shutdowns. Use these commands from God's @startup to ensure
-  *** they are run at each startup.
+  *** across shutdowns. Use these commands from God's @startup to ensure they
+  *** are run at each startup, or use restrict_attribute in restrict.cnf.
 
   The first form of the command displays the full name of the attribute
   <attrib>, along with the its attribute flags, and the dbref of the object 
@@ -698,49 +712,52 @@
 
 See also: @chown
 & @chzone
-  @chzone <object>=<zone> 
+  @chzone[/preserve] <object>=<zone> 
   @chzone <object>=none
 
-  The first form of this command changes the zone of <object> to <zone>. 
-  This puts the object on that zone and may (if the zone_control_zmp_only 
-  @config option is off) allow anyone who passes the Zone @lock of <zone> to
-  control <object>. Any kind of object can be @chzoned, and any kind of 
-  object can be used as a zone.
+  The first form of this command changes the zone of <object> to
+  <zone>.  This puts the object on that zone and may (if the
+  zone_control_zmp_only @config option is off) allow anyone who passes
+  the Zone @lock of <zone> to control <object>. Any kind of object can
+  be @chzoned, and any kind of object can be used as a zone.
 
-  The second form of this command removes <object> from its current zone, 
-  leaving it unzoned. Anyone can reset the zone of an object he owns.
+  The second form of this command removes <object> from its current
+  zone, leaving it unzoned. Anyone can reset the zone of an object he
+  owns.
 
-  If a player is @chzoned, anything objects he creates from that point on 
-  will automatically be on the same zone. Objects the player already owns
-  are not affected. Players can only @chzone themselves to a zone if they
-  own it, though wizards can @chzone players to any zone.
+  If a player is @chzoned, any objects he creates from that point on will
+  automatically be on the same zone. Objects the player already owns are
+  not affected. Players can only @chzone themselves to a zone if they own
+  it, though wizards can @chzone players to any zone.
   
   Continued in 'help @chzone2'.  
 & @chzone2
-  To see the Zone of an object, you can use either 'brief' or 'examine'
-  to examine it. The Zone is listed on the same line as the Owner of
-  the object.
+  To see the Zone of an object, you can use either 'brief' or
+  'examine' to examine it. The Zone is listed on the same line as the
+  Owner of the object.
 
   Players can @chzone objects they own if they own the zone object or
   if they pass its @lock/chzone.  Wizards can @chzone objects to any
   zone.
   
-  If <zone> does not have a Zone @lock when something is @chzoned to it, the
-  lock is automatically set to =<zone> (see 'help @lock' for more info).
+  If <zone> does not have a Zone @lock when something is @chzoned to
+  it, the lock is automatically set to =<zone> (see 'help @lock' for
+  more info).
 
-  Whenever an object besides a player is @chzoned to a zone object, the
-  WIZARD, ROYALTY, and TRUST flags will be reset, as will all @power's
-  (for security purposes). For similar reasons, it is strongly recommended
-  that you do not @chzone admin- or wizard-owned objects to any zone
-  that less privileged players have access to.
+  Whenever an object besides a player is @chzoned to a zone object,
+  the WIZARD, ROYALTY, and TRUST flags will be reset, as will all
+  @power's (for security purposes). For similar reasons, it is
+  strongly recommended that you do not @chzone admin- or wizard-owned
+  objects to any zone that less privileged players have access
+  to. Wizards can use the /preserve switch to prevent this reset.
 
 See also: ZONES, @chzoneall, zone()
 & @chzoneall
-  @chzoneall <player>=<zone object>
+  @chzoneall[/preserve] <player>=<zone object>
 
-  Changes the zone of all objects owned by <player> to <zone object>. 
-  If <zone object> is "none", the zone is reset to NOTHING. Only wizards 
-  may use this command.
+  Changes the zone of all objects owned by <player> to <zone object>.
+  If <zone object> is "none", the zone is reset to NOTHING. Only
+  wizards may use this command.
   
 See also: @chzone, ZONES
 & @clone
@@ -825,7 +842,7 @@
   needs to make allowances for the /noeval switch in it's matching.
 
   Commands added with @command/add, like other standard commands,
-  are never case-sensitive.
+  are never case-sensitive. Commands can also be added in the alias.cnf file.
 
   See 'help @command3' for examples.
 See also: @hook, RESTRICT, EVALUATION ORDER
@@ -1006,16 +1023,16 @@
 See also: look, @exitformat, @conformat, @descformat, @nameaccent, 
     @invformat, @idescformat
 & @cost
-  @cost <thing>[=<amount>]
+  @cost <object>[=<amount>]
   
   The COST attribute contains the number of pennies that must be given to
-  <thing> to trigger its @pay/@opay/@apay attributes. If less than this
+  <object> to trigger its @pay/@opay/@apay attributes. If less than this
   amount is given, the money will be refused, and if more is given, the
   difference is refunded.
   
   This attribute is evaluated, with the amount being given passed as %0.
-  It is only checked for THING-type objects; pennies can always be given
-  to other types of object.
+  Non-players must have this attribute set in order to receive pennies.
+  Players who don't have a COST always accept the amount of pennies given.
 
   Example:
     > @cost Exit Machine=10
@@ -1185,9 +1202,6 @@
 & @destroy
 & @recycle
 & @nuke
-& @undestroy
-& @unrecycle
-
   @destroy[/override] <object>
   @nuke <object>
   @undestroy <object>
@@ -1230,7 +1244,18 @@
   @recycle is an alias for @destroy. Some MUSHes disable @destroy and only
   use @recycle, to avoid players mistyping.
   
-See also: @create, @dig, @open, DESTROY_OK, SAFE
+See also: @undestroy, @create, @dig, @open, DESTROY_OK, SAFE
+& @undestroy
+& @unrecycle
+  @undestroy <object>
+  
+  When an object has been marked for destruction using @destroy, this
+  command spares it from destruction. <object>'s @startup is triggered
+  when it is spared.
+  
+  @unrecycle is an alias for @undestroy.
+  
+See also: @destroy, GOING, @startup
 & @dig
   @dig[/teleport] <room name>[=<exit to>[, <exit from>]]
   
@@ -1409,7 +1434,9 @@
   \<message>
 
   This sends <message> to everyone in your location. Nothing is added to the
-  message, not even your name.
+  message, not even your name. If you have a SPEECHMOD attribute set, it
+  will be evaluated with <message> as %0, and | as %1, and the result will be
+  shown instead of <message> as long as it evaluates to a non-empty string.
 
   If the /room switch is given, this command acts like @lemit instead. The
   /silent switch can be used with it to suppress the confirmation for @lemit.
@@ -1422,7 +1449,7 @@
   @emit can be abbreviated "\"
 
 See also: @nsemit, emit(), @pemit, @remit, @oemit, @lemit, @zemit, @cemit, 
-    NOSPOOF and SPOOFING.
+    @speechmod, NOSPOOF and SPOOFING.
 & @enable
 & @disable
   @enable <option>
@@ -1787,7 +1814,8 @@
   game is restarted. In order to avoid objects which attempt to use
   functions that have not been loaded, a @startup containing @function
   commands should be set on a wizard object with as low a dbref number
-  as possible; God (#1) is suggested for this use.
+  as possible; God (#1) is suggested for this use. You can also create
+  functions from the alias.cnf file.
 
   For example, if you have one object that stores all your global
   functions, you could set the following command (the object is #100
@@ -1952,6 +1980,8 @@
   wrapped in a call of null(). Also, in cases where a command and function
   do the same thing (e.g., @pemit and pemit()), only the command gets
   the hooks.
+  
+  Hooks can also be set in the alias.cnf file.
 
   Leaving out the object and attribute clears an existing hook. Wizards can
   see existing hooks with @command or @hook/list.
@@ -2497,7 +2527,30 @@
   the NsPemit power, then SPOOF will make the message appear to be
   from the enactor.
 
+  See 'help @message2' for an example.
 See also: message(), @chatformat, @pageformat
+& @message2
+
+  Example:
+    > &sayformat *Mike=%n sez, '%0'
+    > &sayformat *Walker=From %n: %0
+    > &cmd.fsay me=$fsay *: @message/spoof *Mike *Walker *Javelin=
+             %n says\, "%0", SAYFORMAT, %0
+    > fsay This is a test
+    
+  Mike sees:
+    Player sez, 'This is a test'
+  Walker sees:
+    From Player: This is a test
+  Javelin sees:
+    Player says, "This is a test"
+
+  A rough implementation of @chatformat:
+    > &cmd.chat Globals=$^@chat (.+?)=([\:;]?)(.+?)$: @message/spoof
+         cwho(%1)=setr(0,<%1> [speak(&[squish(ctitle(%1, %#) %n)], %2%3)]),
+         CHATFORMAT, firstof(%2, "), %1, %3, %n, ctitle(%1, %#), %q0
+    > @set Globals/cmd.chat=regexp
+
 & @motd
   @motd[/<switch>] [<message>]
  
@@ -2516,7 +2569,6 @@
   /list   : list the MOTDs (like @listmotd, can be used by anyone)
 & @name
   @name <object>=<new name>
-  @name <exit>=<new name>[;<alias1>[;<alias2>[;...;<aliasN>]]]
 
   Changes the name of <object> to <new name>.
 
@@ -2528,10 +2580,17 @@
   use by another player, as a name or alias. (They can change their name to
   something from their own @alias.)
 
-  An exit can have many names/aliases, each separated by a semicolon. The
-  exit can be referred to by any of these names in all commands. For example:
-    > @name exit=East <e>;east;e
+  An exit can have many names, each separated by a semicolon. In new
+  construction, the aliases should be in the @alias attribute, but
+  they are also supported in the name itself. The exit can be referred
+  to by any of these names in all commands. For example:
 
+    (New-style)
+    > @name exit=East <e>
+    > @alias exit=east;e
+    (Old-style)
+    > @name exit=East <e>;east;e
+  
 See also: @alias, @oname, name(), fullname()
 & @ONAME
 & @ANAME
@@ -2684,7 +2743,7 @@
 
   See 'help @pageformat2' for examples.
 
-See also: page, speak(), @chatformat, @message
+See also: page, speak(), @chatformat, @speechmod, @message
 & @pageformat2
 & @outpageformat2
   For simple page timestamps:
@@ -3095,9 +3154,12 @@
   type given is used in the search.
 
   @search is only mildly computationally expensive for most of the search
-  classes.  computationally expensive searches are the evaluating searches
-  (EVAL, EPLAYER, ETHING, EROOM, EEXIT) or the attribute pattern
-  searches (COMMAND, LISTEN)
+  classes.  Computationally expensive searches are the evaluating searches
+  (EVAL, EPLAYER, ETHING, EROOM, EEXIT), the attribute pattern
+  searches (COMMAND, LISTEN), and ELOCK searches which perform evaluation
+  searches (attr/value) or indirect locks (@obj/lock). These searches all
+  cost a number of pennies (the exact amount is configurable; see 
+  @config find_cost).
   
   See "help @search5" for some examples.
 & @search5
@@ -3192,7 +3254,7 @@
 & @sitelock
   @sitelock
   @sitelock/name <name>
-  @sitelock <host-pattern> = <options>[,<name>]
+  @sitelock <host-pattern>=<options>[, <name>]
   @sitelock[/<ban|register>] <host-pattern>
   @sitelock/check <host>
   @sitelock/remove <string>
@@ -3209,14 +3271,14 @@
   @sitelock/name adds a name to the list of banned player names.
   Use !<name> to remove a name from the list.
 
-  @sitelock <host-pattern> = <options>[,<name>] controls the access options
+  @sitelock <host-pattern>=<options>[, <name>] controls the access options
   for hosts which match <host-pattern>, which may include wildcard
   characters "*" and "?". See help @sitelock2 for the list of options,
   and help @sitelock3 for an explanation about the name argument.
 
   For backward compatibility, @sitelock/ban is shorthand for
   setting options "!connect !create !guest", and @sitelock/register
-  is shorthand for options "!create".
+  is shorthand for options "!create register".
 
 & @sitelock2
 
@@ -3245,24 +3307,51 @@
    regexp      -- Treat the hostname pattern as a regular expression
                   instead of a wildcard pattern.
 & @sitelock3
- If you specify a character name after the options, the options
- are only checked if the host pattern matches, AND the character
- being checked for connect support matches the one you gave.
- Use it only with connect and !connect options, since they're
- the only ones where an existing character is used.
+  If you specify a character name after the options, the options
+  are only checked if the host pattern matches, AND the character
+  being checked for connect support matches the one you gave.
+  Use it only with connect and !connect options, since they're
+  the only ones where an existing character is used.
 
- For example, to disallow anyone from connecting to 'Twink' from
- one domain, but to allow connections to the character from others,
- use something like:
+  For example, to disallow anyone from connecting to 'Twink' from
+  one domain, but to allow connections to the character from others,
+  use something like:
 
- @sitelock *.somesite.com=!connect,Twink
+    > @sitelock *.somesite.com=!connect,Twink
 
- If you want to disallow connections to a character from anywhere,
- use @newpassword or @sitelock *=!connect,Twink.
+  If you want to disallow connections to a character from anywhere,
+  use @newpassword or @sitelock *=!connect,Twink.
 
   @sitelock/remove will delete entries that were added with @sitelock
   if their host-pattern matches <string> exactly.
- 
+
+& @SPEECHMOD
+  @speechmod <object>[=<modifier>]
+  
+  When set, this attribute modifies everything <object> says, poses,
+  semiposes and @emits. The original text spoken/posed/emitted is passed as
+  %0, with %1 passed as " (for say), : (for pose), ; (for semipose) or |
+  (for @emit).
+  
+  If the attribute evaluates to an empty string, the original text will be
+  used. Otherwise, the result of the attribute is used.
+  
+  Example:
+    > @speechmod me=ucstr(%0)!
+    > say hello
+    You say, "HELLO!"
+    > pose waves
+    Bob WAVES!
+    
+    > @speechmod me=switch(%1,",ucstr(%0),:,lcstr(%0))
+    > say Test
+    You say, "TEST"
+    > pose Test
+    Bob test
+    > @emit Test
+    Test
+    
+See also: say, pose, @emit, @chatformat, @pageformat
 & @sql
   @sql <query>
 
@@ -3292,9 +3381,13 @@
 
   Sets the list of actions on <object> that will happen whenever the MUSH
   is restarted. This lets you start up objects that need to be running 
-  continuously. It is also useful for use with @function. 
+  continuously. It is also useful for setting up @functions, @hooks and
+  standard @attributes, which are not saved across restarts.
   
-See also: @function, ACTION LISTS
+  @startup is also triggered when an object is @restarted or @undestroyed.
+  
+See also: @restart, @undestroy, ACTION LISTS, @function, @command, @hook,
+  @attribute
 & @stats
   @stats [<player>]
   @stats/table
@@ -4002,35 +4095,37 @@
   first one you can afford will be the resulting price.
 
   ex:
-  > &PRICELIST vendor=coke:20 pepsi:20
-  > &drink.coke vendor=You enjoy a delicious coke.
-  > &drink.pepsi vendor=It tastes like a funny coke.
-  > @BUY vendor=u(drink.%0)
+  > @PRICELIST vendor=coke:20 pepsi:20
+  > &drink`coke vendor=You enjoy a delicious coke.
+  > &drink`pepsi vendor=It tastes like a funny coke.
+  > @BUY vendor=u(drink`%0)
   > buy coke
   You enjoy a delicious coke.
 
-See also: @ABUY, @BUY, @PRICELIST, give
+See also: @ABUY, @BUY, @PRICELIST, give, @COST
 & give
-  give[/silent] <player>=<number>
-  give[/silent] <number> to <player>
-  give <player>=<object>
-  give <object> to <player>
-
-  Gives player the specified <number> of pennies or <object>. You
-  can't give someone pennies if their new total would be greater than
-  100000 pennies.  (No reason to get greedy).  The /silent switch
-  suppresses the default message indicating how many pennies were
-  given. Wizards may "give" a negative number of pennies.
+  give[/silent] <recipient>=<number>
+  give[/silent] <number> to <recipient>
+  give <recipient>=<object>
+  give <object> to <recipient>
 
-  You may also give players objects, but the other player must be set
-  ENTER_OK in order to receive something you give. You must pass <object>'s
-  @lock/give and <player>'s @lock/from. <object> must pass <player>'s
-  @lock/receive.
+  The first two forms of this command give <number> pennies to <recipient>.
+  If <recipient> is a non-player, it must have an @COST, and any pennies
+  given to it will go to its owner. If /silent is given, the message 
+  informing the recipient how many pennies were given is suppressed. Wizards
+  may "give" a negative number of pennies to take from <recipient>. When you
+  give pennies, <recipient>'s PAYMENT/OPAYMENT/APAYMENT attributes are
+  triggered.
   
-  Giving money to a non-player gives it to the object's owner instead. When
-  giving to a THING, the amount given must match its @COST attribute.
+  The last two forms of this command give an <object> from your inventory to
+  <recipient>. The recipient must be set ENTER_OK, and you must pass his
+  @lock/from. You must also pass <object>'s @lock/give, and <object> must
+  pass <recipient>'s @lock/receive. When you give an object successfully,
+  your GIVE/OGIVE/AGIVE attributes, <recipient>'s RECEIVE/ORECEIVE/ARECEIVE
+  attributes, and <object>'s SUCCESS/ASUCCESS/OSUCCESS attributes are all
+  triggered.
 
-See also: @pay, @cost, @lock, inventory, @receive, @give, buy
+See also: @pay, @cost, @lock, inventory, @receive, @give, buy, @success
 & go
 & goto
 & move
@@ -4061,6 +4156,8 @@
   such as its version number, time of last restart, number of players
   currently connected, and size of database. It can be issued from the
   connect screen.
+  
+See also: MSSP-REQUEST
 & inventory
   inventory
 
@@ -4205,47 +4302,49 @@
 & ;
 & pose
 & semipose
-  pose[/noeval] <action pose>
+  pose[/noeval] <action>
   :<action pose>
 
-  pose[/nospace] <action pose>
-  semipose[/noeval] <action pose>
+  pose[/nospace] <action>
+  semipose[/noeval] <action>
   ;<action pose>
  
-  Displays your name followed by the statement you posed.  May be
-  abbreviated by the ':' symbol. Normally, a space is placed between
-  your name and the action you are posing. If you do not wish to have
-  a space inserted, use the /nospace switch, the 'semipose' command,
-  or the ';' symbol and don't add a space between the ; and the
-  <action pose>.  The /noeval switch prevents the pose from being
-  evaluated by the parser.
+  The pose and semipose commands allow you to perform actions. Pose shows
+  your name, a space, and then <action>; semipose omits the space. They can 
+  be abbreviated to ':' and ';' respectively. The /noeval switch stops 
+  <action> from being evaluated.
+  
+  If you have a SPEECHMOD attribute set, it will be evaluated with <action>
+  as %0 and either : (for pose) or ; (for semipose) as %1. The result is
+  used instead of <action>, as long as it returns a non-empty string.
 
-(continued in help pose2)
+  See 'help pose2' for examples.
+See also: say, @emit, @speechmod
 & pose2
  
   Examples:
-    If you are player Bob, and you type in ':laughs out loud.' or
-    'pose laughs out loud.' everybody in the room will see:
-    "Bob laughs out loud." 
-  
-    If you are player Bob, and you type in ';'s smiling today.' or
-    'pose/nospace 's smiling today.' everybody in the room will see:
-    "Bob's smiling today."
+    > pose waves.
+    Bob waves.
+    
+    > :laughs out loud.
+    Bob laughs out loud.
+    > ;'s laughing on the inside.
+    Bob's laughing on the inside.
 & "
 & say
   say <message>
   say/noeval <message>
   "<message>
 
-  Says <message> out loud. The message will be enclosed in
-  double-quotes.  A single double-quote is the abbreviation for this
-  common command.
-
-  Say takes one switch, /noeval. The /noeval switch prevents any
-  evaluation of the message, and is handy when you want to say things
-  that use special characters like % or []'s.
+  Says <message> out loud. The message will be enclosed in double-quotes.
+  A single double-quote is the abbreviation for this common command.
+  If the /noeval switch is given, <message> will not be evaluated.
+  
+  If you have a SPEECHMOD attribute set, it will be evaluated with <message>
+  passed as %0 and " (a double-quote) passed as %1. The result is shown 
+  instead of <message>, as long as it evaluates to a non-empty string.
 
-See also: pose, whisper
+See also: pose, whisper, @speechmod, @emit, page
 & score
   score
   
@@ -4379,11 +4478,14 @@
 & with
   with[/room] <obj>=<command>
 
-  Attempts to run a user-defined command on a specific object.  If the
-  /room switch is given, <obj> must be a room, and its contents are
-  checked for commands as if it was a master room.
+  Attempts to run a user-defined command on a specific object.  If the /room
+  switch is given, <obj> must be a room or your current location, and its 
+  contents are checked for commands as if it was a master room.
+  
+  <obj> must be an object near you, an object you control, your ZMO or (if
+  the /room switch is given) the Master Room.
 
-  See 'help USER-DEFINED COMMANDS'.
+  See also: USER-DEFINED COMMANDS, EVALUATION ORDER
 & socket commands
   These commands can only be entered by a connected player through
   their client. They generally do things that only affect a specific
@@ -4392,11 +4494,23 @@
   
   IDLE    INFO    LOGOUT  OUTPUTPREFIX    OUTPUTSUFFIX
   PROMPT_NEWLINES QUIT    SCREENWIDTH     SCREENHEIGHT
+  MSSP-REQUEST
 
   In addition, the following commands can only be used at the login
   screen:
 
-  cd ch connect create register
+  cd ch cv connect create register
   
   The WHO command can also be used at the login screen. Please note that
   this is different to the in-game WHO command.
+& MSSP-REQUEST
+
+  MSSP-REQUEST
+  
+  This socket command shows some basic information about the MUSH, along with
+  any admin-defined information specified in mush.cnf with the 'mssp' option.
+  The info is also shown via the MSSP telnet option. Useful for MUD crawlers
+  and bots. For more information about the MUD Server Status Protocol (MSSP),
+  see http://tintin.sourceforge.net/mssp/
+  
+See also: INFO
Index: game/txt/hlp/pennvOLD.hlp
===================================================================
--- game/txt/hlp/pennvOLD.hlp	(.../184p0)	(revision 575)
+++ game/txt/hlp/pennvOLD.hlp	(.../184p1)	(revision 575)
@@ -4417,7 +4417,7 @@
 For information on a specific patchlevel of one of the versions listed,
 type 'help <version>p<patchlevel>'. For example, 'help 1.7.2p3'
 
-1.8.4: 0
+1.8.4: 0, 1
 1.8.3: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13
 1.8.2: 0, 1, 2, 3, 4, 5, 6, 7, 8
 1.8.1: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10
Index: game/txt/README
===================================================================
--- game/txt/README	(.../184p0)	(revision 575)
+++ game/txt/README	(.../184p1)	(revision 575)
@@ -1,26 +1,32 @@
-Your local help/news/events/etc files can now be kept separate
-from those distributed with PennMUSH, and can now be managed as
-a set of files rather than a single large file.
+Your local help/news/events/etc files can now be kept separate from
+those distributed with PennMUSH, and can now be managed as a set of
+files rather than a single large file.
 
 Here's the details:
 
-1. The source files for help.txt, news.txt, and events.txt are
-   kept in directories called hlp, nws, and evt respectively.
+1. The source files for help.txt, news.txt, and events.txt are kept in
+   directories called hlp, nws, and evt respectively.
 
 2. Files in those directories which end in .<directoryname> are
-   considered to be part of the text. That is, files in hlp/
-   which end in .hlp, and files in nws/ which end in .nws
-   will be merged into the final help.txt, news.txt, or whatever.
+   considered to be part of the text. That is, files in hlp/ which end
+   in .hlp, and files in nws/ which end in .nws will be merged into
+   the final help.txt, news.txt, or whatever.
 
-3. When the MUSH is restarted, a 'make' is run in this directory.
-   For if a file in hlp/ is newer than help.txt, it calls
-   compose.sh to rebuild help.txt. If you've got perl on your system,
-   compose.sh will also call index-files.pl to make a 'help index'
-   entry which lists all your help entries.
+3. When the MUSH is restarted, a 'make' is run in this directory.  For
+   if a file in hlp/ is newer than help.txt, it calls compose.sh to
+   rebuild help.txt. Don't edit help.txt, news.txt, etc. directly; if
+   you do, any changes will be lost. 
+ 
+   If you've got perl on your system, compose.sh will also call
+   index-files.pl to make a 'help index' entry which lists all your
+   help entries. The file hlp/index.hlp contains this index, and is
+   overwritten each time the index is built. Don't use it for your own
+   content!
 
 So, if you want to add your own news entries, make a file called
 nws/local.nws and put 'em there. Or maybe organize it into parts:
-nws/theme.nws, nws/code.nws, etc.
+nws/theme.nws, nws/code.nws, etc. Don't edit news.txt, help.txt, etc.
+directly or those changes will be lost.
 
 Files distributed with PennMUSH always begin with "penn", so don't
 start your files with that.
@@ -31,6 +37,12 @@
     a) create a directory here called "rules"
     b) put your rules files there, each ending in .rules
     c) edit game/txt/Makefile and add rules.txt to the TXT line
-For index files, do exactly the same process, but replace all references
-to 'rules' above with 'index'.
+
+For index files, do exactly the same process, but replace all
+references to 'rules' above with 'index'. You can use your own names
+as well, by adding to the Makefile using the template for existing
+directories, and adding the target .txt file to the TXT line. Files in
+a directory have to have the same extension as the directory name
+(hlp/foo.hlp, etc.). The special file 'index.<extension>' will be
+overwritten. Don't use it for your own content.
 
Index: game/restart
===================================================================
--- game/restart	(.../184p0)	(revision 575)
+++ game/restart	(.../184p1)	(revision 575)
@@ -1,10 +1,17 @@
 #!/bin/sh
 #
 # usage: restart
-#
-# REQUIRED (but only if the autodetect doesn't work): you must set this to the
-# path to your game directory, e.g. /home/mush/game
-GAMEDIR=`cd $(dirname $0); pwd`
+
+# Try to autodetect the game directory. First, follow any symlinks the script
+# may have been run through.
+SCRIPTPATH=$0
+while [ -h "$SCRIPTPATH" ]; do
+  SCRIPTPATH=`readlink "$SCRIPTPATH"`
+done
+
+# REQUIRED if the autodetect fails: set GAMEDIR to point to your game directory,
+# e.g. /home/mush/game.
+GAMEDIR=`cd $(dirname "$SCRIPTPATH"); pwd`
 
 # OPTIONAL things that you may want to tweak.
 
Index: game/aliascnf.dst
===================================================================
--- game/aliascnf.dst	(.../184p0)	(revision 575)
+++ game/aliascnf.dst	(.../184p1)	(revision 575)
@@ -19,6 +19,26 @@
 # We add a dummy here to make updating easier
 reserve_alias dummy_exit_alias
 
+# You can also add new commands, with
+# command_add <command> [<options>], where <options> is a space-separated
+# list of 0 or more of "noparse", "eqsplit", "lsargs" and "rsargs".
+# Equiv of @command/add[/<options>] <command>. See 'help @command'.
+# add_command @foo eqsplit rsargs
+
+# And hook commands, with
+# hook_command <cmd> <hook> [<obj>[/<attr>]]
+# as per @hook/<hook> <cmd>=[<obj>[/<attr>]]. See 'help @hook'.
+# Don't include the '#' in <obj>, just use the number.
+# hook_command say override 123/cmd.say
+
+# You can also add new functions, with
+# add_function <function> <obj>/<attr> [<minargs> [<maxargs>]]
+# as per @function <function>=<obj>, <attr>[, <minargs>[, <maxargs>]]
+# Don't include the '#' in <obj>, just use the number. See 'help @function'
+# If <function> is the name of a built-in function, it will be disabled
+# and replaced with the user function (like @function/delete).
+# add_function foo 123/fun.foo 1 5
+
 # You can also alias commands to other names.
 # command_alias EXISTING_COMMAND ALIAS
 # For example, a french-language game do the following:
Index: game/mushcnf.dst
===================================================================
--- game/mushcnf.dst	(.../184p0)	(revision 575)
+++ game/mushcnf.dst	(.../184p1)	(revision 575)
@@ -843,6 +843,17 @@
 # channel_flags player quiet open hide_ok
 channel_flags player
 
+
+# PennMUSH supports MSSP (Mud Server Status Protocol) which tells connecting
+# clients/bots some basic information about your game theme, setup, etc.
+# See http://tintin.sourceforge.net/mssp/ for the list of fields the protocol
+# currently supports. Penn automatically handles name, players, uptime, port,
+# codebase, family, pueblo, ssl, website - all others are up to you.
+# Example:
+# mssp contact/you@yourgame.com
+# mssp hiring coders/1
+mssp ansi/1
+
 ###
 ### Reserved command names, and command and function aliases are in
 ### alias.cnf
Index: game/access.README
===================================================================
--- game/access.README	(.../184p0)	(revision 575)
+++ game/access.README	(.../184p1)	(revision 575)
@@ -132,7 +132,7 @@
 *.twink.edu -2 !create register
 
 Using !create prevents people from using the usual create command.
-Adding register allows them to uset the register command.
+Adding register allows them to use the register command.
 
 
 6. Disable creation from twink.edu sites, and don't let Wizards 
Index: po/sv_SE.pox
===================================================================
--- po/sv_SE.pox	(.../184p0)	(revision 575)
+++ po/sv_SE.pox	(.../184p1)	(revision 575)
@@ -64,10 +64,6 @@
 msgid " convtime() is stricter."
 msgstr " convtime() r striktare."
 
-#: flags.c:1531
-msgid " granted."
-msgstr " beviljas."
-
 #: src/look.c:688 src/look.c:770
 msgid " is owned by "
 msgstr " gs av "
Index: po/pennmush.pot
===================================================================
--- po/pennmush.pot	(.../184p0)	(revision 575)
+++ po/pennmush.pot	(.../184p1)	(revision 575)
@@ -8,7 +8,7 @@
 msgstr ""
 "Project-Id-Version: PACKAGE VERSION\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2010-04-13 02:00-0500\n"
+"POT-Creation-Date: 2010-08-29 02:00-0500\n"
 "PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
 "Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
 "Language-Team: LANGUAGE <LL@li.org>\n"
@@ -16,336 +16,341 @@
 "Content-Type: text/plain; charset=CHARSET\n"
 "Content-Transfer-Encoding: 8bit\n"
 
-#: access.c:467
+#: access.c:453
 #, c-format
 msgid "Matched line %d: %s %s"
 msgstr ""
 
-#: access.c:470
+#: access.c:456
 #, c-format
 msgid "Comment: %s"
 msgstr ""
 
-#: access.c:472
+#: access.c:458
 msgid "Connections allowed by: "
 msgstr ""
 
-#: access.c:474
+#: access.c:460
 msgid "No one"
 msgstr ""
 
-#: access.c:476
+#: access.c:462
 msgid "All but admin"
 msgstr ""
 
-#: access.c:478
+#: access.c:464
 msgid "All but wizards"
 msgstr ""
 
-#: access.c:480
+#: access.c:466
 msgid "All but God"
 msgstr ""
 
-#: access.c:482
+#: access.c:468
 msgid "All"
 msgstr ""
 
-#: access.c:485
+#: access.c:471
 msgid "Guest connections are NOT allowed"
 msgstr ""
 
-#: access.c:487
+#: access.c:473
 msgid "Guest connections are allowed"
 msgstr ""
 
-#: access.c:490
+#: access.c:476
 msgid "Creation is NOT allowed"
 msgstr ""
 
-#: access.c:492
+#: access.c:478
 msgid "Creation is allowed"
 msgstr ""
 
-#: access.c:495
+#: access.c:481
 msgid "Email registration is allowed"
 msgstr ""
 
-#: access.c:497
+#: access.c:483
 msgid "Players connecting are set SUSPECT"
 msgstr ""
 
-#: access.c:499
+#: access.c:485
 msgid "Denied connections are not logged"
 msgstr ""
 
-#: access.c:501
+#: access.c:487
 msgid "No matching access rule"
 msgstr ""
 
-#: access.c:533
+#: access.c:519
 #, c-format
 msgid "Unable to add sitelock entry: %s"
 msgstr ""
 
-#: access.c:540 access.c:553
+#: access.c:526 access.c:539
 #, c-format
 msgid "Unable to add @sitelock separator: %s"
 msgstr ""
 
-#: access.c:663
+#: access.c:649
 #, c-format
 msgid "%3d SITE: %-20s  DBREF: %-6s FLAGS:%s"
 msgstr ""
 
-#: access.c:665
+#: access.c:651
 #, c-format
 msgid " COMMENT: %s"
 msgstr ""
 
-#: access.c:669
+#: access.c:655
 msgid "---- @sitelock will add sites immediately below this line ----"
 msgstr ""
 
-#: access.c:674
+#: access.c:660
 msgid "There are no access rules."
 msgstr ""
 
-#: access.c:746
+#: access.c:732
 #, c-format
 msgid "Unknown access option: %s"
 msgstr ""
 
-#: atr_tab.c:183 atr_tab.c:257 atr_tab.c:335
+#: atr_tab.c:216 atr_tab.c:293 atr_tab.c:371
 msgid "Which attribute do you mean?"
 msgstr ""
 
-#: atr_tab.c:189 flags.c:2063 flags.c:2073 flags.c:2233 flags.c:2244
+#: atr_tab.c:222 flags.c:2089 flags.c:2099 flags.c:2259 flags.c:2270
 msgid "I don't understand those permissions."
 msgstr ""
 
-#: atr_tab.c:199
+#: atr_tab.c:232
 msgid "That attribute's permissions can not be changed."
 msgstr ""
 
-#: atr_tab.c:205 atr_tab.c:294
+#: atr_tab.c:238 atr_tab.c:330
 msgid "Invalid attribute name."
 msgstr ""
 
-#: atr_tab.c:211
+#: atr_tab.c:244
 msgid "Critical memory failure - Alert God!"
 msgstr ""
 
-#: atr_tab.c:239
+#: atr_tab.c:275
 #, c-format
 msgid "%s -- Attribute permissions now: %s"
 msgstr ""
 
-#: atr_tab.c:264 atr_tab.c:308 atr_tab.c:346
+#: atr_tab.c:300 atr_tab.c:344 atr_tab.c:382
 msgid "That attribute isn't in the attribute table"
 msgstr ""
 
-#: atr_tab.c:270
+#: atr_tab.c:306
 #, c-format
 msgid "Removed %s from attribute table."
 msgstr ""
 
-#: atr_tab.c:287
+#: atr_tab.c:323
 msgid "Which attributes do you mean?"
 msgstr ""
 
-#: atr_tab.c:301
+#: atr_tab.c:337
 #, c-format
 msgid "The name %s is already used in the attribute table."
 msgstr ""
 
-#: atr_tab.c:319
+#: atr_tab.c:355
 #, c-format
 msgid "Renamed %s to %s in attribute table."
 msgstr ""
 
-#: atr_tab.c:349
+#: atr_tab.c:385
 msgid "Attribute"
 msgstr ""
 
-#: atr_tab.c:351 cmds.c:382 cmds.c:551 game.c:2336
+#: atr_tab.c:387 cmds.c:386 cmds.c:555 game.c:2372
 msgid "Flags"
 msgstr ""
 
-#: atr_tab.c:353
+#: atr_tab.c:389
 msgid "Creator"
 msgstr ""
 
-#: atr_tab.c:368
+#: atr_tab.c:404
 #, c-format
 msgid "Attribs: %s"
 msgstr ""
 
-#: attrib.c:1786 look.c:802 look.c:1563
+#: attrib.c:1791 look.c:822 look.c:1580
 msgid "Garbage is garbage."
 msgstr ""
 
-#: attrib.c:1800 attrib.c:1807 attrib.c:1825
+#: attrib.c:1806 attrib.c:1813 attrib.c:1831
 #, c-format
 msgid "'%s' is not a valid alias."
 msgstr ""
 
-#: attrib.c:1810 attrib.c:1828
+#: attrib.c:1816 attrib.c:1834
 #, c-format
 msgid "'%s' contains too many aliases."
 msgstr ""
 
-#: attrib.c:1813 attrib.c:1831
+#: attrib.c:1819 attrib.c:1837
 msgid "Null aliases are not valid."
 msgstr ""
 
-#: attrib.c:1850
+#: attrib.c:1851
+#, c-format
+msgid "'%s' is not a valid exit name."
+msgstr ""
+
+#: attrib.c:1868
 #, c-format
 msgid "%s should contain only dbrefs."
 msgstr ""
 
-#: attrib.c:1855
+#: attrib.c:1873
 #, c-format
 msgid "Invalid dbref #%d in %s."
 msgstr ""
 
-#: attrib.c:1860
+#: attrib.c:1878
 #, c-format
 msgid "I don't think #%d wants to hear from %s."
 msgstr ""
 
-#: attrib.c:1865
+#: attrib.c:1883
 #, c-format
 msgid "I don't think #%d wants %s's mail."
 msgstr ""
 
-#: attrib.c:1879 set.c:1144
+#: attrib.c:1897 set.c:1149
 #, c-format
 msgid "Attribute %s is SAFE. Set it !SAFE to modify it."
 msgstr ""
 
-#: attrib.c:1886
+#: attrib.c:1904
 #, c-format
 msgid "Unable to remove '%s' because of a protected tree attribute."
 msgstr ""
 
-#: attrib.c:1892
+#: attrib.c:1910
 #, c-format
 msgid ""
 "Unable to set '%s' because of a failure to create a needed parent attribute."
 msgstr ""
 
-#: attrib.c:1897
+#: attrib.c:1915
 msgid "That's not a very good name for an attribute."
 msgstr ""
 
-#: attrib.c:1902
+#: attrib.c:1920
 #, c-format
 msgid "You must set %s first."
 msgstr ""
 
-#: attrib.c:1905
+#: attrib.c:1923
 #, c-format
 msgid "%s is a branch attribute; remove its children first."
 msgstr ""
 
-#: attrib.c:1908
+#: attrib.c:1926
 msgid "That attribute cannot be changed by you."
 msgstr ""
 
-#: attrib.c:1911
+#: attrib.c:1929
 msgid "Too many attributes on that object to add another."
 msgstr ""
 
-#: attrib.c:1914
+#: attrib.c:1932
 msgid "No such attribute to reset."
 msgstr ""
 
-#: attrib.c:1923 command.c:1865
+#: attrib.c:1941 command.c:1898
 msgid "Alias set."
 msgstr ""
 
-#: attrib.c:1925
+#: attrib.c:1943
 msgid "Alias removed."
 msgstr ""
 
-#: attrib.c:1938
+#: attrib.c:1956
 #, c-format
 msgid "%s loses its ears and becomes deaf."
 msgstr ""
 
-#: attrib.c:1942
+#: attrib.c:1960
 #, c-format
 msgid "%s grows ears and can now hear."
 msgstr ""
 
-#: attrib.c:1950
+#: attrib.c:1968
 msgid "Set"
 msgstr ""
 
-#: attrib.c:1950
+#: attrib.c:1968
 msgid "Cleared"
 msgstr ""
 
-#: attrib.c:1980 attrib.c:1987 attrib.c:2053 attrib.c:2060
+#: attrib.c:1998 attrib.c:2005 attrib.c:2071 attrib.c:2078
 msgid "You need to give an object/attribute pair."
 msgstr ""
 
-#: attrib.c:1998 attrib.c:2071 bsd.c:2856 bsd.c:2902 bsd.c:4108 bsd.c:4642
-#: bsd.c:4675 bsd.c:4687 bsd.c:4692 cmds.c:78 cmds.c:83 cmds.c:88
-#: command.c:1676 command.c:1703 command.c:1786 command.c:1868 command.c:2029
-#: cque.c:943 cque.c:1045 cque.c:1096 cque.c:1549 cque.c:1607 cque.c:1724
-#: create.c:100 create.c:119 create.c:235 create.c:300 create.c:309
-#: create.c:313 create.c:364 create.c:368 create.c:386 create.c:622
-#: destroy.c:234 destroy.c:893 extchat.c:1780 extchat.c:1797 extchat.c:1828
-#: extchat.c:3882 flags.c:1536 flags.c:1541 flags.c:1694 function.c:1036
-#: function.c:1291 function.c:1426 function.c:1571 function.c:1617
-#: function.c:1664 funmisc.c:826 game.c:951 game.c:1497 lock.c:715 lock.c:779
-#: lock.c:975 look.c:1323 look.c:1612 malias.c:763 malias.c:868 match.c:477
-#: move.c:535 move.c:864 move.c:879 predicat.c:1230 predicat.c:1425 rob.c:428
-#: set.c:193 set.c:969 set.c:1051 set.c:1087 set.c:1100 set.c:1185
-#: speech.c:1480 warnings.c:294 warnings.c:515 wiz.c:442 wiz.c:565 wiz.c:576
-#: wiz.c:850 wiz.c:1013 wiz.c:1043
+#: attrib.c:2016 attrib.c:2089 bsd.c:2890 bsd.c:2936 bsd.c:4217 bsd.c:4751
+#: bsd.c:4784 bsd.c:4796 bsd.c:4801 cmds.c:78 cmds.c:83 cmds.c:88
+#: command.c:1700 command.c:1727 command.c:1819 command.c:1901 command.c:2063
+#: cque.c:954 cque.c:1056 cque.c:1107 cque.c:1560 cque.c:1618 cque.c:1735
+#: create.c:100 create.c:119 create.c:237 create.c:302 create.c:311
+#: create.c:315 create.c:367 create.c:371 create.c:389 create.c:625
+#: destroy.c:234 destroy.c:893 extchat.c:1776 extchat.c:1793 extchat.c:1824
+#: extchat.c:3882 flags.c:1543 flags.c:1548 flags.c:1707 function.c:1036
+#: function.c:1290 function.c:1514 function.c:1659 function.c:1705
+#: function.c:1752 funmisc.c:883 game.c:961 game.c:1533 lock.c:714 lock.c:778
+#: lock.c:974 look.c:1340 look.c:1629 malias.c:764 malias.c:869 match.c:478
+#: move.c:539 move.c:868 move.c:883 predicat.c:1231 predicat.c:1426 rob.c:428
+#: set.c:193 set.c:972 set.c:1055 set.c:1092 set.c:1105 set.c:1190
+#: speech.c:1516 warnings.c:294 warnings.c:515 wiz.c:444 wiz.c:567 wiz.c:578
+#: wiz.c:852 wiz.c:1017 wiz.c:1047
 msgid "Permission denied."
 msgstr ""
 
-#: attrib.c:2006
+#: attrib.c:2024
 #, c-format
 msgid "That attribute is %slocked."
 msgstr ""
 
-#: attrib.c:2012
+#: attrib.c:2030
 msgid "You need to be able to set the attribute to change its lock."
 msgstr ""
 
-#: attrib.c:2019
+#: attrib.c:2037
 msgid "Attribute locked."
 msgstr ""
 
-#: attrib.c:2024
+#: attrib.c:2042
 msgid "Attribute unlocked."
 msgstr ""
 
-#: attrib.c:2028
+#: attrib.c:2046
 msgid "Invalid status on atrlock.. Notify god."
 msgstr ""
 
-#: attrib.c:2034 attrib.c:2104 set.c:984 set.c:1030
+#: attrib.c:2052 attrib.c:2122 set.c:987 set.c:1034
 msgid "No such attribute."
 msgstr ""
 
-#: attrib.c:2081
+#: attrib.c:2099
 msgid "I can't find that player"
 msgstr ""
 
-#: attrib.c:2090
+#: attrib.c:2108
 msgid "You can only chown an attribute to yourself."
 msgstr ""
 
-#: attrib.c:2095
+#: attrib.c:2113
 msgid "Attribute owner changed."
 msgstr ""
 
-#: attrib.c:2099
+#: attrib.c:2117
 msgid "You don't have the permission to chown that."
 msgstr ""
 
@@ -363,882 +368,882 @@
 msgid "I don't know which %s you mean!"
 msgstr ""
 
-#: boolexp.c:2027 boolexp.c:2043
+#: boolexp.c:2052 boolexp.c:2068
 #, c-format
 msgid "%s lock refers to garbage object"
 msgstr ""
 
-#: boolexp.c:2036
+#: boolexp.c:2061
 #, c-format
 msgid "%s lock has eval-lock that uses a nonexistant attribute '%s'."
 msgstr ""
 
-#: boolexp.c:2046
+#: boolexp.c:2071
 #, c-format
 msgid "%s lock has indirect lock to %s/%s that it can't read"
 msgstr ""
 
-#: bsd.c:259 player.c:128
+#: bsd.c:263 player.c:128
 msgid "Either that player does not exist, or has a different password."
 msgstr ""
 
-#: bsd.c:262
+#: bsd.c:266
 msgid ""
 "Either there is already a player with that name, or that name is illegal."
 msgstr ""
 
-#: bsd.c:263
+#: bsd.c:267
 msgid "The password is invalid (or missing)."
 msgstr ""
 
-#: bsd.c:264
+#: bsd.c:268
 msgid "Unable to register that player with that email address."
 msgstr ""
 
-#: bsd.c:265
+#: bsd.c:269
 msgid "Registration successful! You will receive your password by email."
 msgstr ""
 
-#: bsd.c:266
+#: bsd.c:270
 msgid "Going down - Bye"
 msgstr ""
 
-#: bsd.c:267
+#: bsd.c:271
 msgid "GAME: SSL connections must be dropped, sorry."
 msgstr ""
 
-#: bsd.c:688
+#: bsd.c:695
 #, c-format
 msgid "Unable to open %s. Error output continues to stderr.\n"
 msgstr ""
 
-#: bsd.c:692 log.c:142
+#: bsd.c:699 log.c:142
 msgid "Ack!  Failed reopening stderr!"
 msgstr ""
 
-#: bsd.c:932 bsd.c:942
+#: bsd.c:939 bsd.c:949
 msgid "GAME: ERROR! Forking database save failed!"
 msgstr ""
 
-#: bsd.c:959
+#: bsd.c:966
 msgid "GAME: Shutdown by external signal"
 msgstr ""
 
-#: bsd.c:1455
+#: bsd.c:1462
 #, c-format
 msgid ""
 "%s sizes:  NewUser...%d  Connect...%d  Guest...%d  Motd...%d  Wizmotd...%d  "
 "Quit...%d  Register...%d  Down...%d  Full...%d"
 msgstr ""
 
-#: bsd.c:2481
+#: bsd.c:2509
 #, c-format
 msgid "%ld failed connections since last login."
 msgstr ""
 
-#: bsd.c:2494
+#: bsd.c:2522
 msgid "Your HAVEN flag is set. You cannot receive pages."
 msgstr ""
 
-#: bsd.c:2498
+#: bsd.c:2526
 msgid "Welcome back from vacation! Don't forget to unset your ON-VACATION flag"
 msgstr ""
 
-#: bsd.c:2801 wiz.c:862
+#: bsd.c:2833 wiz.c:864
 msgid "You are politely shown to the door."
 msgstr ""
 
-#: bsd.c:2808
+#: bsd.c:2842
 msgid "You boot an idle self."
 msgstr ""
 
-#: bsd.c:2810
+#: bsd.c:2844
 #, c-format
 msgid "You boot %d idle selves."
 msgstr ""
 
-#: bsd.c:2862 bsd.c:2913
+#: bsd.c:2896 bsd.c:2947
 msgid "That's not a port number."
 msgstr ""
 
-#: bsd.c:2872
+#: bsd.c:2906
 msgid "That port is not active."
 msgstr ""
 
-#: bsd.c:2877 speech.c:566
+#: bsd.c:2911 speech.c:577
 #, c-format
 msgid "You pemit \"%s\" to %s."
 msgstr ""
 
-#: bsd.c:2878 bsd.c:2959 bsd.c:2965
+#: bsd.c:2912 bsd.c:2993 bsd.c:2999
 msgid "a connecting player"
 msgstr ""
 
-#: bsd.c:2918 bsd.c:2930
+#: bsd.c:2952 bsd.c:2964
 msgid "What do you want to page with?"
 msgstr ""
 
-#: bsd.c:2948
+#: bsd.c:2982
 msgid "That port's not active."
 msgstr ""
 
-#: bsd.c:2955
+#: bsd.c:2989
 #, c-format
 msgid "From afar, %s%s%s"
 msgstr ""
 
-#: bsd.c:2957 speech.c:1021
+#: bsd.c:2991 speech.c:1045
 #, c-format
 msgid "Long distance to %s: %s%s%s"
 msgstr ""
 
-#: bsd.c:2962
+#: bsd.c:2996
 #, c-format
 msgid "%s pages: %s"
 msgstr ""
 
-#: bsd.c:2963 speech.c:1024
+#: bsd.c:2997 speech.c:1048
 #, c-format
 msgid "You paged %s with '%s'"
 msgstr ""
 
-#: bsd.c:3202 bsd.c:3256 bsd.c:3310 bsd.c:3390
+#: bsd.c:3307 bsd.c:3361 bsd.c:3415 bsd.c:3496
 msgid "Player Name"
 msgstr ""
 
-#: bsd.c:3202 bsd.c:3256 bsd.c:3311 bsd.c:3390
+#: bsd.c:3307 bsd.c:3361 bsd.c:3416 bsd.c:3496
 msgid "On For"
 msgstr ""
 
-#: bsd.c:3202 bsd.c:3257 bsd.c:3311 bsd.c:3390
+#: bsd.c:3307 bsd.c:3362 bsd.c:3416 bsd.c:3496
 msgid "Idle"
 msgstr ""
 
-#: bsd.c:3222 bsd.c:3275 bsd.c:3355 bsd.c:3426
+#: bsd.c:3327 bsd.c:3380 bsd.c:3461 bsd.c:3532
 msgid "There are no players connected."
 msgstr ""
 
-#: bsd.c:3225
+#: bsd.c:3330
 msgid "There is 1 player connected."
 msgstr ""
 
-#: bsd.c:3228 bsd.c:3281 bsd.c:3361 bsd.c:3432
+#: bsd.c:3333 bsd.c:3386 bsd.c:3467 bsd.c:3538
 #, c-format
 msgid "There are %d players connected."
 msgstr ""
 
-#: bsd.c:3278 bsd.c:3358 bsd.c:3429
+#: bsd.c:3383 bsd.c:3464 bsd.c:3535
 msgid "There is one player connected."
 msgstr ""
 
-#: bsd.c:3311 bsd.c:3390
+#: bsd.c:3416 bsd.c:3496
 msgid "Loc #"
 msgstr ""
 
-#: bsd.c:3311 bsd.c:3390
+#: bsd.c:3416 bsd.c:3496
 msgid "Cmds"
 msgstr ""
 
-#: bsd.c:3311 bsd.c:3391
+#: bsd.c:3416 bsd.c:3497
 msgid "Des"
 msgstr ""
 
-#: bsd.c:3311
+#: bsd.c:3417
 msgid "Host"
 msgstr ""
 
-#: bsd.c:3339 bsd.c:3412
+#: bsd.c:3445 bsd.c:3518
 msgid "Connecting..."
 msgstr ""
 
-#: bsd.c:3391
+#: bsd.c:3497
 msgid "Sent"
 msgstr ""
 
-#: bsd.c:3391
+#: bsd.c:3497
 msgid "Recv"
 msgstr ""
 
-#: bsd.c:3391
+#: bsd.c:3497
 msgid "Pend"
 msgstr ""
 
-#: bsd.c:3504
+#: bsd.c:3610
 #, c-format
 msgid "%s created."
 msgstr ""
 
-#: bsd.c:3505 bsd.c:3527 bsd.c:3530 bsd.c:3748 bsd.c:3751
+#: bsd.c:3611 bsd.c:3633 bsd.c:3636 bsd.c:3854 bsd.c:3857
 msgid "GAME:"
 msgstr ""
 
-#: bsd.c:3507
+#: bsd.c:3613
 #, c-format
 msgid "GAME: Suspect %s created."
 msgstr ""
 
-#: bsd.c:3512
+#: bsd.c:3618
 msgid "has DARK-reconnected."
 msgstr ""
 
-#: bsd.c:3512
+#: bsd.c:3618
 msgid "has DARK-connected."
 msgstr ""
 
-#: bsd.c:3515
+#: bsd.c:3621
 msgid "has HIDDEN-reconnected."
 msgstr ""
 
-#: bsd.c:3516
+#: bsd.c:3622
 msgid "has HIDDEN-connected."
 msgstr ""
 
-#: bsd.c:3518
+#: bsd.c:3624
 msgid "has reconnected."
 msgstr ""
 
-#: bsd.c:3518
+#: bsd.c:3624
 msgid "has connected."
 msgstr ""
 
-#: bsd.c:3524 bsd.c:3746
+#: bsd.c:3630 bsd.c:3852
 #, c-format
 msgid "GAME: Suspect %s"
 msgstr ""
 
-#: bsd.c:3537
+#: bsd.c:3643
 msgid "You are nowhere!"
 msgstr ""
 
-#: bsd.c:3724
+#: bsd.c:3830
 msgid "has partially DARK-disconnected."
 msgstr ""
 
-#: bsd.c:3725
+#: bsd.c:3831
 msgid "has DARK-disconnected."
 msgstr ""
 
-#: bsd.c:3727
+#: bsd.c:3833
 msgid "has partially HIDDEN-disconnected."
 msgstr ""
 
-#: bsd.c:3728
+#: bsd.c:3834
 msgid "has HIDDEN-disconnected."
 msgstr ""
 
-#: bsd.c:3730
+#: bsd.c:3836
 msgid "has partially disconnected."
 msgstr ""
 
-#: bsd.c:3731
+#: bsd.c:3837
 msgid "has disconnected."
 msgstr ""
 
-#: bsd.c:3776
+#: bsd.c:3882
 msgid "You may get 15 minutes of fame and glory in life, but not right now."
 msgstr ""
 
-#: bsd.c:3781 extchat.c:2071
+#: bsd.c:3887 extchat.c:2067
 msgid "cleared"
 msgstr ""
 
-#: bsd.c:3783 extchat.c:2071
+#: bsd.c:3889 extchat.c:2067
 msgid "set"
 msgstr ""
 
-#: bsd.c:3788
+#: bsd.c:3894
 #, c-format
 msgid "Motd %s."
 msgstr ""
 
-#: bsd.c:3792
+#: bsd.c:3898
 #, c-format
 msgid "Wizard motd %s."
 msgstr ""
 
-#: bsd.c:3796
+#: bsd.c:3902
 #, c-format
 msgid "Down motd %s."
 msgstr ""
 
-#: bsd.c:3800
+#: bsd.c:3906
 #, c-format
 msgid "Full motd %s."
 msgstr ""
 
-#: bsd.c:3803
+#: bsd.c:3909
 #, c-format
 msgid "MOTD: %s"
 msgstr ""
 
-#: bsd.c:3805
+#: bsd.c:3911
 #, c-format
 msgid "Wiz MOTD: %s"
 msgstr ""
 
-#: bsd.c:3806
+#: bsd.c:3912
 #, c-format
 msgid "Down MOTD: %s"
 msgstr ""
 
-#: bsd.c:3807
+#: bsd.c:3913
 #, c-format
 msgid "Full MOTD: %s"
 msgstr ""
 
-#: bsd.c:3828
+#: bsd.c:3934
 msgid "Why would you want to do that?"
 msgstr ""
 
-#: bsd.c:3847
+#: bsd.c:3953
 #, c-format
 msgid "Doing set. %d characters lost."
 msgstr ""
 
-#: bsd.c:3850
+#: bsd.c:3956
 msgid "Doing set."
 msgstr ""
 
-#: bsd.c:3868
+#: bsd.c:3974
 #, c-format
 msgid "The current poll is: %s"
 msgstr ""
 
-#: bsd.c:3873
+#: bsd.c:3979
 msgid "Who do you think you are, Gallup?"
 msgstr ""
 
-#: bsd.c:3879
+#: bsd.c:3985
 msgid "Poll reset."
 msgstr ""
 
-#: bsd.c:3894
+#: bsd.c:4000
 #, c-format
 msgid "Poll set to '%s'. %d characters lost."
 msgstr ""
 
-#: bsd.c:3897
+#: bsd.c:4003
 #, c-format
 msgid "Poll set to: %s"
 msgstr ""
 
-#: bsd.c:3974 fundb.c:160 fundb.c:742 funlist.c:2318 funlist.c:2337
-#: parse.c:1028
+#: bsd.c:4083 fundb.c:163 fundb.c:776 funlist.c:2307 funlist.c:2326
+#: parse.c:1040
 msgid "#-1 ARGUMENT OUT OF RANGE"
 msgstr ""
 
-#: bsd.c:4063 bsd.c:4072 bsd.c:4593 bsd.c:4602 cmds.c:434 fundb.c:860
-#: fundb.c:887
+#: bsd.c:4172 bsd.c:4181 bsd.c:4702 bsd.c:4711 cmds.c:438 fundb.c:895
+#: fundb.c:922
 msgid "#-1 INVALID SECOND ARGUMENT"
 msgstr ""
 
-#: bsd.c:4076 bsd.c:4606 extchat.c:2373 extchat.c:2378 parse.c:97
+#: bsd.c:4185 bsd.c:4715 extchat.c:2369 extchat.c:2374 parse.c:97
 msgid "#-1 PERMISSION DENIED"
 msgstr ""
 
-#: bsd.c:4115 bsd.c:4685
+#: bsd.c:4224 bsd.c:4794
 msgid "Couldn't find that descriptor."
 msgstr ""
 
-#: bsd.c:4123 wiz.c:1397
+#: bsd.c:4232 wiz.c:1424
 msgid "Couldn't find that player."
 msgstr ""
 
-#: bsd.c:4341 funufun.c:304
+#: bsd.c:4450 funufun.c:314
 msgid "#-1 INVALID ZONE"
 msgstr ""
 
-#: bsd.c:4458 bsd.c:4479 bsd.c:4532
+#: bsd.c:4567 bsd.c:4588 bsd.c:4641
 msgid "#-1 NOT CONNECTED"
 msgstr ""
 
-#: bsd.c:4489 bsd.c:4502 bsd.c:4515
+#: bsd.c:4598 bsd.c:4611 bsd.c:4624
 msgid "#-1 FUNCTION REQUIRES ONE ARGUMENT"
 msgstr ""
 
-#: bsd.c:4696
+#: bsd.c:4805
 msgid "Noone is connected to that descriptor."
 msgstr ""
 
-#: bsd.c:4701
+#: bsd.c:4810
 msgid "Connection hidden."
 msgstr ""
 
-#: bsd.c:4703
+#: bsd.c:4812
 msgid "Connection unhidden."
 msgstr ""
 
-#: bsd.c:4717 wiz.c:888
+#: bsd.c:4826 wiz.c:890
 msgid "That player is not online."
 msgstr ""
 
-#: bsd.c:4726
+#: bsd.c:4835
 msgid "You no longer appear on the WHO list."
 msgstr ""
 
-#: bsd.c:4728
+#: bsd.c:4837
 #, c-format
 msgid "%s no longer appears on the WHO list."
 msgstr ""
 
-#: bsd.c:4732
+#: bsd.c:4841
 msgid "You now appear on the WHO list."
 msgstr ""
 
-#: bsd.c:4734
+#: bsd.c:4843
 #, c-format
 msgid "%s now appears on the WHO list."
 msgstr ""
 
-#: bsd.c:4776
+#: bsd.c:4885
 msgid ""
 "\n"
 "*** Inactivity timeout ***\n"
 msgstr ""
 
-#: bsd.c:4786
+#: bsd.c:4895
 msgid ""
 "\n"
 "*** Inactivity limit reached. You are now HIDDEN. ***\n"
 msgstr ""
 
-#: bsd.c:4941 bsd.c:4948
+#: bsd.c:5050 bsd.c:5057
 msgid "GAME: Error writing reboot database!"
 msgstr ""
 
-#: bsd.c:5135
+#: bsd.c:5244
 msgid "GAME: Reboot finished."
 msgstr ""
 
-#: bsd.c:5157
+#: bsd.c:5266
 #, c-format
 msgid "Unable to reboot using executable '%s': %s"
 msgstr ""
 
-#: bsd.c:5166
+#: bsd.c:5275
 msgid "GAME: Reboot w/o disconnect from game account, please wait."
 msgstr ""
 
-#: bsd.c:5171
+#: bsd.c:5280
 #, c-format
 msgid "GAME: Reboot w/o disconnect by %s, please wait."
 msgstr ""
 
-#: cmds.c:166 cmds.c:178
+#: cmds.c:170 cmds.c:182
 msgid "You can't remake the world in your image."
 msgstr ""
 
-#: cmds.c:170
+#: cmds.c:174
 msgid "What did you want to set?"
 msgstr ""
 
-#: cmds.c:184
+#: cmds.c:188
 msgid "Couldn't set that option."
 msgstr ""
 
-#: cmds.c:188
+#: cmds.c:192
 msgid "Option set and saved."
 msgstr ""
 
-#: cmds.c:190
+#: cmds.c:194
 msgid "Option set but not saved (Saves disabled.)"
 msgstr ""
 
-#: cmds.c:193
+#: cmds.c:197
 msgid "Option set."
 msgstr ""
 
-#: cmds.c:494
+#: cmds.c:498
 msgid "You must give a switch for @hook"
 msgstr ""
 
-#: cmds.c:502
+#: cmds.c:506
 msgid "Huh?  (Type \"help\" for help.)"
 msgstr ""
 
-#: cmds.c:549 game.c:2340
+#: cmds.c:553 game.c:2376
 msgid "Locks"
 msgstr ""
 
-#: cmds.c:553 cmds.c:865 game.c:2338
+#: cmds.c:557 cmds.c:873 game.c:2374
 msgid "Powers"
 msgstr ""
 
-#: cmds.c:647 extmail.c:1516
+#: cmds.c:655 extmail.c:1574
 msgid "You cannot do that while gagged."
 msgstr ""
 
-#: cmds.c:717
+#: cmds.c:725
 msgid "@message them with what?"
 msgstr ""
 
-#: cmds.c:720
+#: cmds.c:728
 msgid "Use what attribute for the @message?"
 msgstr ""
 
-#: cmds.c:724
+#: cmds.c:732
 msgid "@message who?"
 msgstr ""
 
-#: cmds.c:1066
+#: cmds.c:1074
 msgid "You can't teleport to nothing!"
 msgstr ""
 
-#: cmds.c:1258
+#: cmds.c:1266
 msgid "Buy for WHAT price?"
 msgstr ""
 
-#: cmds.c:1263
+#: cmds.c:1271
 msgid "You can't buy things by taking money."
 msgstr ""
 
-#: cmds.c:1380
+#: cmds.c:1388
 #, c-format
 msgid "No command found in code by %s - don't start code with functions."
 msgstr ""
 
-#: command.c:1271
+#: command.c:1275
 #, c-format
 msgid "%s doesn't know switch %s."
 msgstr ""
 
-#: command.c:1657
+#: command.c:1681
 msgid "This command has not been implemented."
 msgstr ""
 
-#: command.c:1684 command.c:1715
+#: command.c:1708 command.c:1739
 msgid "Bad command name."
 msgstr ""
 
-#: command.c:1690
+#: command.c:1714
 #, c-format
 msgid "Command %s added."
 msgstr ""
 
-#: command.c:1693
+#: command.c:1717
 #, c-format
 msgid "Command %s already exists."
 msgstr ""
 
-#: command.c:1712 command.c:1792 command.c:1883 command.c:2167 command.c:2268
+#: command.c:1736 command.c:1825 command.c:1916 command.c:2280 command.c:2383
 msgid "No such command."
 msgstr ""
 
-#: command.c:1720
+#: command.c:1744
 msgid "Command cloned."
 msgstr ""
 
-#: command.c:1800
+#: command.c:1833
 msgid "You can't delete built-in commands. @command/disable instead."
 msgstr ""
 
-#: command.c:1816
+#: command.c:1849
 #, c-format
 msgid "Removed %s and aliases from command table."
 msgstr ""
 
-#: command.c:1819 command.c:1824
+#: command.c:1852 command.c:1857
 #, c-format
 msgid "Removed %s from command table."
 msgstr ""
 
-#: command.c:1840
+#: command.c:1873
 msgid "You must specify a command."
 msgstr ""
 
-#: command.c:1853
+#: command.c:1886
 msgid ""
 "WARNING: /NOEVAL no longer creates a Noparse command.\n"
 "         Use /NOPARSE if that's what you meant."
 msgstr ""
 
-#: command.c:1860
+#: command.c:1893
 msgid "I can't alias a command to that!"
 msgstr ""
 
-#: command.c:1862
+#: command.c:1895
 msgid "Unable to set alias."
 msgstr ""
 
-#: command.c:1894
+#: command.c:1927
 msgid "How do you want to restrict the command?"
 msgstr ""
 
-#: command.c:1899
+#: command.c:1932
 msgid "Restrict attempt failed."
 msgstr ""
 
-#: command.c:1903
+#: command.c:1936
 msgid "@command is ALWAYS enabled."
 msgstr ""
 
-#: command.c:1909
+#: command.c:1942
 #, c-format
 msgid "Name       : %s (%s)"
 msgstr ""
 
-#: command.c:1922
+#: command.c:1955
 #, c-format
 msgid "Flags      : %s"
 msgstr ""
 
-#: command.c:1924
+#: command.c:1957
 #, c-format
 msgid "Lock       : %s"
 msgstr ""
 
-#: command.c:1931
+#: command.c:1965
 #, c-format
 msgid "Switches   : %s"
 msgstr ""
 
-#: command.c:1933
+#: command.c:1967
 msgid "Switches   :"
 msgstr ""
 
-#: command.c:1946
+#: command.c:1980
 #, c-format
 msgid "Leftside   : %s"
 msgstr ""
 
-#: command.c:1958
+#: command.c:1992
 #, c-format
 msgid "Rightside  : %s"
 msgstr ""
 
-#: command.c:1961
+#: command.c:1995
 #, c-format
 msgid "Arguments  : %s"
 msgstr ""
 
-#: command.c:1976
+#: command.c:2010
 #, c-format
 msgid "Commands: %s"
 msgstr ""
 
-#: command.c:2171
+#: command.c:2284
 msgid "Hooks not allowed with that command."
 msgstr ""
 
-#: command.c:2184
+#: command.c:2297
 msgid "Unknown hook type"
 msgstr ""
 
-#: command.c:2189
+#: command.c:2302
 #, c-format
 msgid "Hook removed from %s."
 msgstr ""
 
-#: command.c:2196
+#: command.c:2311
 msgid "You must give an object."
 msgstr ""
 
-#: command.c:2198
+#: command.c:2313
 msgid "You must give both an object and attribute."
 msgstr ""
 
-#: command.c:2203
+#: command.c:2318
 msgid "Invalid hook object."
 msgstr ""
 
-#: command.c:2214
+#: command.c:2329
 #, c-format
 msgid "Hook set for %s"
 msgstr ""
 
-#: command.c:2248
+#: command.c:2363
 msgid "There are no hooks currently set."
 msgstr ""
 
-#: command.c:2253
+#: command.c:2368
 msgid "The following commands have hooks: "
 msgstr ""
 
-#: conf.c:542
+#: conf.c:543
 msgid "Options affecting attributes"
 msgstr ""
 
-#: conf.c:543
+#: conf.c:544
 msgid "Chat system options"
 msgstr ""
 
-#: conf.c:544
+#: conf.c:545
 msgid "Options affecting command behavior"
 msgstr ""
 
-#: conf.c:545
+#: conf.c:546
 msgid "Compile-time options"
 msgstr ""
 
-#: conf.c:546
+#: conf.c:547
 msgid "Cosmetic options"
 msgstr ""
 
-#: conf.c:547
+#: conf.c:548
 msgid "Costs"
 msgstr ""
 
-#: conf.c:548
+#: conf.c:549
 msgid "Database options"
 msgstr ""
 
-#: conf.c:549
+#: conf.c:550
 msgid "Options affecting dumps and other periodic processes"
 msgstr ""
 
-#: conf.c:550
+#: conf.c:551
 msgid "Files used by the MUSH"
 msgstr ""
 
-#: conf.c:551
+#: conf.c:552
 msgid "Default flags for new objects"
 msgstr ""
 
-#: conf.c:552
+#: conf.c:553
 msgid "Options affecting function behavior"
 msgstr ""
 
-#: conf.c:553
+#: conf.c:554
 msgid "Limits and other constants"
 msgstr ""
 
-#: conf.c:554
+#: conf.c:555
 msgid "Logging options"
 msgstr ""
 
-#: conf.c:555
+#: conf.c:556
 msgid "Message files sent by the MUSH"
 msgstr ""
 
-#: conf.c:556
+#: conf.c:557
 msgid "Networking and connection-related options"
 msgstr ""
 
-#: conf.c:557
+#: conf.c:558
 msgid "TinyMUSH compatibility options"
 msgstr ""
 
-#: conf.c:1162
+#: conf.c:1274
 msgid "GAME: Dumping database. Game may freeze for a minute"
 msgstr ""
 
-#: conf.c:1163
+#: conf.c:1275
 msgid "GAME: Dump complete. Time in."
 msgstr ""
 
-#: conf.c:1224
+#: conf.c:1336
 msgid "GAME: Database will be dumped in 1 minute."
 msgstr ""
 
-#: conf.c:1226
+#: conf.c:1338
 msgid "GAME: Database will be dumped in 5 minutes."
 msgstr ""
 
-#: conf.c:1515
+#: conf.c:1644
 msgid "I only know the following types of options:"
 msgstr ""
 
-#: conf.c:1543
+#: conf.c:1672
 msgid "Use: @config/list <type of options> where type is one of:"
 msgstr ""
 
-#: conf.c:1654
+#: conf.c:1783
 msgid "#-1 NO SUCH CONFIG OPTION"
 msgstr ""
 
-#: conf.c:1695 function.c:1684
+#: conf.c:1824 function.c:1772
 msgid "Disabled."
 msgstr ""
 
-#: conf.c:1697 function.c:1681
+#: conf.c:1826 function.c:1769
 msgid "Enabled."
 msgstr ""
 
-#: conf.c:1701
+#: conf.c:1830
 msgid "That isn't an on/off option."
 msgstr ""
 
-#: conf.c:1705
+#: conf.c:1834
 msgid "No such option."
 msgstr ""
 
-#: conf.c:1712
+#: conf.c:1841
 msgid " Attributes are not compressed in memory."
 msgstr ""
 
-#: conf.c:1715
+#: conf.c:1844
 msgid " Attributes are Huffman compressed in memory."
 msgstr ""
 
-#: conf.c:1718
+#: conf.c:1847
 msgid " Attributes are word compressed in memory."
 msgstr ""
 
-#: conf.c:1721
+#: conf.c:1850
 msgid " Attributes are 8-bit word compressed in memory."
 msgstr ""
 
-#: conf.c:1725
+#: conf.c:1854
 msgid " The MUSH was compiled with SSL support."
 msgstr ""
 
-#: conf.c:1729
+#: conf.c:1858
 msgid " The MUSH was compiled with MySQL support."
 msgstr ""
 
-#: conf.c:1732
+#: conf.c:1861
 msgid " The MUSH was compiled with Postgresql support."
 msgstr ""
 
-#: conf.c:1735
+#: conf.c:1864
 msgid " The MUSH was compiled with Sqlite3 support."
 msgstr ""
 
-#: conf.c:1739
+#: conf.c:1868
 msgid " DNS and ident lookups are handled by a slave process."
 msgstr ""
 
-#: conf.c:1741
+#: conf.c:1870
 msgid " DNS and ident lookups are handled by the MUSH process."
 msgstr ""
 
-#: conf.c:1745
+#: conf.c:1874
 msgid " Extended convtime() is supported."
 msgstr ""
 
-#: conf.c:1747
+#: conf.c:1876
 msgid " convtime() is stricter."
 msgstr ""
 
-#: conf.c:1751
+#: conf.c:1880
 msgid " CPU usage limiting is supported."
 msgstr ""
 
-#: conf.c:1753
+#: conf.c:1882
 msgid " CPU usage limiting is NOT supported."
 msgstr ""
 
-#: conf.c:1757
+#: conf.c:1886
 msgid " Changed help files will be automatically reindexed."
 msgstr ""
 
-#: conf.c:1761
+#: conf.c:1890
 msgid " SSE2 instructions are being used."
 msgstr ""
 
-#: conf.c:1765
+#: conf.c:1894
 msgid " SSE3 instructions are being used."
 msgstr ""
 
-#: conf.c:1769
+#: conf.c:1898
 msgid " Altivec instructions are being used."
 msgstr ""
 
-#: conf.c:1773
+#: conf.c:1902
 msgid " @config/save is enabled."
 msgstr ""
 
-#: conf.c:1775
+#: conf.c:1904
 msgid " @config/save is disabled."
 msgstr ""
 
@@ -1257,177 +1262,177 @@
 msgid "Runaway object: %s(%s). Commands halted."
 msgstr ""
 
-#: cque.c:305 cque.c:465
+#: cque.c:305 cque.c:466
 msgid "Queue entry table full. Try again later."
 msgstr ""
 
-#: cque.c:688
+#: cque.c:692
 msgid "@break recursion exceeded."
 msgstr ""
 
-#: cque.c:696
+#: cque.c:700
 msgid "@include recursion exceeded."
 msgstr ""
 
-#: cque.c:910
+#: cque.c:921
 msgid "You must specify an object to use for the semaphore."
 msgstr ""
 
-#: cque.c:920
+#: cque.c:931
 msgid "You may not specify a semaphore attribute with the ANY switch."
 msgstr ""
 
-#: cque.c:952
+#: cque.c:963
 msgid "You may not specify a semaphore count with the ALL switch."
 msgstr ""
 
-#: cque.c:956
+#: cque.c:967
 msgid "The semaphore count must be an integer."
 msgstr ""
 
-#: cque.c:972
+#: cque.c:983
 msgid "Drained."
 msgstr ""
 
-#: cque.c:974
+#: cque.c:985
 msgid "Notified."
 msgstr ""
 
-#: cque.c:1083 cque.c:1091 cque.c:1594 cque.c:1601
+#: cque.c:1094 cque.c:1102 cque.c:1605 cque.c:1612
 msgid "That is not a valid pid!"
 msgstr ""
 
-#: cque.c:1102
+#: cque.c:1113
 msgid "You cannot adjust the timeout of an indefinite semaphore."
 msgstr ""
 
-#: cque.c:1107
+#: cque.c:1118
 msgid "That is not a valid timestamp."
 msgstr ""
 
-#: cque.c:1173
+#: cque.c:1184
 #, c-format
 msgid "Queue entry with pid %u updated."
 msgstr ""
 
-#: cque.c:1195
+#: cque.c:1206
 msgid "#-1 INVALID PID"
 msgstr ""
 
-#: cque.c:1414 set.c:182
+#: cque.c:1425 set.c:182
 msgid "I couldn't find that player."
 msgstr ""
 
-#: cque.c:1417 rob.c:188 rob.c:353 speech.c:556
+#: cque.c:1428 rob.c:187 rob.c:352 speech.c:567
 msgid "I don't know who you mean!"
 msgstr ""
 
-#: cque.c:1423
+#: cque.c:1434
 msgid "Queue for : all"
 msgstr ""
 
-#: cque.c:1425
+#: cque.c:1436
 #, c-format
 msgid "Queue for : %s"
 msgstr ""
 
-#: cque.c:1429
+#: cque.c:1440
 msgid "Player Queue:"
 msgstr ""
 
-#: cque.c:1432
+#: cque.c:1443
 msgid "Object Queue:"
 msgstr ""
 
-#: cque.c:1435
+#: cque.c:1446
 msgid "Wait Queue:"
 msgstr ""
 
-#: cque.c:1438
+#: cque.c:1449
 msgid "Semaphore Queue:"
 msgstr ""
 
-#: cque.c:1441
+#: cque.c:1452
 msgid "------------  Queue Done  ------------"
 msgstr ""
 
-#: cque.c:1444
+#: cque.c:1455
 #, c-format
 msgid ""
 "Totals: Player...%d/%d[%ddel]  Object...%d/%d[%ddel]  Wait...%d/%d[%ddel]  "
 "Semaphore...%d/%d"
 msgstr ""
 
-#: cque.c:1467 cque.c:1572 cque.c:1574
+#: cque.c:1478 cque.c:1583 cque.c:1585
 msgid "Halted"
 msgstr ""
 
-#: cque.c:1553
+#: cque.c:1564
 msgid "You may not use @halt obj=command on this object."
 msgstr ""
 
-#: cque.c:1562
+#: cque.c:1573
 msgid "All of your objects have been halted."
 msgstr ""
 
-#: cque.c:1565
+#: cque.c:1576
 #, c-format
 msgid "All objects for %s have been halted."
 msgstr ""
 
-#: cque.c:1567
+#: cque.c:1578
 #, c-format
 msgid "All of your objects have been halted by %s."
 msgstr ""
 
-#: cque.c:1635
+#: cque.c:1646
 #, c-format
 msgid "Queue entry with pid %u halted."
 msgstr ""
 
-#: cque.c:1649
+#: cque.c:1660
 msgid "You do not have the power to bring the world to a halt."
 msgstr ""
 
-#: cque.c:1655
+#: cque.c:1666
 #, c-format
 msgid "Your objects have been globally halted by %s"
 msgstr ""
 
-#: cque.c:1673
+#: cque.c:1684
 msgid "You do not have the power to restart the world."
 msgstr ""
 
-#: cque.c:1685
+#: cque.c:1696
 #, c-format
 msgid "Your objects are being globally restarted by %s"
 msgstr ""
 
-#: cque.c:1730
+#: cque.c:1741
 #, c-format
 msgid "All objects for %s are being restarted."
 msgstr ""
 
-#: cque.c:1734
+#: cque.c:1745
 #, c-format
 msgid "All of your objects are being restarted by %s."
 msgstr ""
 
-#: cque.c:1738
+#: cque.c:1749
 #, c-format
 msgid "Restarting: %s's %s(%s)"
 msgstr ""
 
-#: cque.c:1740
+#: cque.c:1751
 #, c-format
 msgid "Restarting: %s(%s), by %s"
 msgstr ""
 
-#: cque.c:1745
+#: cque.c:1756
 msgid "All of your objects are being restarted."
 msgstr ""
 
-#: cque.c:1747
+#: cque.c:1758
 #, c-format
 msgid "Restarting: %s(%s)"
 msgstr ""
@@ -1479,131 +1484,131 @@
 msgid "Linked exit #%d to #%d"
 msgstr ""
 
-#: create.c:187
+#: create.c:189
 msgid "Open from where?"
 msgstr ""
 
-#: create.c:228
+#: create.c:230
 msgid "Unlink what?"
 msgstr ""
 
-#: create.c:231 match.c:475 wiz.c:980
+#: create.c:233 match.c:476 wiz.c:984
 msgid "I don't know which one you mean!"
 msgstr ""
 
-#: create.c:241
+#: create.c:243
 #, c-format
 msgid "Unlinked exit #%d (Used to lead to %s)."
 msgstr ""
 
-#: create.c:246
+#: create.c:248
 msgid "Dropto removed."
 msgstr ""
 
-#: create.c:249
+#: create.c:251
 msgid "You can't unlink that!"
 msgstr ""
 
-#: create.c:288
+#: create.c:290
 msgid "You somehow wound up in a exit. No biscuit."
 msgstr ""
 
-#: create.c:319 create.c:326
+#: create.c:321 create.c:328
 #, c-format
 msgid "It costs %d %s to link this exit."
 msgstr ""
 
-#: create.c:344
+#: create.c:346
 #, c-format
 msgid "Linked exit #%d to %s"
 msgstr ""
 
-#: create.c:351 fundb.c:1850 wiz.c:399
+#: create.c:354 fundb.c:1895 wiz.c:401
 msgid "No match."
 msgstr ""
 
-#: create.c:355
+#: create.c:358
 msgid "That is an exit."
 msgstr ""
 
-#: create.c:359
+#: create.c:362
 msgid "You may not link something to itself."
 msgstr ""
 
-#: create.c:370
+#: create.c:373
 msgid "Can't set home to home."
 msgstr ""
 
-#: create.c:375
+#: create.c:378
 msgid "Home set."
 msgstr ""
 
-#: create.c:382
+#: create.c:385
 msgid "That is not a room!"
 msgstr ""
 
-#: create.c:390
+#: create.c:393
 msgid "Dropto set."
 msgstr ""
 
-#: create.c:394
+#: create.c:397
 msgid "Internal error: weird object type."
 msgstr ""
 
-#: create.c:421
+#: create.c:424
 msgid "Dig what?"
 msgstr ""
 
-#: create.c:423
+#: create.c:426
 msgid "That's a silly name for a room!"
 msgstr ""
 
-#: create.c:442
+#: create.c:445
 #, c-format
 msgid "%s created with room number %d."
 msgstr ""
 
-#: create.c:484
+#: create.c:487
 msgid "Create what?"
 msgstr ""
 
-#: create.c:487
+#: create.c:490
 msgid "That's a silly name for a thing!"
 msgstr ""
 
-#: create.c:537
+#: create.c:540
 #, c-format
 msgid "Created: Object %s."
 msgstr ""
 
-#: create.c:580 create.c:713
+#: create.c:583 create.c:715
 msgid ""
 "Warning: @CLONE/PRESERVE on an object with WIZ, ROY, @powers, or @warnings."
 msgstr ""
 
-#: create.c:611 set.c:121
+#: create.c:614 set.c:121
 msgid "That is not a reasonable name."
 msgstr ""
 
-#: create.c:627
+#: create.c:630
 msgid "There's nothing left of it to clone!"
 msgstr ""
 
-#: create.c:632
+#: create.c:634
 msgid "You cannot @CLONE/PRESERVE. Use normal @CLONE instead."
 msgstr ""
 
-#: create.c:645
+#: create.c:647
 #, c-format
 msgid "Cloned: Object %s."
 msgstr ""
 
-#: create.c:662
+#: create.c:664
 #, c-format
 msgid "Cloned: Room #%d."
 msgstr ""
 
-#: create.c:714
+#: create.c:716
 #, c-format
 msgid "Cloned: Exit #%d."
 msgstr ""
@@ -1817,12 +1822,12 @@
 msgid "GAME: Database consistency check complete."
 msgstr ""
 
-#: extchat.c:158 extchat.c:178 extchat.c:1199 extchat.c:1334 extchat.c:1344
-#: extchat.c:1399 extchat.c:1626 extchat.c:2760 extchat.c:3789
+#: extchat.c:158 extchat.c:178 extchat.c:1199 extchat.c:1333 extchat.c:1343
+#: extchat.c:1398 extchat.c:1622 extchat.c:2756 extchat.c:3790
 msgid "CHAT: I don't recognize that channel."
 msgstr ""
 
-#: extchat.c:161 extchat.c:181 extchat.c:1337 extchat.c:1402 extchat.c:1501
+#: extchat.c:161 extchat.c:181 extchat.c:1336 extchat.c:1401 extchat.c:1500
 msgid "CHAT: I don't know which channel you mean."
 msgstr ""
 
@@ -1830,15 +1835,15 @@
 msgid "CHAT: Partial matches are:"
 msgstr ""
 
-#: extchat.c:1173 extchat.c:3749 extchat.c:3868
+#: extchat.c:1173 extchat.c:3750 extchat.c:3868
 msgid "You need to specify a channel."
 msgstr ""
 
-#: extchat.c:1177 extchat.c:1704
+#: extchat.c:1177 extchat.c:1700
 msgid "What do you want to do with the channel?"
 msgstr ""
 
-#: extchat.c:1196 extchat.c:3786
+#: extchat.c:1196 extchat.c:3787
 #, c-format
 msgid "CHAT: You can't do that with channel <%s>."
 msgstr ""
@@ -1851,16 +1856,16 @@
 msgid "Invalid target."
 msgstr ""
 
-#: extchat.c:1230 extchat.c:1349
+#: extchat.c:1230 extchat.c:1348
 #, c-format
 msgid "Sorry, wrong type of thing for channel <%s>."
 msgstr ""
 
-#: extchat.c:1235 extchat.c:1324
+#: extchat.c:1235 extchat.c:1323
 msgid "Guests are not allowed to join channels."
 msgstr ""
 
-#: extchat.c:1245 extchat.c:1277 extchat.c:1376
+#: extchat.c:1245 extchat.c:1277 extchat.c:1375
 #, c-format
 msgid "%s is already on channel <%s>."
 msgstr ""
@@ -1871,7 +1876,7 @@
 "anyway)"
 msgstr ""
 
-#: extchat.c:1257 extchat.c:1361
+#: extchat.c:1257 extchat.c:1360
 msgid "Permission to join denied."
 msgstr ""
 
@@ -1885,7 +1890,7 @@
 msgid "CHAT: You join %s to channel <%s>."
 msgstr ""
 
-#: extchat.c:1273 extchat.c:1372
+#: extchat.c:1273 extchat.c:1371
 msgid "has joined this channel."
 msgstr ""
 
@@ -1893,7 +1898,7 @@
 msgid "Guests may not leave channels."
 msgstr ""
 
-#: extchat.c:1298 extchat.c:1414
+#: extchat.c:1298 extchat.c:1413
 msgid "has left this channel."
 msgstr ""
 
@@ -1907,580 +1912,580 @@
 msgid "CHAT: You remove %s from channel <%s>."
 msgstr ""
 
-#: extchat.c:1307 extchat.c:1418
+#: extchat.c:1307 extchat.c:1417
 #, c-format
 msgid "%s is not on channel <%s>."
 msgstr ""
 
-#: extchat.c:1331
+#: extchat.c:1330
 #, c-format
 msgid "CHAT: You are already on channel <%s>."
 msgstr ""
 
-#: extchat.c:1359
+#: extchat.c:1358
 msgid ""
 "CHAT: Warning: You don't meet channel join permissions! (joining anyway)"
 msgstr ""
 
-#: extchat.c:1366
+#: extchat.c:1365
 #, c-format
 msgid "CHAT: You join channel <%s>."
 msgstr ""
 
-#: extchat.c:1389
+#: extchat.c:1388
 msgid "Guests are not allowed to leave channels."
 msgstr ""
 
-#: extchat.c:1396
+#: extchat.c:1395
 #, c-format
 msgid "CHAT: You are not on channel <%s>."
 msgstr ""
 
-#: extchat.c:1415
+#: extchat.c:1414
 #, c-format
 msgid "CHAT: You leave channel <%s>."
 msgstr ""
 
-#: extchat.c:1492
+#: extchat.c:1491
 msgid "Don't you have anything to say?"
 msgstr ""
 
-#: extchat.c:1505
+#: extchat.c:1504
 msgid "CHAT: You may wish to set the CHAN_USEFIRSTMATCH flag on yourself."
 msgstr ""
 
-#: extchat.c:1515
+#: extchat.c:1514
 msgid "CHAT: No such channel."
 msgstr ""
 
-#: extchat.c:1540 extchat.c:1638
+#: extchat.c:1538 extchat.c:1634
 #, c-format
 msgid "Sorry, you're not the right type to be on channel <%s>."
 msgstr ""
 
-#: extchat.c:1547
+#: extchat.c:1545
 #, c-format
 msgid "Sorry, you're not allowed to speak on channel <%s>."
 msgstr ""
 
-#: extchat.c:1550 extchat.c:2888
+#: extchat.c:1548 extchat.c:2889
 msgid "No such channel."
 msgstr ""
 
-#: extchat.c:1558 extchat.c:1653
+#: extchat.c:1556 extchat.c:1649
 msgid "You must be on that channel to speak on it."
 msgstr ""
 
-#: extchat.c:1561 extchat.c:1656
+#: extchat.c:1559 extchat.c:1652
 msgid "You must stop gagging that channel to speak on it."
 msgstr ""
 
-#: extchat.c:1567
+#: extchat.c:1565
 msgid "What do you want to say to that channel?"
 msgstr ""
 
-#: extchat.c:1611
+#: extchat.c:1607
 msgid "That is not a valid channel."
 msgstr ""
 
-#: extchat.c:1616
+#: extchat.c:1612
 msgid "I don't recognize that channel."
 msgstr ""
 
-#: extchat.c:1619
+#: extchat.c:1615
 msgid "I don't know which channel you mean."
 msgstr ""
 
-#: extchat.c:1644
+#: extchat.c:1640
 #, c-format
 msgid "Sorry, you're not allowed to @cemit on channel <%s>."
 msgstr ""
 
-#: extchat.c:1662
+#: extchat.c:1658
 msgid "What do you want to emit?"
 msgstr ""
 
-#: extchat.c:1670
+#: extchat.c:1666
 #, c-format
 msgid "Cemit to channel %s: %s"
 msgstr ""
 
-#: extchat.c:1696 extchat.c:2032
+#: extchat.c:1692 extchat.c:2028
 msgid "You must specify a channel."
 msgstr ""
 
-#: extchat.c:1700
+#: extchat.c:1696
 msgid "Guests may not modify channels."
 msgstr ""
 
-#: extchat.c:1715
+#: extchat.c:1711
 msgid "No more room for channels."
 msgstr ""
 
-#: extchat.c:1719
+#: extchat.c:1715
 msgid "The channel needs a shorter name."
 msgstr ""
 
-#: extchat.c:1723
+#: extchat.c:1719
 msgid "Invalid name for a channel."
 msgstr ""
 
-#: extchat.c:1727
+#: extchat.c:1723
 msgid "You already own too many channels."
 msgstr ""
 
-#: extchat.c:1732
+#: extchat.c:1728
 msgid "CHAT: The channel needs a more unique name."
 msgstr ""
 
-#: extchat.c:1741
+#: extchat.c:1737
 msgid "You can't create channels of that type."
 msgstr ""
 
-#: extchat.c:1745
+#: extchat.c:1741
 msgid "Warning: channel will be created disabled."
 msgstr ""
 
-#: extchat.c:1748
+#: extchat.c:1744
 #, c-format
 msgid "You can't afford the %d %s."
 msgstr ""
 
-#: extchat.c:1755 extchat.c:1762
+#: extchat.c:1751 extchat.c:1758
 msgid "CHAT: No more memory for channels!"
 msgstr ""
 
-#: extchat.c:1774
+#: extchat.c:1770
 #, c-format
 msgid "CHAT: Channel <%s> created."
 msgstr ""
 
-#: extchat.c:1791
+#: extchat.c:1787
 msgid "Channel removed."
 msgstr ""
 
-#: extchat.c:1806
+#: extchat.c:1802
 msgid "The channel needs a more unique new name."
 msgstr ""
 
-#: extchat.c:1811
+#: extchat.c:1807
 msgid "That name is too long."
 msgstr ""
 
-#: extchat.c:1819
+#: extchat.c:1815
 #, c-format
 msgid "has renamed %s to %s."
 msgstr ""
 
-#: extchat.c:1823
+#: extchat.c:1819
 msgid "Channel renamed."
 msgstr ""
 
-#: extchat.c:1834
+#: extchat.c:1830
 msgid "You can't make channels that type."
 msgstr ""
 
-#: extchat.c:1838
+#: extchat.c:1834
 msgid "Warning: channel will be disabled."
 msgstr ""
 
-#: extchat.c:1842
+#: extchat.c:1838
 #, c-format
 msgid "Invalid or same permissions on channel <%s>. No changes made."
 msgstr ""
 
-#: extchat.c:1847
+#: extchat.c:1843
 #, c-format
 msgid "Permissions on channel <%s> changed."
 msgstr ""
 
-#: extchat.c:1909
+#: extchat.c:1905
 msgid "You are not on any channels."
 msgstr ""
 
-#: extchat.c:1915
+#: extchat.c:1911
 msgid "All channels have been muted."
 msgstr ""
 
-#: extchat.c:1916
+#: extchat.c:1912
 msgid "All channels have been unmuted."
 msgstr ""
 
-#: extchat.c:1919
+#: extchat.c:1915
 msgid "You hide on all the channels you can."
 msgstr ""
 
-#: extchat.c:1920
+#: extchat.c:1916
 msgid "You unhide on all channels."
 msgstr ""
 
-#: extchat.c:1923
+#: extchat.c:1919
 msgid "All channels have been gagged."
 msgstr ""
 
-#: extchat.c:1924
+#: extchat.c:1920
 msgid "All channels have been ungagged."
 msgstr ""
 
-#: extchat.c:1945 extchat.c:2039
+#: extchat.c:1941 extchat.c:2035
 #, c-format
 msgid "You are not on channel <%s>."
 msgstr ""
 
-#: extchat.c:1957
+#: extchat.c:1953
 #, c-format
 msgid "You will no longer hear connection messages on channel <%s>."
 msgstr ""
 
-#: extchat.c:1964
+#: extchat.c:1960
 #, c-format
 msgid "You will now hear connection messages on channel <%s>."
 msgstr ""
 
-#: extchat.c:1975
+#: extchat.c:1971
 #, c-format
 msgid "You are not permitted to hide on channel <%s>."
 msgstr ""
 
-#: extchat.c:1982
+#: extchat.c:1978
 #, c-format
 msgid "You no longer appear on channel <%s>'s who list."
 msgstr ""
 
-#: extchat.c:1989
+#: extchat.c:1985
 #, c-format
 msgid "You now appear on channel <%s>'s who list."
 msgstr ""
 
-#: extchat.c:2000
+#: extchat.c:1996
 #, c-format
 msgid "You will no longer hear messages on channel <%s>."
 msgstr ""
 
-#: extchat.c:2006
+#: extchat.c:2002
 #, c-format
 msgid "You will now hear messages on channel <%s>."
 msgstr ""
 
-#: extchat.c:2045
+#: extchat.c:2041
 #, c-format
 msgid "You have no title set on <%s>."
 msgstr ""
 
-#: extchat.c:2047
+#: extchat.c:2043
 #, c-format
 msgid "Your title on <%s> is '%s'."
 msgstr ""
 
-#: extchat.c:2056
+#: extchat.c:2052
 msgid "Title too long."
 msgstr ""
 
-#: extchat.c:2063
+#: extchat.c:2059
 msgid "Invalid character in title."
 msgstr ""
 
-#: extchat.c:2070
+#: extchat.c:2066
 #, c-format
 msgid "Title %s for %schannel <%s>."
 msgstr ""
 
-#: extchat.c:2098 flags.c:2012 malias.c:278
+#: extchat.c:2094 flags.c:2038 malias.c:278
 msgid "Name"
 msgstr ""
 
-#: extchat.c:2098
+#: extchat.c:2094
 msgid "Users"
 msgstr ""
 
-#: extchat.c:2098
+#: extchat.c:2094
 msgid "Msgs"
 msgstr ""
 
-#: extchat.c:2098
+#: extchat.c:2094
 msgid "Chan Type"
 msgstr ""
 
-#: extchat.c:2098
+#: extchat.c:2094
 msgid "Status"
 msgstr ""
 
-#: extchat.c:2099
+#: extchat.c:2095
 msgid "Buf"
 msgstr ""
 
-#: extchat.c:2148
+#: extchat.c:2144
 msgid "Gag"
 msgstr ""
 
-#: extchat.c:2148
+#: extchat.c:2144
 msgid "On"
 msgstr ""
 
-#: extchat.c:2148
+#: extchat.c:2144
 msgid "Off"
 msgstr ""
 
-#: extchat.c:2194 extchat.c:2241 extchat.c:2290 extchat.c:2346 extchat.c:2400
-#: extchat.c:2444
+#: extchat.c:2190 extchat.c:2237 extchat.c:2286 extchat.c:2342 extchat.c:2396
+#: extchat.c:2440
 msgid "#-1 NO CHANNEL GIVEN"
 msgstr ""
 
-#: extchat.c:2199 extchat.c:2206 extchat.c:2246 extchat.c:2253 extchat.c:2312
-#: extchat.c:2351 extchat.c:2363 extchat.c:2405 extchat.c:2417 extchat.c:2449
-#: extchat.c:3165 extchat.c:3252 extchat.c:3294
+#: extchat.c:2195 extchat.c:2202 extchat.c:2242 extchat.c:2249 extchat.c:2308
+#: extchat.c:2347 extchat.c:2359 extchat.c:2401 extchat.c:2413 extchat.c:2445
+#: extchat.c:3166 extchat.c:3253 extchat.c:3295
 msgid "#-1 NO SUCH CHANNEL"
 msgstr ""
 
-#: extchat.c:2202 extchat.c:2249 extchat.c:2315 extchat.c:2354 extchat.c:2408
-#: extchat.c:2452
+#: extchat.c:2198 extchat.c:2245 extchat.c:2311 extchat.c:2350 extchat.c:2404
+#: extchat.c:2448
 msgid "#-1 AMBIGUOUS CHANNEL NAME"
 msgstr ""
 
-#: extchat.c:2227 extchat.c:2371
+#: extchat.c:2223 extchat.c:2367
 msgid "#-1 NOT ON CHANNEL"
 msgstr ""
 
-#: extchat.c:2295
+#: extchat.c:2291
 msgid "#-1 NO TEXT GIVEN"
 msgstr ""
 
-#: extchat.c:2323
+#: extchat.c:2319
 msgid "#-1 CHANNEL DOES NOT HAVE A BUFFER"
 msgstr ""
 
-#: extchat.c:2476
+#: extchat.c:2472
 #, c-format
 msgid "CHAT: %s has removed all users from <%s>."
 msgstr ""
 
-#: extchat.c:2499
+#: extchat.c:2495
 msgid "CHAT: Wipe that silly grin off your face instead."
 msgstr ""
 
-#: extchat.c:2504
+#: extchat.c:2500
 #, c-format
 msgid "CHAT: Channel <%s> wiped."
 msgstr ""
 
-#: extchat.c:2526
+#: extchat.c:2522
 msgid "CHAT: Only a channel modifier can do that."
 msgstr ""
 
-#: extchat.c:2534 extchat.c:3131 match.c:479 set.c:580
+#: extchat.c:2530 extchat.c:3132 match.c:480 set.c:585
 msgid "I can't see that here."
 msgstr ""
 
-#: extchat.c:2536 extchat.c:3133
+#: extchat.c:2532 extchat.c:3134
 msgid "I don't know which thing you mean."
 msgstr ""
 
-#: extchat.c:2541
+#: extchat.c:2537
 #, c-format
 msgid "CHAT: Channel <%s> no longer mogrified by %s."
 msgstr ""
 
-#: extchat.c:2547
+#: extchat.c:2543
 #, c-format
 msgid "CHAT: Channel <%s> isn't being mogrified."
 msgstr ""
 
-#: extchat.c:2553
+#: extchat.c:2549
 msgid "CHAT: You must control the mogrifier."
 msgstr ""
 
-#: extchat.c:2558
+#: extchat.c:2554
 #, c-format
 msgid "CHAT: Channel <%s> now mogrified by %s."
 msgstr ""
 
-#: extchat.c:2579
+#: extchat.c:2575
 msgid "CHAT: Only a Wizard can do that."
 msgstr ""
 
-#: extchat.c:2586
+#: extchat.c:2582
 msgid "CHAT: Invalid owner."
 msgstr ""
 
-#: extchat.c:2594
+#: extchat.c:2590
 #, c-format
 msgid "CHAT: Channel <%s> now owned by %s."
 msgstr ""
 
-#: extchat.c:2648
+#: extchat.c:2644
 #, c-format
 msgid "CHAT: Channel <%s> resists."
 msgstr ""
 
-#: extchat.c:2678
+#: extchat.c:2674
 msgid "CHAT: I don't understand that key."
 msgstr ""
 
-#: extchat.c:2687
+#: extchat.c:2683
 #, c-format
 msgid "CHAT: Joinlock on <%s> reset."
 msgstr ""
 
-#: extchat.c:2688
+#: extchat.c:2684
 #, c-format
 msgid "CHAT: Joinlock on <%s> set."
 msgstr ""
 
-#: extchat.c:2694
+#: extchat.c:2690
 #, c-format
 msgid "CHAT: Speaklock on <%s> reset."
 msgstr ""
 
-#: extchat.c:2695
+#: extchat.c:2691
 #, c-format
 msgid "CHAT: Speaklock on <%s> set."
 msgstr ""
 
-#: extchat.c:2701
+#: extchat.c:2697
 #, c-format
 msgid "CHAT: Seelock on <%s> reset."
 msgstr ""
 
-#: extchat.c:2702
+#: extchat.c:2698
 #, c-format
 msgid "CHAT: Seelock on <%s> set."
 msgstr ""
 
-#: extchat.c:2708
+#: extchat.c:2704
 #, c-format
 msgid "CHAT: Hidelock on <%s> reset."
 msgstr ""
 
-#: extchat.c:2709
+#: extchat.c:2705
 #, c-format
 msgid "CHAT: Hidelock on <%s> set."
 msgstr ""
 
-#: extchat.c:2715
+#: extchat.c:2711
 #, c-format
 msgid "CHAT: Modlock on <%s> reset."
 msgstr ""
 
-#: extchat.c:2716
+#: extchat.c:2712
 #, c-format
 msgid "CHAT: Modlock on <%s> set."
 msgstr ""
 
-#: extchat.c:2743
+#: extchat.c:2739
 #, c-format
 msgid "Description: %s"
 msgstr ""
 
-#: extchat.c:2744
+#: extchat.c:2740
 #, c-format
 msgid "Owner: %s"
 msgstr ""
 
-#: extchat.c:2746
+#: extchat.c:2742
 #, c-format
 msgid "Mogrifier: %s (#%d)"
 msgstr ""
 
-#: extchat.c:2749
+#: extchat.c:2745
 #, c-format
 msgid "Flags: %s"
 msgstr ""
 
-#: extchat.c:2753
+#: extchat.c:2749
 #, c-format
 msgid "Recall buffer: %dk, with %d lines stored."
 msgstr ""
 
-#: extchat.c:2792
+#: extchat.c:2788
 #, c-format
 msgid "CHAT: You don't have permission to decompile <%s>."
 msgstr ""
 
-#: extchat.c:2836
+#: extchat.c:2837
 msgid "CHAT: No channel matches that string."
 msgstr ""
 
-#: extchat.c:2853 look.c:204 speech.c:362 speech.c:968
+#: extchat.c:2854 look.c:204 speech.c:373 speech.c:992
 msgid "and"
 msgstr ""
 
-#: extchat.c:2867
+#: extchat.c:2868
 msgid "There are no connected players on that channel."
 msgstr ""
 
-#: extchat.c:2869
+#: extchat.c:2870
 #, c-format
 msgid "Members of channel <%s> are:"
 msgstr ""
 
-#: extchat.c:2891
+#: extchat.c:2892
 msgid "I can't tell which channel you mean."
 msgstr ""
 
-#: extchat.c:2905 function.c:864
+#: extchat.c:2906 function.c:864
 msgid "#-1 INVALID ARGUMENT"
 msgstr ""
 
-#: extchat.c:2927
+#: extchat.c:2928
 msgid "#-1 NO PERMISSIONS FOR CHANNEL"
 msgstr ""
 
-#: extchat.c:2970
+#: extchat.c:2971
 msgid "CHAT: New description too long."
 msgstr ""
 
-#: extchat.c:2983
+#: extchat.c:2984
 #, c-format
 msgid "CHAT: Channel <%s> description cleared."
 msgstr ""
 
-#: extchat.c:2987
+#: extchat.c:2988
 #, c-format
 msgid "CHAT: Channel <%s> description set."
 msgstr ""
 
-#: extchat.c:3078
+#: extchat.c:3079
 msgid "Channels:"
 msgstr ""
 
-#: extchat.c:3084
+#: extchat.c:3085
 msgid "Channels: *NONE*"
 msgstr ""
 
-#: extchat.c:3168
+#: extchat.c:3169
 msgid "#-2 AMBIGUOUS CHANNEL MATCH"
 msgstr ""
 
-#: extchat.c:3190
+#: extchat.c:3191
 msgid "#-1 NO SUCH LOCK TYPE"
 msgstr ""
 
-#: extchat.c:3305
+#: extchat.c:3306
 msgid "#-1 NO RECALL BUFFER"
 msgstr ""
 
-#: extchat.c:3440
+#: extchat.c:3441
 msgid "You must specify a type of lock!"
 msgstr ""
 
-#: extchat.c:3716
+#: extchat.c:3717
 #, c-format
 msgid "To channel %s: %s"
 msgstr ""
 
-#: extchat.c:3756
+#: extchat.c:3757
 msgid "Which line do you want to start recall from?"
 msgstr ""
 
-#: extchat.c:3770 extchat.c:3778
+#: extchat.c:3771 extchat.c:3779
 msgid "How many lines did you want to recall?"
 msgstr ""
 
-#: extchat.c:3795
+#: extchat.c:3796
 msgid "CHAT: You must be able to join a channel to recall from it."
 msgstr ""
 
-#: extchat.c:3799
+#: extchat.c:3800
 msgid "CHAT: That channel doesn't have a recall buffer."
 msgstr ""
 
@@ -2530,7 +2535,7 @@
 msgid "CHAT: Buffering enabled on channel <%s>."
 msgstr ""
 
-#: extmail.c:222 extmail.c:1113
+#: extmail.c:222 extmail.c:1168
 msgid "(no subject)"
 msgstr ""
 
@@ -2579,70 +2584,96 @@
 msgid "MAIL: Folder %d now has no name"
 msgstr ""
 
-#: extmail.c:426
+#: extmail.c:409
+msgid "MAIL: What do you want to do with the messages?"
+msgstr ""
+
+#: extmail.c:420
+msgid "MAIL: Unknown status."
+msgstr ""
+
+#: extmail.c:468
 msgid "MAIL: All messages in all folders untagged."
 msgstr ""
 
-#: extmail.c:428
+#: extmail.c:470
 msgid "MAIL: All messages in all folders tagged."
 msgstr ""
 
-#: extmail.c:433
+#: extmail.c:475
 #, c-format
 msgid "MAIL: Msg #%d:%d untagged"
 msgstr ""
 
-#: extmail.c:436
+#: extmail.c:478
 #, c-format
 msgid "MAIL: Msg #%d:%d tagged"
 msgstr ""
 
-#: extmail.c:445
+#: extmail.c:488
 msgid "MAIL: All messages in all folders uncleared."
 msgstr ""
 
-#: extmail.c:447
+#: extmail.c:490
 msgid "MAIL: All messages in all folders cleared."
 msgstr ""
 
-#: extmail.c:455
+#: extmail.c:498
 #, c-format
 msgid "MAIL: Unread Msg #%d:%d cleared! Use @mail/unclear %d:%d to recover."
 msgstr ""
 
-#: extmail.c:460
+#: extmail.c:503
 #, c-format
 msgid "MAIL: Msg #%d:%d uncleared."
 msgstr ""
 
-#: extmail.c:461
+#: extmail.c:504
 #, c-format
 msgid "MAIL: Msg #%d:%d cleared."
 msgstr ""
 
-#: extmail.c:472 extmail.c:531
+#: extmail.c:513
+msgid "MAIL: All messages in all folders unread."
+msgstr ""
+
+#: extmail.c:515
+msgid "MAIL: All messages in all folders marked as read."
+msgstr ""
+
+#: extmail.c:521
+#, c-format
+msgid "MAIL: Msg #%d:%d unread"
+msgstr ""
+
+#: extmail.c:523
+#, c-format
+msgid "MAIL: Msg #%d:%d marked as read"
+msgstr ""
+
+#: extmail.c:533 extmail.c:591
 msgid "MAIL: You don't have any matching messages!"
 msgstr ""
 
-#: extmail.c:499
+#: extmail.c:560
 msgid "MAIL: Invalid folder specification"
 msgstr ""
 
-#: extmail.c:517
+#: extmail.c:577
 #, c-format
 msgid "MAIL: All messages filed in folder %d [%s]"
 msgstr ""
 
-#: extmail.c:523
+#: extmail.c:583
 #, c-format
 msgid "MAIL: Msg %d:%d filed in folder %d [%s]"
 msgstr ""
 
-#: extmail.c:570 extmail.c:572
+#: extmail.c:629 extmail.c:631
 msgid "Folder:"
 msgstr ""
 
-#: extmail.c:577
+#: extmail.c:636
 #, c-format
 msgid ""
 "From: %-55s %s\n"
@@ -2650,616 +2681,643 @@
 "Status: %s"
 msgstr ""
 
-#: extmail.c:581
+#: extmail.c:640
 msgid " (Conn)"
 msgstr ""
 
-#: extmail.c:584
+#: extmail.c:643
 #, c-format
 msgid "Subject: %s"
 msgstr ""
 
-#: extmail.c:601
+#: extmail.c:660
 msgid "MAIL: You don't have that many matching messages!"
 msgstr ""
 
-#: extmail.c:633
+#: extmail.c:689
 #, c-format
 msgid ""
 "---------------------------  MAIL (folder %2d)  "
 "------------------------------"
 msgstr ""
 
-#: extmail.c:740
+#: extmail.c:796
 msgid "MAIL: Mailbox purged."
 msgstr ""
 
-#: extmail.c:773
+#: extmail.c:829
 msgid "MAIL: To whom should I forward?"
 msgstr ""
 
-#: extmail.c:783
+#: extmail.c:839
 msgid "MAIL: You have no messages to forward."
 msgstr ""
 
-#: extmail.c:804
+#: extmail.c:860
 msgid "MAIL: You can't reply to nonexistant mail."
 msgstr ""
 
-#: extmail.c:820 extmail.c:923
+#: extmail.c:876 extmail.c:979
 #, c-format
 msgid "No such unique player: %s."
 msgstr ""
 
-#: extmail.c:835
+#: extmail.c:891
 #, c-format
 msgid "MAIL: %d messages forwarded."
 msgstr ""
 
-#: extmail.c:861
+#: extmail.c:917
 msgid "MAIL: I can't figure out who you want to mail to."
 msgstr ""
 
-#: extmail.c:865
+#: extmail.c:921
 msgid "MAIL: I can't figure out what you want to send."
 msgstr ""
 
-#: extmail.c:903
+#: extmail.c:959
 msgid "MAIL: You can't reply to nonexistent mail."
 msgstr ""
 
-#: extmail.c:1038
+#: extmail.c:1093
 #, c-format
 msgid "Failed attempt to forward @mail to #%d"
 msgstr ""
 
-#: extmail.c:1047 extmail.c:1189
+#: extmail.c:1102 extmail.c:1244
 #, c-format
 msgid "MAIL: You sent your message to %s."
 msgstr ""
 
-#: extmail.c:1051
+#: extmail.c:1106
 #, c-format
 msgid "MAIL: Your message was not sent to %s due to a mail forwarding problem."
 msgstr ""
 
-#: extmail.c:1073
+#: extmail.c:1128
 msgid "MAIL: You cannot send mail to non-existent people."
 msgstr ""
 
-#: extmail.c:1078
+#: extmail.c:1133
 msgid "MAIL: You probably don't wanna send mail saying 'clear'."
 msgstr ""
 
-#: extmail.c:1084
+#: extmail.c:1139
 #, c-format
 msgid "MAIL: %s is not accepting mail from you right now."
 msgstr ""
 
-#: extmail.c:1091
+#: extmail.c:1146
 #, c-format
 msgid "MAIL: %s's mailbox is full. Can't send."
 msgstr ""
 
-#: extmail.c:1191
+#: extmail.c:1246
 #, c-format
 msgid "MAIL: You have a new message (%d) from %s."
 msgstr ""
 
-#: extmail.c:1214
+#: extmail.c:1269
 msgid "The postal service issues a warrant for your arrest."
 msgstr ""
 
-#: extmail.c:1231
+#: extmail.c:1286
 msgid "You annihilate the post office. All messages cleared."
 msgstr ""
 
-#: extmail.c:1248
+#: extmail.c:1303
 msgid "Go get some bugspray."
 msgstr ""
 
-#: extmail.c:1254 extmail.c:1352 extmail.c:1747 wiz.c:726
+#: extmail.c:1310 extmail.c:1410 extmail.c:1810 wiz.c:728
 #, c-format
 msgid "%s: No such player."
 msgstr ""
 
-#: extmail.c:1259
+#: extmail.c:1315
 #, c-format
 msgid "Mail cleared for %s(#%d)."
 msgstr ""
 
-#: extmail.c:1264
+#: extmail.c:1320
 #, c-format
 msgid "Bad object #%d has mail."
 msgstr ""
 
-#: extmail.c:1266
+#: extmail.c:1322
 #, c-format
 msgid "%s(#%d) has mail but is not a player."
 msgstr ""
 
-#: extmail.c:1272
+#: extmail.c:1328
 #, c-format
 msgid "Mail database top is %d, actual message count is %d. Fixing."
 msgstr ""
 
-#: extmail.c:1276
+#: extmail.c:1332
 msgid "Mail sanity check completed."
 msgstr ""
 
-#: extmail.c:1280
+#: extmail.c:1336
 #, c-format
 msgid "Fixing mail for #%d."
 msgstr ""
 
-#: extmail.c:1311
+#: extmail.c:1367
 msgid "Mail sanity fix completed."
 msgstr ""
 
-#: extmail.c:1313
+#: extmail.c:1369
 msgid "That is not a debugging option."
 msgstr ""
 
-#: extmail.c:1356 extmail.c:1751
+#: extmail.c:1414 extmail.c:1814
 msgid "The post office protects privacy!"
 msgstr ""
 
-#: extmail.c:1364
+#: extmail.c:1422
 #, c-format
 msgid "There are %d messages in the mail spool."
 msgstr ""
 
-#: extmail.c:1377
+#: extmail.c:1435
 #, c-format
 msgid "MAIL: There are %d msgs in the mail spool, %d unread, %d cleared."
 msgstr ""
 
-#: extmail.c:1395
+#: extmail.c:1453
 #, c-format
 msgid "MAIL: There are %d old msgs in the mail spool, totalling %d characters."
 msgstr ""
 
-#: extmail.c:1399
+#: extmail.c:1457
 #, c-format
 msgid "MAIL: There are %d new msgs in the mail spool, totalling %d characters."
 msgstr ""
 
-#: extmail.c:1403
+#: extmail.c:1461
 #, c-format
 msgid ""
 "MAIL: There are %d cleared msgs in the mail spool, totalling %d characters."
 msgstr ""
 
-#: extmail.c:1418
+#: extmail.c:1476
 #, c-format
 msgid "%s sent %d messages."
 msgstr ""
 
-#: extmail.c:1419
+#: extmail.c:1477
 #, c-format
 msgid "%s has %d messages."
 msgstr ""
 
-#: extmail.c:1448
+#: extmail.c:1506
 #, c-format
 msgid "Mail statistics for %s:"
 msgstr ""
 
-#: extmail.c:1451
+#: extmail.c:1509
 #, c-format
 msgid "%d messages sent, %d unread, %d cleared."
 msgstr ""
 
-#: extmail.c:1453
+#: extmail.c:1511
 #, c-format
 msgid "%d messages received, %d unread, %d cleared."
 msgstr ""
 
-#: extmail.c:1458
+#: extmail.c:1516
 #, c-format
 msgid "%d messages sent, %d unread, %d cleared, totalling %d characters."
 msgstr ""
 
-#: extmail.c:1462
+#: extmail.c:1520
 #, c-format
 msgid "%d messages received, %d unread, %d cleared, totalling %d characters."
 msgstr ""
 
-#: extmail.c:1467
+#: extmail.c:1525
 #, c-format
 msgid "Last is dated %s"
 msgstr ""
 
-#: extmail.c:1492
+#: extmail.c:1550
 msgid "MAIL: Invalid mail command."
 msgstr ""
 
-#: extmail.c:1555 extmail.c:1571 funcrypt.c:332
+#: extmail.c:1614 extmail.c:1631 funcrypt.c:332
 msgid "#-1 NO SUCH PLAYER"
 msgstr ""
 
-#: extmail.c:1578
+#: extmail.c:1638
 msgid "#-1 FOLDER MUST BE INTEGER"
 msgstr ""
 
-#: extmail.c:1638
+#: extmail.c:1698
 msgid "#-1 INVALID MESSAGE OR PLAYER"
 msgstr ""
 
-#: extmail.c:1668
+#: extmail.c:1729
 msgid "Permission denied"
 msgstr ""
 
-#: extmail.c:1674
+#: extmail.c:1735
 msgid "Invalid message specification"
 msgstr ""
 
-#: extmail.c:1727
+#: extmail.c:1788
 msgid "#-? fun_mailstats called with invalid called_as!"
 msgstr ""
 
-#: extmail.c:2420 extmail.c:2517
+#: extmail.c:2483 extmail.c:2580
 msgid "MAIL: Invalid message specification"
 msgstr ""
 
-#: extmail.c:2428 extmail.c:2438 extmail.c:2445 extmail.c:2455 extmail.c:2462
-#: extmail.c:2472
+#: extmail.c:2491 extmail.c:2501 extmail.c:2508 extmail.c:2518 extmail.c:2525
+#: extmail.c:2535
 msgid "MAIL: Invalid age"
 msgstr ""
 
-#: extmail.c:2432 extmail.c:2449 extmail.c:2466
+#: extmail.c:2495 extmail.c:2512 extmail.c:2529
 msgid "MAIL: Message ages must be integers"
 msgstr ""
 
-#: extmail.c:2478 extmail.c:2483
+#: extmail.c:2541 extmail.c:2546
 msgid "MAIL: Invalid dbref #"
 msgstr ""
 
-#: extmail.c:2490 extmail.c:2495
+#: extmail.c:2553 extmail.c:2558
 msgid "MAIL: Invalid player"
 msgstr ""
 
-#: extmail.c:2551
+#: extmail.c:2614
 msgid "Read "
 msgstr ""
 
-#: extmail.c:2553
+#: extmail.c:2616
 msgid "Unread "
 msgstr ""
 
-#: extmail.c:2555
+#: extmail.c:2618
 msgid "Cleared "
 msgstr ""
 
-#: extmail.c:2557
+#: extmail.c:2620
 msgid "Urgent "
 msgstr ""
 
-#: extmail.c:2559
+#: extmail.c:2622
 msgid "Mass "
 msgstr ""
 
-#: extmail.c:2561
+#: extmail.c:2624
 msgid "Fwd "
 msgstr ""
 
-#: extmail.c:2563
+#: extmail.c:2626
 msgid "Tagged"
 msgstr ""
 
-#: extmail.c:2589 extmail.c:2623
+#: extmail.c:2652 extmail.c:2686
 #, c-format
 msgid "MAIL: %d messages in folder %d [%s] (%d unread, %d cleared)."
 msgstr ""
 
-#: extmail.c:2594 extmail.c:2628
+#: extmail.c:2657 extmail.c:2691
 #, c-format
 msgid "MAIL: Warning! Limit on inbox messages is %d!"
 msgstr ""
 
-#: extmail.c:2600 extmail.c:2626
+#: extmail.c:2663 extmail.c:2689
 msgid ""
 "\n"
 "MAIL: You have no mail.\n"
 msgstr ""
 
-#: extmail.c:2772
+#: extmail.c:2835
 #, c-format
 msgid "You sent your message to the '%s' alias"
 msgstr ""
 
-#: flags.c:1333
+#: flags.c:1334
 msgid "You can't make admin into guests."
 msgstr ""
 
-#: flags.c:1363
+#: flags.c:1364
 msgid "You must @lock/zone before you can set a player ZONE"
 msgstr ""
 
-#: flags.c:1452
+#: flags.c:1453
 msgid "Type: "
 msgstr ""
 
-#: flags.c:1454
+#: flags.c:1455
 msgid " Flags: "
 msgstr ""
 
-#: flags.c:1531
+#: flags.c:1534 flags.c:1697
+#, c-format
+msgid "Internal error: Unable to find flagspace '%s'!"
+msgstr ""
+
+#: flags.c:1538
 #, c-format
 msgid "%s - I don't recognize that flag."
 msgstr ""
 
-#: flags.c:1557 flags.c:1566
+#: flags.c:1564 flags.c:1573
 #, c-format
 msgid "%s is no longer listening."
 msgstr ""
 
-#: flags.c:1575
+#: flags.c:1582
 #, c-format
 msgid "Exit %s is no longer broadcasting."
 msgstr ""
 
-#: flags.c:1583
+#: flags.c:1590
 msgid "Audible exits in this room have been deactivated."
 msgstr ""
 
-#: flags.c:1589
+#: flags.c:1596
 msgid "This room is no longer broadcasting."
 msgstr ""
 
-#: flags.c:1590
+#: flags.c:1597
 msgid "Your contents can no longer be heard from outside."
 msgstr ""
 
-#: flags.c:1600 flags.c:1661
+#: flags.c:1607 flags.c:1668
 msgid " (already)"
 msgstr ""
 
-#: flags.c:1601
+#: flags.c:1608
 msgid " reset."
 msgstr ""
 
-#: flags.c:1611
+#: flags.c:1618
 msgid "Warning: Setting trust flag on zoned object"
 msgstr ""
 
-#: flags.c:1618 flags.c:1627
+#: flags.c:1625 flags.c:1634
 #, c-format
 msgid "%s is now listening."
 msgstr ""
 
-#: flags.c:1637
+#: flags.c:1644
 #, c-format
 msgid "Exit %s is now broadcasting."
 msgstr ""
 
-#: flags.c:1645
+#: flags.c:1652
 msgid "Audible exits in this room have been activated."
 msgstr ""
 
-#: flags.c:1650
+#: flags.c:1657
 msgid "This room is now broadcasting."
 msgstr ""
 
-#: flags.c:1651
+#: flags.c:1658
 msgid "Your contents can now be heard from outside."
 msgstr ""
 
-#: flags.c:1662
+#: flags.c:1669
 msgid " set."
 msgstr ""
 
-#: flags.c:1689
+#: flags.c:1702
 #, c-format
 msgid "%s - I don't recognize that power."
 msgstr ""
 
-#: flags.c:1705
-msgid " removed."
+#: flags.c:1719
+#, c-format
+msgid "%s - %s removed."
 msgstr ""
 
-#: flags.c:1705
-msgid " granted."
+#: flags.c:1721
+#, c-format
+msgid "%s - %s (already) removed."
 msgstr ""
 
-#: flags.c:1711
+#: flags.c:1726
+#, c-format
+msgid "%s - %s (already) granted."
+msgstr ""
+
+#: flags.c:1729
+#, c-format
+msgid "%s - %s granted."
+msgstr ""
+
+#: flags.c:1738
 msgid "CLEARED"
 msgstr ""
 
-#: flags.c:1711
+#: flags.c:1738
 msgid "SET"
 msgstr ""
 
-#: flags.c:2009 flags.c:2050 flags.c:2113
+#: flags.c:2035 flags.c:2076 flags.c:2139
 #, c-format
 msgid "No such %s."
 msgstr ""
 
-#: flags.c:2013
+#: flags.c:2039
 msgid "Character"
 msgstr ""
 
-#: flags.c:2014
+#: flags.c:2040
 msgid "Aliases"
 msgstr ""
 
-#: flags.c:2015
+#: flags.c:2041
 msgid "Type(s)"
 msgstr ""
 
-#: flags.c:2017
+#: flags.c:2043
 msgid "Perms"
 msgstr ""
 
-#: flags.c:2019
+#: flags.c:2045
 msgid "ResetPrms"
 msgstr ""
 
-#: flags.c:2045 flags.c:2108 flags.c:2174
+#: flags.c:2071 flags.c:2134 flags.c:2200
 msgid "You don't have enough magic for that."
 msgstr ""
 
-#: flags.c:2054
+#: flags.c:2080
 #, c-format
 msgid "How do you want to restrict that %s?"
 msgstr ""
 
-#: flags.c:2082
+#: flags.c:2108
 #, c-format
 msgid "Permissions on %s %s set."
 msgstr ""
 
-#: flags.c:2117
+#: flags.c:2143
 #, c-format
 msgid "What type do you want to make that %s?"
 msgstr ""
 
-#: flags.c:2126 flags.c:2214
+#: flags.c:2152 flags.c:2240
 msgid "I don't understand the list of types."
 msgstr ""
 
-#: flags.c:2136
+#: flags.c:2162
 #, c-format
 msgid ""
 "Objects of other types already have this %s set. Search for them and remove "
 "it first."
 msgstr ""
 
-#: flags.c:2143
+#: flags.c:2169
 #, c-format
 msgid "Type of %s %s set."
 msgstr ""
 
-#: flags.c:2178
+#: flags.c:2204
 #, c-format
 msgid "You must provide a name for the %s."
 msgstr ""
 
-#: flags.c:2183
+#: flags.c:2209
 #, c-format
 msgid "%s names must be longer than one character."
 msgstr ""
 
-#: flags.c:2188
+#: flags.c:2214
 #, c-format
 msgid "%s names may not contain spaces."
 msgstr ""
 
-#: flags.c:2193
+#: flags.c:2219
 #, c-format
 msgid "That's not a valid %s name."
 msgstr ""
 
-#: flags.c:2199
+#: flags.c:2225
 msgid "You must provide more information."
 msgstr ""
 
-#: flags.c:2204 flags.c:2401
+#: flags.c:2230 flags.c:2432
 #, c-format
 msgid "%s characters must be single characters."
 msgstr ""
 
-#: flags.c:2221 flags.c:2407
+#: flags.c:2247 flags.c:2438
 #, c-format
 msgid "Letter conflicts with the %s %s."
 msgstr ""
 
-#: flags.c:2257
+#: flags.c:2283
 #, c-format
 msgid "Unknown failure adding %s."
 msgstr ""
 
-#: flags.c:2276 flags.c:2388 flags.c:2440 flags.c:2479 flags.c:2536
+#: flags.c:2302 flags.c:2419 flags.c:2471 flags.c:2510 flags.c:2571
 msgid "You don't look like God."
 msgstr ""
 
-#: flags.c:2280
+#: flags.c:2306
 msgid "You must provide a name for the alias."
 msgstr ""
 
-#: flags.c:2288
+#: flags.c:2314
 #, c-format
 msgid "%s aliases must be longer than one character."
 msgstr ""
 
-#: flags.c:2293
+#: flags.c:2319
 #, c-format
 msgid "%s aliases may not contain spaces."
 msgstr ""
 
-#: flags.c:2300
+#: flags.c:2325
+#, c-format
+msgid "Internal error: Unknown flag space '%s'!"
+msgstr ""
+
+#: flags.c:2331
 #, c-format
 msgid "That alias already matches the %s %s."
 msgstr ""
 
-#: flags.c:2306 flags.c:2394 flags.c:2446 flags.c:2485 flags.c:2542
+#: flags.c:2337 flags.c:2425 flags.c:2477 flags.c:2520 flags.c:2577
 #, c-format
 msgid "I don't know that %s."
 msgstr ""
 
-#: flags.c:2310
+#: flags.c:2341
 #, c-format
 msgid "That %s is disabled."
 msgstr ""
 
-#: flags.c:2314
+#: flags.c:2345
 #, c-format
 msgid "That isn't an alias of the %s %s."
 msgstr ""
 
-#: flags.c:2321
+#: flags.c:2352
 #, c-format
 msgid "That's the %s's name, not an alias."
 msgstr ""
 
-#: flags.c:2327
+#: flags.c:2358
 msgid "Unknown failure deleting alias."
 msgstr ""
 
-#: flags.c:2335
+#: flags.c:2366
 msgid "Unknown failure adding alias."
 msgstr ""
 
-#: flags.c:2413
+#: flags.c:2444
 #, c-format
 msgid "Letter for %s %s set to '%c'."
 msgstr ""
 
-#: flags.c:2417
+#: flags.c:2448
 #, c-format
 msgid "Letter for %s %s cleared."
 msgstr ""
 
-#: flags.c:2450
+#: flags.c:2481
 #, c-format
 msgid "That %s is already disabled."
 msgstr ""
 
-#: flags.c:2455
+#: flags.c:2486
 #, c-format
 msgid "%s %s disabled."
 msgstr ""
 
-#: flags.c:2489
+#: flags.c:2515
+#, c-format
+msgid "Internal error: Unknown flagspace '%s'!"
+msgstr ""
+
+#: flags.c:2524
 msgid "There are probably easier ways to crash your MUSH."
 msgstr ""
 
-#: flags.c:2515
+#: flags.c:2550
 #, c-format
 msgid "%s %s deleted."
 msgstr ""
 
-#: flags.c:2546
+#: flags.c:2581
 #, c-format
 msgid "That %s is not disabled."
 msgstr ""
 
-#: flags.c:2551
+#: flags.c:2586
 #, c-format
 msgid "%s %s enabled."
 msgstr ""
 
-#: flags.c:2623
+#: flags.c:2658
 msgid " (disabled)"
 msgstr ""
 
@@ -3288,153 +3346,153 @@
 msgid "Functions: %s"
 msgstr ""
 
-#: function.c:1041 function.c:1080
+#: function.c:1041 function.c:1079
 msgid "There's already a function with that name."
 msgstr ""
 
-#: function.c:1046 function.c:1086 function.c:1436
+#: function.c:1046 function.c:1085 function.c:1524
 msgid "Invalid function name."
 msgstr ""
 
-#: function.c:1052 function.c:1583
+#: function.c:1052 function.c:1671
 msgid "That's not a builtin function."
 msgstr ""
 
-#: function.c:1059
+#: function.c:1058
 msgid "Function cloned."
 msgstr ""
 
-#: function.c:1094 function.c:1304 function.c:1622 function.c:1670
-#: function.c:1703
+#: function.c:1093 function.c:1303 function.c:1710 function.c:1758
+#: function.c:1791
 msgid "No such function."
 msgstr ""
 
-#: function.c:1101
+#: function.c:1100
 msgid "You cannot alias @functions."
 msgstr ""
 
-#: function.c:1108
+#: function.c:1107
 msgid "Alias added."
 msgstr ""
 
-#: function.c:1295
+#: function.c:1294
 msgid "Restrict what function?"
 msgstr ""
 
-#: function.c:1299
+#: function.c:1298
 msgid "Do what with the function?"
 msgstr ""
 
-#: function.c:1310
+#: function.c:1309
 msgid "Builtin function"
 msgstr ""
 
-#: function.c:1315
+#: function.c:1314
 msgid "Restrictions unchanged."
 msgstr ""
 
-#: function.c:1317
+#: function.c:1316
 msgid "Restrictions modified."
 msgstr ""
 
-#: function.c:1372
+#: function.c:1460
 msgid "No global user-defined functions exist."
 msgstr ""
 
-#: function.c:1383
+#: function.c:1471
 msgid "Function Name                   Dbref #    Attrib"
 msgstr ""
 
-#: function.c:1401
+#: function.c:1489
 msgid "User functions:"
 msgstr ""
 
-#: function.c:1430
+#: function.c:1518
 msgid "You must specify an object and an attribute."
 msgstr ""
 
-#: function.c:1447
+#: function.c:1535
 msgid "No permission to control object."
 msgstr ""
 
-#: function.c:1451
+#: function.c:1539
 msgid "No permission to examine object."
 msgstr ""
 
-#: function.c:1465
+#: function.c:1553
 msgid "Expected between 1 and 5 arguments."
 msgstr ""
 
-#: function.c:1501
+#: function.c:1589
 msgid "Function added."
 msgstr ""
 
-#: function.c:1506
+#: function.c:1594
 msgid "You cannot change that built-in function."
 msgstr ""
 
-#: function.c:1539
+#: function.c:1627
 msgid "Function updated."
 msgstr ""
 
-#: function.c:1576
+#: function.c:1664
 msgid "Restore what?"
 msgstr ""
 
-#: function.c:1588
+#: function.c:1676
 msgid "That function isn't deleted!"
 msgstr ""
 
-#: function.c:1593
+#: function.c:1681
 msgid "Restored."
 msgstr ""
 
-#: function.c:1629
+#: function.c:1717
 msgid "Function alias deleted."
 msgstr ""
 
-#: function.c:1633 function.c:1642
+#: function.c:1721 function.c:1730
 msgid "You can't delete that @function."
 msgstr ""
 
-#: function.c:1637 function.c:1647
+#: function.c:1725 function.c:1735
 msgid "Function deleted."
 msgstr ""
 
-#: function.c:1675
+#: function.c:1763
 msgid "You can't disable aliases."
 msgstr ""
 
-#: function.c:1736
+#: function.c:1824
 #, c-format
 msgid "Name      : %s() (%s%s)"
 msgstr ""
 
-#: function.c:1836
+#: function.c:1923
 #, c-format
 msgid "Flags     : %s"
 msgstr ""
 
-#: function.c:1840
+#: function.c:1927
 #, c-format
 msgid "Location  : #%d/%s\n"
 msgstr ""
 
-#: function.c:1848
+#: function.c:1935
 msgid "(Commas okay in last argument)"
 msgstr ""
 
-#: function.c:1854
+#: function.c:1941
 #, c-format
 msgid "Arguments : %d %s"
 msgstr ""
 
-#: function.c:1856
+#: function.c:1943
 #, c-format
 msgid "Arguments : At least %d %s"
 msgstr ""
 
-#: function.c:1859
+#: function.c:1946
 #, c-format
 msgid "Arguments : %d to %d %s"
 msgstr ""
@@ -3443,122 +3501,126 @@
 msgid "#-1 ATTRIBUTE LENGTH TOO LONG"
 msgstr ""
 
-#: fundb.c:213
+#: fundb.c:217
 #, c-format
 msgid "#-1 BAD ARGUMENT FORMAT TO %s"
 msgstr ""
 
-#: fundb.c:251
+#: fundb.c:255
 msgid "#-1 BAD ARGUMENT FORMAT TO GET"
 msgstr ""
 
-#: fundb.c:361
+#: fundb.c:365
 msgid "#-1 BAD ARGUMENT FORMAT TO GET_EVAL"
 msgstr ""
 
-#: fundb.c:855 game.c:1558
+#: fundb.c:890 game.c:1594
 msgid "#-1 INVALID LOCATION"
 msgstr ""
 
-#: fundb.c:959
+#: fundb.c:994
 msgid "#-1 NO OBJECTS CONTROLLED"
 msgstr ""
 
-#: fundb.c:977 fundb.c:1442
+#: fundb.c:1012 fundb.c:1477
 msgid "#-1 ARG1 NOT FOUND"
 msgstr ""
 
-#: fundb.c:985 fundb.c:1444
+#: fundb.c:1020 fundb.c:1479
 msgid "#-1 ARG2 NOT FOUND"
 msgstr ""
 
-#: fundb.c:993
+#: fundb.c:1028
 msgid "#-1 BAD ATTR NAME"
 msgstr ""
 
-#: fundb.c:1130
+#: fundb.c:1165
 msgid "#-1 NO SUCH TYPE"
 msgstr ""
 
-#: fundb.c:1148 fundb.c:1160 fundb.c:1178 fundb.c:1196
+#: fundb.c:1183 fundb.c:1195 fundb.c:1213 fundb.c:1231
 msgid "#-1 INVALID FLAG"
 msgstr ""
 
-#: fundb.c:1176 fundb.c:1194
+#: fundb.c:1211 fundb.c:1229
 msgid "#-1 INVALID POWER"
 msgstr ""
 
-#: fundb.c:1295 fundb.c:1299 fundb.c:1320 fundb.c:1327
+#: fundb.c:1330 fundb.c:1334 fundb.c:1355 fundb.c:1362
 msgid "#-1 NO SUCH LOCK"
 msgstr ""
 
-#: fundb.c:1418
+#: fundb.c:1453
 msgid "#-1 INVALID BOOLEXP"
 msgstr ""
 
-#: fundb.c:1853
+#: fundb.c:1898
 msgid "I'm not sure who you mean."
 msgstr ""
 
-#: fundb.c:1994
+#: fundb.c:2039
 #, c-format
 msgid "I don't understand switch '%c'."
 msgstr ""
 
-#: fundb.c:2187
+#: fundb.c:2138
+msgid "#-1 INVALID SOURCE ROOM"
+msgstr ""
+
+#: fundb.c:2243
 msgid "#-1 BAD ARGUMENT FORMAT TO ATTRIB_SET"
 msgstr ""
 
-#: fundb.c:2257 funlist.c:3147
+#: fundb.c:2313 funlist.c:3136
 msgid "#-1 NO SUCH ATTRIBUTE"
 msgstr ""
 
-#: fundb.c:2261 funlist.c:3151
+#: fundb.c:2317 funlist.c:3140
 msgid "#-1 INVALID GREP PATTERN"
 msgstr ""
 
-#: fundb.c:2335 fundb.c:2339
+#: fundb.c:2391 fundb.c:2395
 msgid "#-1 ARGUMENT MUST BE OBJ/ATTR"
 msgstr ""
 
-#: fundb.c:2368 fundb.c:2390
+#: fundb.c:2424 fundb.c:2446
 msgid "#-1 INVALID OBJECT"
 msgstr ""
 
-#: funlist.c:227
+#: funlist.c:216
 msgid "#-1 LISTS MUST BE OF EQUAL SIZE"
 msgstr ""
 
-#: funlist.c:1259 funmisc.c:435
+#: funlist.c:1248 funmisc.c:456
 msgid "#-1 NUMBER OUT OF RANGE"
 msgstr ""
 
-#: funlist.c:1729 funlist.c:2035
+#: funlist.c:1718 funlist.c:2024
 msgid "#-1 CAN ONLY TEST ONE ELEMENT"
 msgstr ""
 
-#: funlist.c:2171
+#: funlist.c:2160
 msgid "#-1 NEED A WORD"
 msgstr ""
 
-#: funlist.c:2177
+#: funlist.c:2166
 msgid "#-1 TOO MANY WORDS"
 msgstr ""
 
-#: funlist.c:2184
+#: funlist.c:2173
 msgid "#-1 NUMBER OF WORDS MUST BE EQUAL"
 msgstr ""
 
-#: funlist.c:2223
+#: funlist.c:2212
 msgid "#-1 TOO MANY ITERS"
 msgstr ""
 
-#: funlist.c:2373
+#: funlist.c:2362
 msgid "#-1 STEP OUT OF RANGE"
 msgstr ""
 
-#: funlist.c:2781 funlist.c:2796 funlist.c:2889 funlist.c:2904 funlist.c:3020
-#: funlist.c:3161 funlist.c:3169 funlist.c:3252 funlist.c:3260
+#: funlist.c:2770 funlist.c:2785 funlist.c:2878 funlist.c:2893 funlist.c:3009
+#: funlist.c:3150 funlist.c:3158 funlist.c:3241 funlist.c:3249
 msgid "#-1 REGEXP ERROR: "
 msgstr ""
 
@@ -3642,37 +3704,37 @@
 msgid "#-1 FUNCTION (DIST3D) EXPECTS 6 ARGUMENTS"
 msgstr ""
 
-#: funmisc.c:242
+#: funmisc.c:247
 #, c-format
 msgid "#-1 FUNCTION (%s) EXPECTS AN EVEN NUMBER OF ARGUMENTS"
 msgstr ""
 
-#: funmisc.c:255 funmisc.c:304 funmisc.c:359 funmisc.c:375
+#: funmisc.c:260 funmisc.c:309 funmisc.c:364 funmisc.c:380
 msgid "#-1 REGISTER OUT OF RANGE"
 msgstr ""
 
-#: funmisc.c:270
+#: funmisc.c:275
 msgid "#-1 FUNCTION (LETQ) EXPECTS AN ODD NUMBER OF ARGUMENTS"
 msgstr ""
 
-#: funmisc.c:283 funmisc.c:289 funmisc.c:315
+#: funmisc.c:288 funmisc.c:294 funmisc.c:320
 msgid "#-1 UNABLE TO ALLOCATE MEMORY"
 msgstr ""
 
-#: funmisc.c:738
+#: funmisc.c:795
 msgid "#-1 FUNCTION (SOUNDEX) REQUIRES A SINGLE WORD ARGUMENT"
 msgstr ""
 
-#: funmisc.c:757
+#: funmisc.c:814
 msgid "#-1 FUNCTION (SOUNDLIKE) REQUIRES TWO ONE-WORD ARGUMENTS"
 msgstr ""
 
-#: funmisc.c:963
+#: funmisc.c:1020
 #, c-format
 msgid "I don't think #%d wants to hear from you."
 msgstr ""
 
-#: funmisc.c:994 funmisc.c:997
+#: funmisc.c:1051 funmisc.c:1054
 #, c-format
 msgid "Average: %.2f   Min: %u   Max: %u"
 msgstr ""
@@ -3741,71 +3803,71 @@
 msgid "pronoun:plural,absolute possessive "
 msgstr ""
 
-#: funstr.c:470 funstr.c:519
+#: funstr.c:470 funstr.c:520
 msgid "#-1 INVALID THIRD ARGUMENT"
 msgstr ""
 
-#: funstr.c:511
+#: funstr.c:512
 msgid "#-1 INVALID DBREF"
 msgstr ""
 
-#: funstr.c:646 funstr.c:788 funstr.c:1449
+#: funstr.c:647 funstr.c:789 funstr.c:1450
 msgid "#-1 STRING LENGTHS MUST BE EQUAL"
 msgstr ""
 
-#: funstr.c:718 funstr.c:726 funstr.c:756 funstr.c:764
+#: funstr.c:719 funstr.c:727 funstr.c:757 funstr.c:765
 msgid "#-1 TR CANNOT ACCEPT NONPRINTING CHARS"
 msgstr ""
 
-#: funstr.c:863
+#: funstr.c:864
 msgid "#-1 ARGUMENT MUST BE NON-NEGATIVE INTEGER"
 msgstr ""
 
-#: funstr.c:943 funstr.c:994 funstr.c:1046 funstr.c:1065
+#: funstr.c:944 funstr.c:995 funstr.c:1047 funstr.c:1066
 msgid "#-1 FILL ARGUMENT MAY NOT BE ZERO-LENGTH"
 msgstr ""
 
-#: funstr.c:1415
+#: funstr.c:1416
 msgid "#-1 FUNCTION (ORD) EXPECTS ONE CHARACTER"
 msgstr ""
 
-#: funstr.c:1424 funstr.c:1442
+#: funstr.c:1425 funstr.c:1443
 msgid "#-1 UNPRINTABLE CHARACTER"
 msgstr ""
 
-#: funstr.c:1438
+#: funstr.c:1439
 msgid "#-1 THIS ISN'T UNICODE"
 msgstr ""
 
-#: funstr.c:1631
+#: funstr.c:1632
 msgid "#-1 WIDTH TOO SMALL"
 msgstr ""
 
-#: funstr.c:1921 funstr.c:1946
+#: funstr.c:1923 funstr.c:1948
 msgid "#-1 INVALID ALIGN STRING"
 msgstr ""
 
-#: funstr.c:1960
+#: funstr.c:1962
 msgid "#-1 CANNOT HAVE COLUMNS OF NEGATIVE SIZE"
 msgstr ""
 
-#: funstr.c:1964 funstr.c:1970
+#: funstr.c:1966 funstr.c:1972
 msgid "#-1 CANNOT HAVE COLUMNS THAT LARGE"
 msgstr ""
 
-#: funstr.c:1975
+#: funstr.c:1977
 msgid "#-1 NOT ENOUGH COLUMNS FOR ALIGN"
 msgstr ""
 
-#: funstr.c:1979
+#: funstr.c:1981
 msgid "#-1 TOO MANY COLUMNS FOR ALIGN"
 msgstr ""
 
-#: funstr.c:1985 funstr.c:2020
+#: funstr.c:1987 funstr.c:2022
 msgid "#-1 INVALID NUMBER OF ARGUMENTS TO ALIGN"
 msgstr ""
 
-#: funstr.c:1990 funstr.c:2025
+#: funstr.c:1992 funstr.c:2027
 msgid "#-1 FILLER MUST BE ONE CHARACTER"
 msgstr ""
 
@@ -3826,7 +3888,15 @@
 msgid "#-1 INVALID TIMESTRING"
 msgstr ""
 
-#: funufun.c:321
+#: funufun.c:57 parse.c:1261
+msgid "#-1 FUNCTION ("
+msgstr ""
+
+#: funufun.c:59 parse.c:1263
+msgid ") NOT FOUND"
+msgstr ""
+
+#: funufun.c:331
 msgid "#-1 NO SUCH USER FUNCTION"
 msgstr ""
 
@@ -3852,321 +3922,326 @@
 msgid "Sorry, you are in a no dumping zone."
 msgstr ""
 
-#: game.c:287
+#: game.c:285
 msgid "It takes a God to make me panic."
 msgstr ""
 
-#: game.c:290
+#: game.c:288
 #, c-format
 msgid "GAME: Shutdown by %s"
 msgstr ""
 
-#: game.c:328
+#: game.c:330
 msgid "GAME: ERROR! Database save failed!"
 msgstr ""
 
-#: game.c:441
+#: game.c:451
 #, c-format
 msgid "EMERGENCY SHUTDOWN: %s"
 msgstr ""
 
-#: game.c:556
+#: game.c:566
 msgid "DUMP: Data are swapped to disk, so nonforking dumps will be used."
 msgstr ""
 
-#: game.c:1086
+#: game.c:1096
 #, c-format
 msgid "Attempt to execute command by halted object #%d"
 msgstr ""
 
-#: game.c:1096
+#: game.c:1106
 #, c-format
 msgid "Invalid location on command execution: %s(#%d)"
 msgstr ""
 
-#: game.c:1263 game.c:1274
-msgid "No matching command."
+#: game.c:1281 game.c:1288 look.c:663 look.c:685 look.c:712 look.c:720
+#: move.c:555 move.c:563 move.c:599 move.c:875 move.c:1044 speech.c:564
+msgid "I don't see that here."
 msgstr ""
 
-#: game.c:1269
+#: game.c:1284 game.c:1305
 msgid "Make room! Make room!"
 msgstr ""
 
-#: game.c:1470
+#: game.c:1299 game.c:1310
+msgid "No matching command."
+msgstr ""
+
+#: game.c:1506
 msgid "Only God can cause financial ruin."
 msgstr ""
 
-#: game.c:1478
+#: game.c:1514
 #, c-format
 msgid "The money supply of all players has been reset to %d %s."
 msgstr ""
 
-#: game.c:1503
+#: game.c:1539
 msgid "Logged."
 msgstr ""
 
-#: game.c:1562
+#: game.c:1598
 msgid "#-1 NO COMMAND"
 msgstr ""
 
-#: game.c:1667
+#: game.c:1703
 msgid "Sorry, you are in an invalid location."
 msgstr ""
 
-#: game.c:1671
+#: game.c:1707
 msgid "What command do you want to scan for?"
 msgstr ""
 
-#: game.c:1678
+#: game.c:1714
 msgid "Matches on contents of this room:"
 msgstr ""
 
-#: game.c:1693
+#: game.c:1729
 #, c-format
 msgid "Matched here: %s  [%d:%s]"
 msgstr ""
 
-#: game.c:1699
+#: game.c:1735
 msgid "Matches on carried objects:"
 msgstr ""
 
-#: game.c:1713
+#: game.c:1749
 #, c-format
 msgid "Matched self: %s  [%d:%s]"
 msgstr ""
 
-#: game.c:1724
+#: game.c:1760
 msgid "Matches on zone master room of location:"
 msgstr ""
 
-#: game.c:1739
+#: game.c:1775
 #, c-format
 msgid "Matched zone of location: %s  [%d:%s]"
 msgstr ""
 
-#: game.c:1751
+#: game.c:1787
 msgid "Matches on personal zone master room:"
 msgstr ""
 
-#: game.c:1763
+#: game.c:1799
 #, c-format
 msgid "Matched personal zone: %s  [%d:%s]"
 msgstr ""
 
-#: game.c:1774
+#: game.c:1810
 msgid "Matches on objects in the Master Room:"
 msgstr ""
 
-#: game.c:1812
+#: game.c:1848
 msgid "What do you want to do with the list?"
 msgstr ""
 
-#: game.c:1820
+#: game.c:1856
 msgid "Separator must be one character."
 msgstr ""
 
-#: game.c:2001
+#: game.c:2037
 msgid "Error -- cannot execute uptime."
 msgstr ""
 
-#: game.c:2083
+#: game.c:2119
 msgid "Up since"
 msgstr ""
 
-#: game.c:2087
+#: game.c:2123
 msgid "Last reboot"
 msgstr ""
 
-#: game.c:2089
+#: game.c:2125
 msgid "Total reboots"
 msgstr ""
 
-#: game.c:2093
+#: game.c:2129
 msgid "Time now"
 msgstr ""
 
-#: game.c:2098
+#: game.c:2134
 msgid "Time of last database save"
 msgstr ""
 
-#: game.c:2106 game.c:2113 game.c:2120 game.c:2128
+#: game.c:2142 game.c:2149 game.c:2156 game.c:2164
 #, c-format
 msgid "%29s: %ld minutes %ld seconds, at %s."
 msgstr ""
 
-#: game.c:2107
+#: game.c:2143
 msgid "Time until next database save"
 msgstr ""
 
-#: game.c:2114
+#: game.c:2150
 msgid "Time until next dbck check"
 msgstr ""
 
-#: game.c:2121
+#: game.c:2157
 msgid "Time until next purge"
 msgstr ""
 
-#: game.c:2129
+#: game.c:2165
 msgid "Time until next @warnings"
 msgstr ""
 
-#: game.c:2145
+#: game.c:2181
 #, c-format
 msgid "PennMUSH Uptime: %ld days %ld hours %ld minutes %ld seconds"
 msgstr ""
 
-#: game.c:2326 game.c:2344
+#: game.c:2362 game.c:2380
 msgid "I don't understand what you want to @list."
 msgstr ""
 
-#: help.c:65
+#: help.c:66
 msgid "That command is unavailable."
 msgstr ""
 
-#: help.c:70
+#: help.c:71
 msgid "You don't look like an admin to me."
 msgstr ""
 
-#: help.c:80
+#: help.c:81
 #, c-format
 msgid "No entries matching '%s' were found."
 msgstr ""
 
-#: help.c:91
+#: help.c:92
 #, c-format
 msgid ""
 "Here are the entries which match '%s':\n"
 "%s"
 msgstr ""
 
-#: help.c:174
+#: help.c:175
 msgid "Help files reindexed."
 msgstr ""
 
-#: help.c:194
+#: help.c:195
 msgid "Help topics don't start with '&'."
 msgstr ""
 
-#: help.c:206
+#: help.c:207
 msgid "Sorry, that command is temporarily unvailable."
 msgstr ""
 
-#: help.c:216
+#: help.c:217
 #, c-format
 msgid "No entry for '%s'."
 msgstr ""
 
-#: help.c:221 help.c:226
+#: help.c:222 help.c:227
 msgid "Sorry, that function is temporarily unavailable."
 msgstr ""
 
-#: help.c:259
+#: help.c:260
 #, c-format
 msgid "%s output truncated."
 msgstr ""
 
-#: help.c:472 help.c:503
+#: help.c:474 help.c:505
 msgid "#-1 NO SUCH FILE"
 msgstr ""
 
-#: help.c:485
+#: help.c:487
 msgid "No matching help topics."
 msgstr ""
 
-#: help.c:528
+#: help.c:530
 msgid "#-1 INVALID ENTRY"
 msgstr ""
 
-#: help.c:550
+#: help.c:552
 msgid "#-1 NO INDEX FOR FILE"
 msgstr ""
 
-#: help.c:554
+#: help.c:556
 msgid "#-1 NO ENTRY"
 msgstr ""
 
-#: help.c:558 help.c:561
+#: help.c:560 help.c:563
 msgid "#-1 UNAVAILABLE"
 msgstr ""
 
-#: lock.c:663
+#: lock.c:662
 msgid "Unknown lock type."
 msgstr ""
 
-#: lock.c:667
+#: lock.c:666
 msgid "The character '|' may not be used in lock names."
 msgstr ""
 
-#: lock.c:676
+#: lock.c:675
 msgid "That is not a valid lock name."
 msgstr ""
 
-#: lock.c:706
+#: lock.c:705
 #, c-format
 msgid "%s(%s) - %s (already) unlocked."
 msgstr ""
 
-#: lock.c:710
+#: lock.c:709
 #, c-format
 msgid "%s(%s) - %s unlocked."
 msgstr ""
 
-#: lock.c:747
+#: lock.c:746
 msgid "I don't see what you want to lock!"
 msgstr ""
 
-#: lock.c:750
+#: lock.c:749
 msgid "I don't know which one you want to lock!"
 msgstr ""
 
-#: lock.c:754
+#: lock.c:753
 msgid "You can't lock that!"
 msgstr ""
 
-#: lock.c:758
+#: lock.c:757
 msgid "Why would you want to lock garbage?"
 msgstr ""
 
-#: lock.c:768
+#: lock.c:767
 msgid "I don't understand that key."
 msgstr ""
 
-#: lock.c:774
+#: lock.c:773
 #, c-format
 msgid "%s(%s) - %s locked."
 msgstr ""
 
-#: lock.c:950
+#: lock.c:949
 msgid "No lock name given."
 msgstr ""
 
-#: lock.c:964
+#: lock.c:963
 msgid "Unrecognized lock flag."
 msgstr ""
 
-#: lock.c:970
+#: lock.c:969
 msgid "No such lock."
 msgstr ""
 
-#: lock.c:986
+#: lock.c:985
 msgid "lock flags unset"
 msgstr ""
 
-#: lock.c:986
+#: lock.c:985
 msgid "lock flags set"
 msgstr ""
 
-#: lock.c:1007
+#: lock.c:1006
 #, c-format
 msgid "Unlocked zone %s - automatically zone-locking to itself"
 msgstr ""
 
-#: lock.c:1015
+#: lock.c:1014
 #, c-format
 msgid "Zone %s really should have a more secure zone-lock."
 msgstr ""
 
-#: lock.c:1020
+#: lock.c:1019
 #, c-format
 msgid ""
 "Warning: Zone %s may have loose zone lock. Lock zones to =player, not player"
@@ -4253,291 +4328,290 @@
 msgid "%s [#%d%s] is veiled"
 msgstr ""
 
-#: look.c:426 look.c:429 look.c:435 look.c:439 predicat.c:1434 set.c:936
+#: look.c:427 look.c:431 look.c:437 look.c:442 predicat.c:1435 set.c:939
 msgid "No matching attributes."
 msgstr ""
 
-#: look.c:461
+#: look.c:464
 msgid "You see nothing special."
 msgstr ""
 
-#: look.c:556 look.c:904
+#: look.c:559 look.c:924
 msgid "Contents:"
 msgstr ""
 
-#: look.c:558 look.c:912
+#: look.c:561 look.c:932
 msgid "Obvious exits:"
 msgstr ""
 
-#: look.c:642 look.c:687 look.c:695
+#: look.c:646 look.c:695 look.c:703
 msgid "You can't see through that."
 msgstr ""
 
-#: look.c:657 look.c:678 look.c:703 look.c:711 move.c:551 move.c:559
-#: move.c:595 move.c:871 move.c:1040 speech.c:553
-msgid "I don't see that here."
-msgstr ""
-
-#: look.c:660 warnings.c:290 warnings.c:511
+#: look.c:666 warnings.c:290 warnings.c:511
 msgid "I don't know which one you mean."
 msgstr ""
 
-#: look.c:681 look.c:714 move.c:554 move.c:562
+#: look.c:688 look.c:723 move.c:558 move.c:566
 #, c-format
 msgid "I can't tell which %s."
 msgstr ""
 
-#: look.c:720
+#: look.c:729
 msgid "You can't look at that from here."
 msgstr ""
 
-#: look.c:724
+#: look.c:733
 msgid "I can't tell which one you mean."
 msgstr ""
 
-#: look.c:748 look.c:902
+#: look.c:754
+msgid "You can't see that from here."
+msgstr ""
+
+#: look.c:768 look.c:922
 msgid "Carrying:"
 msgstr ""
 
-#: look.c:827 look.c:915
+#: look.c:847 look.c:935
 msgid " is owned by "
 msgstr ""
 
-#: look.c:856
+#: look.c:876
 #, c-format
 msgid "Owner: %s  Zone: %s  %s: %d"
 msgstr ""
 
-#: look.c:859
+#: look.c:879
 #, c-format
 msgid "Parent: %s"
 msgstr ""
 
-#: look.c:863
+#: look.c:883
 #, c-format
 msgid "%s Lock [#%d%s]: %s"
 msgstr ""
 
-#: look.c:868
+#: look.c:888
 #, c-format
 msgid "Powers: %s"
 msgstr ""
 
-#: look.c:872
+#: look.c:892
 #, c-format
 msgid "Warnings checked: %s"
 msgstr ""
 
-#: look.c:875
+#: look.c:895
 #, c-format
 msgid "Created: %s"
 msgstr ""
 
-#: look.c:877
+#: look.c:897
 #, c-format
 msgid "Last Modification: %s"
 msgstr ""
 
-#: look.c:928
+#: look.c:948
 msgid "Exits:"
 msgstr ""
 
-#: look.c:932
+#: look.c:952
 msgid "No exits."
 msgstr ""
 
-#: look.c:936
+#: look.c:956
 #, c-format
 msgid "Dropped objects go to: %s"
 msgstr ""
 
-#: look.c:943
+#: look.c:963
 #, c-format
 msgid "Home: %s"
 msgstr ""
 
-#: look.c:947
+#: look.c:967
 #, c-format
 msgid "Location: %s"
 msgstr ""
 
-#: look.c:969
+#: look.c:989
 #, c-format
 msgid "Source: %s"
 msgstr ""
 
-#: look.c:975
+#: look.c:995
 msgid "Destination: *UNLINKED*"
 msgstr ""
 
-#: look.c:978
+#: look.c:998
 msgid "Destination: *HOME*"
 msgstr ""
 
-#: look.c:982
+#: look.c:1002
 #, c-format
 msgid "Destination: %s"
 msgstr ""
 
-#: look.c:1003
+#: look.c:1023
 #, c-format
 msgid "You have unlimited %s."
 msgstr ""
 
-#: look.c:1006
+#: look.c:1026
 #, c-format
 msgid "You have %d %s."
 msgstr ""
 
-#: look.c:1009
+#: look.c:1029
 #, c-format
 msgid "You may give unlimited %s"
 msgstr ""
 
-#: look.c:1075
+#: look.c:1095
 msgid "You aren't carrying anything."
 msgstr ""
 
-#: look.c:1077
+#: look.c:1097
 msgid "You are carrying:"
 msgstr ""
 
-#: look.c:1105 look.c:1115
+#: look.c:1125 look.c:1135
 msgid "Invalid range argument"
 msgstr ""
 
-#: look.c:1127
+#: look.c:1147
 #, c-format
 msgid "*** %d objects found ***"
 msgstr ""
 
-#: look.c:1161
+#: look.c:1180
 msgid "Invalid parameter."
 msgstr ""
 
-#: look.c:1166
+#: look.c:1185
 msgid "Listening in ROOM:"
 msgstr ""
 
-#: look.c:1172 look.c:1197 look.c:1237
+#: look.c:1191 look.c:1216 look.c:1254
 #, c-format
 msgid "%s is listening."
 msgstr ""
 
-#: look.c:1174 look.c:1199 look.c:1239
+#: look.c:1193 look.c:1218 look.c:1256
 #, c-format
 msgid "%s [owner: %s] is listening."
 msgstr ""
 
-#: look.c:1181
+#: look.c:1200
 #, c-format
 msgid "%s (this room) [speech]. (connected)"
 msgstr ""
 
-#: look.c:1184
+#: look.c:1203
 #, c-format
 msgid "%s (this room) [speech]."
 msgstr ""
 
-#: look.c:1187
+#: look.c:1206
 #, c-format
 msgid "%s (this room) [commands]."
 msgstr ""
 
-#: look.c:1189
+#: look.c:1208
 #, c-format
 msgid "%s (this room) [broadcasting]."
 msgstr ""
 
-#: look.c:1206 look.c:1246
+#: look.c:1225 look.c:1263
 #, c-format
 msgid "%s [speech]. (connected)"
 msgstr ""
 
-#: look.c:1208 look.c:1248
+#: look.c:1227 look.c:1265
 #, c-format
 msgid "%s [speech]."
 msgstr ""
 
-#: look.c:1211 look.c:1251
+#: look.c:1230 look.c:1268
 #, c-format
 msgid "%s [commands]."
 msgstr ""
 
-#: look.c:1216
+#: look.c:1235
 msgid "Listening EXITS:"
 msgstr ""
 
-#: look.c:1224
+#: look.c:1241
 #, c-format
 msgid "%s [broadcasting]."
 msgstr ""
 
-#: look.c:1230
+#: look.c:1247
 msgid "Listening in your INVENTORY:"
 msgstr ""
 
-#: look.c:1269
+#: look.c:1286
 msgid "You must specify a valid player name."
 msgstr ""
 
-#: look.c:1273
+#: look.c:1290
 msgid "That player does not seem to exist."
 msgstr ""
 
-#: look.c:1277
+#: look.c:1294
 msgid "That player wishes to have some privacy."
 msgstr ""
 
-#: look.c:1278
+#: look.c:1295
 #, c-format
 msgid "%s tried to locate you and failed."
 msgstr ""
 
-#: look.c:1282
+#: look.c:1299
 #, c-format
 msgid "%s is at: %s."
 msgstr ""
 
-#: look.c:1285
+#: look.c:1302
 #, c-format
 msgid "%s has just located your position."
 msgstr ""
 
-#: look.c:1345
+#: look.c:1362
 #, c-format
 msgid "%s(#%d) [from: %s(#%d)]"
 msgstr ""
 
-#: look.c:1352
+#: look.c:1369
 #, c-format
 msgid "%s(#%d) [dropto]"
 msgstr ""
 
-#: look.c:1359
+#: look.c:1376
 #, c-format
 msgid "%s(#%d) [home]"
 msgstr ""
 
-#: look.c:1371 wiz.c:1218 wiz.c:1362
+#: look.c:1388 wiz.c:1222 wiz.c:1389
 msgid "Nothing found."
 msgstr ""
 
-#: look.c:1374
+#: look.c:1391
 msgid "----------  Entrances Done  ----------"
 msgstr ""
 
-#: look.c:1377 wiz.c:1318
+#: look.c:1394 wiz.c:1344
 #, c-format
 msgid "Totals: Rooms...%d  Exits...%d  Things...%d  Players...%d"
 msgstr ""
 
-#: look.c:1486
+#: look.c:1503
 #, c-format
 msgid "@@ No attributes match '%s'. @@"
 msgstr ""
 
-#: look.c:1547
+#: look.c:1564
 msgid "What do you want to @decompile?"
 msgstr ""
 
@@ -4567,21 +4641,21 @@
 msgid "MAIL: Mail Alias '%s' already exists."
 msgstr ""
 
-#: malias.c:214 malias.c:591 malias.c:801 malias.c:906
+#: malias.c:214 malias.c:592 malias.c:802 malias.c:906
 #, c-format
 msgid "MAIL: No such player '%s'."
 msgstr ""
 
-#: malias.c:217 malias.c:594 malias.c:809
+#: malias.c:217 malias.c:595 malias.c:810
 #, c-format
 msgid "MAIL: %s added to alias %s"
 msgstr ""
 
-#: malias.c:233 malias.c:610 malias.c:826
+#: malias.c:233 malias.c:611 malias.c:827
 msgid "MAIL: Alias list is restricted to maximal 100 entries!"
 msgstr ""
 
-#: malias.c:236 malias.c:613 malias.c:829
+#: malias.c:236 malias.c:614 malias.c:830
 msgid "MAIL: No valid recipients for alias-list!"
 msgstr ""
 
@@ -4611,7 +4685,7 @@
 msgid "MAIL: Alias '%s' not found."
 msgstr ""
 
-#: malias.c:318 malias.c:411 malias.c:478 malias.c:669 malias.c:730
+#: malias.c:318 malias.c:411 malias.c:478 malias.c:670 malias.c:731
 msgid "MAIL: Permission denied."
 msgstr ""
 
@@ -4641,7 +4715,7 @@
 msgid "MAIL: Owner changed for alias."
 msgstr ""
 
-#: malias.c:464 malias.c:726
+#: malias.c:464 malias.c:727
 msgid "MAIL: I cannot find that alias!"
 msgstr ""
 
@@ -4658,65 +4732,65 @@
 msgid "MAIL: Mail Alias renamed."
 msgstr ""
 
-#: malias.c:505 malias.c:545
+#: malias.c:505 malias.c:546
 #, c-format
 msgid "MAIL: Not a valid alias. Remember to prefix the alias name with %c."
 msgstr ""
 
-#: malias.c:509
+#: malias.c:510
 msgid "MAIL: Alias Destroyed."
 msgstr ""
 
-#: malias.c:518 malias.c:554
+#: malias.c:519 malias.c:555
 msgid "MAIL: Permission denied!"
 msgstr ""
 
-#: malias.c:550
+#: malias.c:551
 msgid "MAIL: You must set the alias to a non-empty list."
 msgstr ""
 
-#: malias.c:621
+#: malias.c:622
 msgid "MAIL: Alias list set."
 msgstr ""
 
-#: malias.c:653
+#: malias.c:654
 msgid "***** End of Mail Aliases *****"
 msgstr ""
 
-#: malias.c:672
+#: malias.c:673
 #, c-format
 msgid "MAIL: Number of mail aliases defined: %d"
 msgstr ""
 
-#: malias.c:673
+#: malias.c:674
 #, c-format
 msgid "MAIL: Allocated slots %d"
 msgstr ""
 
-#: malias.c:690
+#: malias.c:691
 msgid "MAIL: Only god can do that!"
 msgstr ""
 
-#: malias.c:706
+#: malias.c:707
 msgid "MAIL: All mail aliases destroyed!"
 msgstr ""
 
-#: malias.c:736
+#: malias.c:737
 #, c-format
 msgid "MAIL: Permission to see/use alias '%s' changed to %s"
 msgstr ""
 
-#: malias.c:759 malias.c:864
+#: malias.c:760 malias.c:865
 #, c-format
 msgid "MAIL: Mail Alias '%s' not found."
 msgstr ""
 
-#: malias.c:805
+#: malias.c:806
 #, c-format
 msgid "MAIL: player '%s' exists already in alias %s."
 msgstr ""
 
-#: malias.c:841 malias.c:926
+#: malias.c:842 malias.c:926
 #, c-format
 msgid "MAIL: Alias set '%s' redefined."
 msgstr ""
@@ -4731,26 +4805,26 @@
 msgid "MAIL: %s removed from alias %s"
 msgstr ""
 
-#: markup.c:1148
+#: markup.c:1144
 msgid "Inspecting ansi string"
 msgstr ""
 
-#: markup.c:1149
+#: markup.c:1145
 #, c-format
 msgid "  Text: %s"
 msgstr ""
 
-#: markup.c:1150
+#: markup.c:1146
 #, c-format
 msgid "  Nmarkups: %d"
 msgstr ""
 
-#: markup.c:1156
+#: markup.c:1152
 #, c-format
 msgid "    %d (%s): (start: %d end: %d) start_code: %s stop_code: %s"
 msgstr ""
 
-#: markup.c:1161
+#: markup.c:1157
 msgid "Inspecting ansi string complete"
 msgstr ""
 
@@ -4762,276 +4836,276 @@
 msgid "has arrived."
 msgstr ""
 
-#: move.c:372 move.c:610 wiz.c:410 wiz.c:415 wiz.c:419
+#: move.c:374 move.c:614 wiz.c:412 wiz.c:417 wiz.c:421
 msgid "Bad destination."
 msgstr ""
 
-#: move.c:378
+#: move.c:380
 #, c-format
 msgid "%s goes home."
 msgstr ""
 
-#: move.c:381 move.c:382 move.c:383
+#: move.c:383 move.c:384 move.c:385
 msgid "There's no place like home..."
 msgstr ""
 
-#: move.c:402 move.c:412 move.c:464 move.c:482
+#: move.c:406 move.c:416 move.c:468 move.c:486
 msgid "You can't go that way."
 msgstr ""
 
-#: move.c:405
+#: move.c:409
 msgid "I don't know which way you mean!"
 msgstr ""
 
-#: move.c:427
+#: move.c:431
 #, c-format
 msgid "Variable exit destination #%d is invalid or not permitted."
 msgstr ""
 
-#: move.c:440 move.c:444
+#: move.c:444 move.c:448
 msgid "Exit destination is invalid."
 msgstr ""
 
-#: move.c:478
+#: move.c:482
 msgid "This feature coming soon."
 msgstr ""
 
-#: move.c:510
+#: move.c:514
 msgid "You cannot modify exits in that room."
 msgstr ""
 
-#: move.c:516
+#: move.c:520
 #, c-format
 msgid "%s is now the first exit in %s."
 msgstr ""
 
-#: move.c:576 move.c:795
+#: move.c:580 move.c:799
 #, c-format
 msgid "%s was taken from you."
 msgstr ""
 
-#: move.c:577 move.c:627 move.c:796
+#: move.c:581 move.c:631 move.c:800
 #, c-format
 msgid "%s took you."
 msgstr ""
 
-#: move.c:579 move.c:798
+#: move.c:583 move.c:802
 #, c-format
 msgid "You take %s from %s."
 msgstr ""
 
-#: move.c:583 move.c:802
+#: move.c:587 move.c:806
 #, c-format
 msgid "takes %s from %s."
 msgstr ""
 
-#: move.c:593 move.c:622
+#: move.c:597 move.c:626
 msgid "You can't take that from there."
 msgstr ""
 
-#: move.c:602
+#: move.c:606
 msgid "You already have that!"
 msgstr ""
 
-#: move.c:606
+#: move.c:610
 msgid "It's all around you!"
 msgstr ""
 
-#: move.c:617
+#: move.c:621
 msgid "You cannot get yourself!"
 msgstr ""
 
-#: move.c:629
+#: move.c:633
 #, c-format
 msgid "You take %s."
 msgstr ""
 
-#: move.c:632
+#: move.c:636
 #, c-format
 msgid "takes %s."
 msgstr ""
 
-#: move.c:639
+#: move.c:643
 msgid "You can't pick that up."
 msgstr ""
 
-#: move.c:643
+#: move.c:647
 msgid "You can't pick up exits."
 msgstr ""
 
-#: move.c:646
+#: move.c:650
 msgid "You can't take that!"
 msgstr ""
 
-#: move.c:670 rob.c:370
+#: move.c:674 rob.c:369
 msgid "You don't have that!"
 msgstr ""
 
-#: move.c:673 rob.c:373
+#: move.c:677 rob.c:372
 msgid "I don't know which you mean!"
 msgstr ""
 
-#: move.c:678
+#: move.c:682
 msgid "You can't drop that."
 msgstr ""
 
-#: move.c:681
+#: move.c:685
 msgid "Sorry, you can't drop exits."
 msgstr ""
 
-#: move.c:684
+#: move.c:688
 msgid "You can't seem to get rid of that."
 msgstr ""
 
-#: move.c:687
+#: move.c:691
 msgid "You can't seem to drop things here."
 msgstr ""
 
-#: move.c:690
+#: move.c:694
 msgid "Dropped."
 msgstr ""
 
-#: move.c:695 move.c:698 move.c:819 move.c:822
+#: move.c:699 move.c:702 move.c:823 move.c:826
 #, c-format
 msgid "%s drops you."
 msgstr ""
 
-#: move.c:704 move.c:826
+#: move.c:708 move.c:830
 #, c-format
 msgid "You drop %s."
 msgstr ""
 
-#: move.c:707 move.c:829
+#: move.c:711 move.c:833
 #, c-format
 msgid "drops %s."
 msgstr ""
 
-#: move.c:755
+#: move.c:759
 msgid "You can't empty that from here."
 msgstr ""
 
-#: move.c:836
+#: move.c:840
 #, c-format
 msgid "You remove 1 object from %s."
 msgstr ""
 
-#: move.c:838
+#: move.c:842
 #, c-format
 msgid "You remove %d objects from %s."
 msgstr ""
 
-#: move.c:883
+#: move.c:887
 msgid "Sorry, you must remain beside yourself!"
 msgstr ""
 
-#: move.c:907
+#: move.c:911
 msgid "You can't leave."
 msgstr ""
 
-#: move.c:981
+#: move.c:985
 msgid "I can't tell which one to follow."
 msgstr ""
 
-#: move.c:989
+#: move.c:993
 msgid "You don't see that here."
 msgstr ""
 
-#: move.c:993
+#: move.c:997
 msgid "You can only follow players and things."
 msgstr ""
 
-#: move.c:997
+#: move.c:1001
 msgid "You chase your tail for a while and feel silly."
 msgstr ""
 
-#: move.c:1002
+#: move.c:1006
 #, c-format
 msgid "You're already following %s."
 msgstr ""
 
-#: move.c:1008
+#: move.c:1012
 msgid "You're not allowed to follow."
 msgstr ""
 
-#: move.c:1015
+#: move.c:1019
 #, c-format
 msgid "You are following: %s"
 msgstr ""
 
-#: move.c:1016
+#: move.c:1020
 #, c-format
 msgid "You are followed by: %s"
 msgstr ""
 
-#: move.c:1036
+#: move.c:1040
 msgid "I can't tell which one to stop following."
 msgstr ""
 
-#: move.c:1045
+#: move.c:1049
 #, c-format
 msgid "You're not following %s."
 msgstr ""
 
-#: move.c:1053
+#: move.c:1057
 msgid "You stop following anyone."
 msgstr ""
 
-#: move.c:1074
+#: move.c:1078
 msgid "I don't recognize who you want to dismiss."
 msgstr ""
 
-#: move.c:1079
+#: move.c:1083
 #, c-format
 msgid "%s isn't following you."
 msgstr ""
 
-#: move.c:1087
+#: move.c:1091
 msgid "You dismiss all your followers."
 msgstr ""
 
-#: move.c:1107
+#: move.c:1111
 msgid "I don't recognize who you want to desert."
 msgstr ""
 
-#: move.c:1114
+#: move.c:1118
 #, c-format
 msgid "%s isn't following you, nor vice versa."
 msgstr ""
 
-#: move.c:1124
+#: move.c:1128
 msgid "You desert everyone you're leading or following."
 msgstr ""
 
-#: move.c:1175
+#: move.c:1179
 #, c-format
 msgid "You begin following %s."
 msgstr ""
 
-#: move.c:1176
+#: move.c:1180
 #, c-format
 msgid "%s begins following you."
 msgstr ""
 
-#: move.c:1222 move.c:1336
+#: move.c:1226 move.c:1340
 #, c-format
 msgid "You stop following %s."
 msgstr ""
 
-#: move.c:1223 move.c:1364
+#: move.c:1227 move.c:1368
 #, c-format
 msgid "%s stops following you."
 msgstr ""
 
-#: move.c:1398
+#: move.c:1402
 #, c-format
 msgid "You follow %s."
 msgstr ""
 
-#: mymalloc.c:560 rob.c:86 wiz.c:601
+#: mymalloc.c:556 rob.c:86 wiz.c:603
 msgid "Sorry."
 msgstr ""
 
-#: notify.c:1482
+#: notify.c:1479
 #, c-format
 msgid "[%s(#%d)'s %s(#%d)] "
 msgstr ""
@@ -5076,7 +5150,7 @@
 msgid "#-1 NO MATCH"
 msgstr ""
 
-#: parse.c:100 sort.c:332
+#: parse.c:100 sort.c:335
 msgid "#-1 NO SUCH OBJECT VISIBLE"
 msgstr ""
 
@@ -5084,52 +5158,44 @@
 msgid "#-1 OUT OF RANGE"
 msgstr ""
 
-#: parse.c:666
+#: parse.c:690
 msgid "CPU usage exceeded."
 msgstr ""
 
-#: parse.c:1248
-msgid "#-1 FUNCTION ("
-msgstr ""
-
-#: parse.c:1250
-msgid ") NOT FOUND"
-msgstr ""
-
-#: parse.c:1299
+#: parse.c:1312
 msgid "#-1 FUNCTION RECURSION LIMIT EXCEEDED"
 msgstr ""
 
-#: parse.c:1394
+#: parse.c:1409
 #, c-format
 msgid "#-1 FUNCTION (%s) EXPECTS "
 msgstr ""
 
-#: parse.c:1399
+#: parse.c:1414
 msgid " OR "
 msgstr ""
 
-#: parse.c:1402
+#: parse.c:1417
 msgid "AT LEAST "
 msgstr ""
 
-#: parse.c:1405
+#: parse.c:1420
 msgid "BETWEEN "
 msgstr ""
 
-#: parse.c:1407
+#: parse.c:1422
 msgid " AND "
 msgstr ""
 
-#: parse.c:1410
+#: parse.c:1425
 msgid " ARGUMENTS BUT GOT "
 msgstr ""
 
-#: parse.c:1451
+#: parse.c:1466
 msgid "#-1 @FUNCTION ("
 msgstr ""
 
-#: parse.c:1453
+#: parse.c:1468
 msgid ") MISSING ATTRIBUTE ("
 msgstr ""
 
@@ -5219,33 +5285,33 @@
 msgid "GAME: %s(%s) tried to spend %d %s."
 msgstr ""
 
-#: predicat.c:1115
+#: predicat.c:1116
 #, c-format
 msgid "%s message from %s: %s"
 msgstr ""
 
-#: predicat.c:1119
+#: predicat.c:1120
 #, c-format
 msgid "[%d:%02d] %s message sent to %s."
 msgstr ""
 
-#: predicat.c:1202
+#: predicat.c:1203
 msgid "What was the victim of the verb?"
 msgstr ""
 
-#: predicat.c:1208
+#: predicat.c:1209
 msgid "What do you want to do with the verb?"
 msgstr ""
 
-#: predicat.c:1214
+#: predicat.c:1215
 msgid "What do you want to do the verb?"
 msgstr ""
 
-#: predicat.c:1410
+#: predicat.c:1411
 msgid "What pattern do you want to grep for?"
 msgstr ""
 
-#: predicat.c:1437
+#: predicat.c:1438
 #, c-format
 msgid "Matches of '%s' on %s(#%d): %s"
 msgstr ""
@@ -5286,94 +5352,94 @@
 msgid "killed %s!"
 msgstr ""
 
-#: rob.c:119
+#: rob.c:118
 #, c-format
 msgid "%s killed you!"
 msgstr ""
 
-#: rob.c:128
+#: rob.c:127
 #, c-format
 msgid "Your insurance policy pays %d %s."
 msgstr ""
 
-#: rob.c:132
+#: rob.c:131
 msgid "Your insurance policy has been revoked."
 msgstr ""
 
-#: rob.c:140
+#: rob.c:139
 msgid "Your murder attempt failed."
 msgstr ""
 
-#: rob.c:141
+#: rob.c:140
 #, c-format
 msgid "%s tried to kill you!"
 msgstr ""
 
-#: rob.c:185
+#: rob.c:184
 msgid "Buy from whom?"
 msgstr ""
 
-#: rob.c:192
+#: rob.c:191
 msgid "You can't buy from yourself!"
 msgstr ""
 
-#: rob.c:196
+#: rob.c:195
 msgid "There's nobody here to buy things from."
 msgstr ""
 
-#: rob.c:203
+#: rob.c:202
 msgid "Buy what?"
 msgstr ""
 
-#: rob.c:285
+#: rob.c:284
 #, c-format
 msgid "You buy a %s from %s."
 msgstr ""
 
-#: rob.c:289
+#: rob.c:288
 #, c-format
 msgid "buys a %s from %s."
 msgstr ""
 
-#: rob.c:307
+#: rob.c:306
 msgid "I can't find that item with that price here."
 msgstr ""
 
-#: rob.c:309
+#: rob.c:308
 #, c-format
 msgid "%s isn't selling that item for that price"
 msgstr ""
 
-#: rob.c:314
+#: rob.c:313
 msgid "I can't find that item here."
 msgstr ""
 
-#: rob.c:316
+#: rob.c:315
 #, c-format
 msgid "%s isn't selling that item."
 msgstr ""
 
-#: rob.c:319
+#: rob.c:318
 msgid "You can't afford that."
 msgstr ""
 
-#: rob.c:350 rob.c:359 rob.c:568
+#: rob.c:349 rob.c:358 rob.c:575
 msgid "Give to whom?"
 msgstr ""
 
-#: rob.c:381
+#: rob.c:380
 msgid "You can't give yourself away!"
 msgstr ""
 
-#: rob.c:386
+#: rob.c:385
 msgid "You can't give an object to itself!"
 msgstr ""
 
-#: rob.c:390
+#: rob.c:389
 msgid "You can't give that away."
 msgstr ""
 
-#: rob.c:395
+#: rob.c:394
 #, c-format
 msgid "%s doesn't want anything from you."
 msgstr ""
@@ -5412,54 +5478,54 @@
 msgid "You don't have that many %s to give!"
 msgstr ""
 
-#: rob.c:469
+#: rob.c:458 rob.c:473 rob.c:497
 #, c-format
 msgid "%s refuses your money."
 msgstr ""
 
-#: rob.c:488
+#: rob.c:492
 msgid "Feeling poor today?"
 msgstr ""
 
-#: rob.c:495
+#: rob.c:502
 #, c-format
 msgid "You get %d in change."
 msgstr ""
 
-#: rob.c:497
+#: rob.c:504
 #, c-format
 msgid "You paid %d %s."
 msgstr ""
 
-#: rob.c:512
+#: rob.c:519
 #, c-format
 msgid "You give %d %s to %s."
 msgstr ""
 
-#: rob.c:515
+#: rob.c:522
 #, c-format
 msgid "You took %d %s from %s!"
 msgstr ""
 
-#: rob.c:520
+#: rob.c:527
 #, c-format
 msgid "%s gives you %d %s."
 msgstr ""
 
-#: rob.c:523
+#: rob.c:530
 #, c-format
 msgid "%s took %d %s from you!"
 msgstr ""
 
-#: rob.c:552
+#: rob.c:559
 msgid "Did you want to give something *to* someone?"
 msgstr ""
 
-#: rob.c:559
+#: rob.c:566
 msgid "Give what?"
 msgstr ""
 
-#: rob.c:575
+#: rob.c:582
 msgid "I don't know what you mean."
 msgstr ""
 
@@ -5525,230 +5591,230 @@
 "@power privileges."
 msgstr ""
 
-#: set.c:370
+#: set.c:371
 msgid "That object is already in that zone."
 msgstr ""
 
-#: set.c:380
+#: set.c:381
 msgid "You don't have the power to shift reality."
 msgstr ""
 
-#: set.c:393
+#: set.c:394
 msgid "You cannot move that object to that zone."
 msgstr ""
 
-#: set.c:399
+#: set.c:400
 msgid "You shouldn't zone objects to themselves!"
 msgstr ""
 
-#: set.c:408
+#: set.c:409
 msgid "You can't make circular zones!"
 msgstr ""
 
-#: set.c:415
+#: set.c:416
 msgid "Overly deep zone chain."
 msgstr ""
 
-#: set.c:431
+#: set.c:432
 msgid "Warning: @chzoning admin-owned object!"
 msgstr ""
 
-#: set.c:451
+#: set.c:456
 msgid "Warning: @chzoning a privileged player."
 msgstr ""
 
-#: set.c:453
+#: set.c:458
 msgid "Warning: @chzoning a TRUST player."
 msgstr ""
 
-#: set.c:457
+#: set.c:462
 msgid "Zone changed."
 msgstr ""
 
-#: set.c:484
+#: set.c:489
 #, c-format
 msgid "You cannot change that flag on %s/%s"
 msgstr ""
 
-#: set.c:493
+#: set.c:498
 #, c-format
 msgid "%s/%s - %s reset."
 msgstr ""
 
-#: set.c:499
+#: set.c:504
 #, c-format
 msgid "%s/%s - %s set."
 msgstr ""
 
-#: set.c:513
+#: set.c:518
 #, c-format
 msgid "You cannot set attrib flags on %s/%s"
 msgstr ""
 
-#: set.c:538
+#: set.c:543
 msgid "What flag do you want to set?"
 msgstr ""
 
-#: set.c:549
+#: set.c:554
 msgid "Unrecognized attribute flag."
 msgstr ""
 
-#: set.c:555
+#: set.c:560
 msgid "No attribute found to change."
 msgstr ""
 
-#: set.c:584
+#: set.c:589
 msgid "What do you want to set?"
 msgstr ""
 
-#: set.c:606
+#: set.c:611
 msgid "Only God can set himself!"
 msgstr ""
 
-#: set.c:613
+#: set.c:618
 msgid "You may not set attributes."
 msgstr ""
 
-#: set.c:622
+#: set.c:627
 msgid "You must specify a flag to set."
 msgstr ""
 
-#: set.c:664
+#: set.c:669
 msgid "What do you want to copy from?"
 msgstr ""
 
-#: set.c:671
+#: set.c:676
 msgid "What object do you want to copy the attribute from?"
 msgstr ""
 
-#: set.c:684
+#: set.c:689
 msgid "No such attribute to copy from."
 msgstr ""
 
-#: set.c:689
+#: set.c:694
 msgid "Permission to read attribute denied."
 msgstr ""
 
-#: set.c:698
+#: set.c:703
 msgid "What do you want to copy to?"
 msgstr ""
 
-#: set.c:722
+#: set.c:727
 #, c-format
 msgid "Attribute %s (%d copies)"
 msgstr ""
 
-#: set.c:723
+#: set.c:728
 msgid "moved"
 msgstr ""
 
-#: set.c:723
+#: set.c:728
 msgid "copied"
 msgstr ""
 
-#: set.c:727
+#: set.c:732
 #, c-format
 msgid "Unable to %s attribute."
 msgstr ""
 
-#: set.c:728
+#: set.c:733
 msgid "move"
 msgstr ""
 
-#: set.c:728
+#: set.c:733
 msgid "copy"
 msgstr ""
 
-#: set.c:766
+#: set.c:771
 msgid "No such attribute, try set instead."
 msgstr ""
 
-#: set.c:770
+#: set.c:775
 msgid "You need to control an attribute to edit it."
 msgstr ""
 
-#: set.c:878 set.c:880 set.c:885 set.c:887
+#: set.c:880 set.c:882 set.c:887 set.c:889
 #, c-format
 msgid "%s - Set: %s"
 msgstr ""
 
-#: set.c:911 set.c:917
+#: set.c:913 set.c:919
 msgid "I need to know what you want to edit."
 msgstr ""
 
-#: set.c:927
+#: set.c:930
 msgid "Nothing to do."
 msgstr ""
 
-#: set.c:958
+#: set.c:961
 msgid "I need to know what attribute to trigger."
 msgstr ""
 
-#: set.c:973
+#: set.c:976
 msgid "You can't trigger God!"
 msgstr ""
 
-#: set.c:982
+#: set.c:985
 #, c-format
 msgid "%s - Triggered."
 msgstr ""
 
-#: set.c:1008
+#: set.c:1011
 msgid "I need to know what attribute to include."
 msgstr ""
 
-#: set.c:1019
+#: set.c:1022
 msgid "You can't include God!"
 msgstr ""
 
-#: set.c:1054
+#: set.c:1058
 msgid "Used."
 msgstr ""
 
-#: set.c:1105
+#: set.c:1110
 msgid "A thing cannot be its own ancestor!"
 msgstr ""
 
-#: set.c:1112
+#: set.c:1117
 msgid "You are not allowed to be your own ancestor!"
 msgstr ""
 
-#: set.c:1117
+#: set.c:1122
 msgid "Too many ancestors."
 msgstr ""
 
-#: set.c:1124
+#: set.c:1129
 msgid "Parent changed."
 msgstr ""
 
-#: set.c:1148
+#: set.c:1153
 #, c-format
 msgid "Unable to wipe attribute %s"
 msgstr ""
 
-#: set.c:1153
+#: set.c:1158
 #, c-format
 msgid "Attribute %s cannot be wiped because a child attribute cannot be wiped."
 msgstr ""
 
-#: set.c:1190
+#: set.c:1195
 msgid "That object is protected."
 msgstr ""
 
-#: set.c:1197
+#: set.c:1202
 msgid "No attributes wiped."
 msgstr ""
 
-#: set.c:1200
+#: set.c:1205
 msgid "One attribute wiped."
 msgstr ""
 
-#: set.c:1203
+#: set.c:1208
 #, c-format
 msgid "%d attributes wiped."
 msgstr ""
 
-#: speech.c:115 speech.c:155 speech.c:600 speech.c:1315
+#: speech.c:115 speech.c:157 speech.c:614 speech.c:1342
 msgid "You may not speak here!"
 msgstr ""
 
@@ -5765,194 +5831,194 @@
 msgid "%s types --> %s%s%s"
 msgstr ""
 
-#: speech.c:163
+#: speech.c:173
 #, c-format
 msgid "You say, \"%s\""
 msgstr ""
 
-#: speech.c:165
+#: speech.c:175
 #, c-format
 msgid "%s says, \"%s\""
 msgstr ""
 
-#: speech.c:213
+#: speech.c:224
 msgid "I can't find that room."
 msgstr ""
 
-#: speech.c:218 speech.c:1349 speech.c:1411
+#: speech.c:229 speech.c:1385 speech.c:1447
 msgid "You may not speak there!"
 msgstr ""
 
-#: speech.c:249
+#: speech.c:260
 msgid "Too many people to oemit to."
 msgstr ""
 
-#: speech.c:294
+#: speech.c:305
 msgid "Whisper to whom?"
 msgstr ""
 
-#: speech.c:298
+#: speech.c:309
 msgid "Whisper what?"
 msgstr ""
 
-#: speech.c:332
+#: speech.c:343
 #, c-format
 msgid "%s can't hear you."
 msgstr ""
 
-#: speech.c:337
+#: speech.c:348
 msgid "Too many people to whisper to."
 msgstr ""
 
-#: speech.c:345
+#: speech.c:356
 #, c-format
 msgid "Unable to whisper to:%s"
 msgstr ""
 
-#: speech.c:358 wiz.c:1278
+#: speech.c:369 wiz.c:1286
 msgid " to "
 msgstr ""
 
-#: speech.c:368
+#: speech.c:379
 #, c-format
 msgid "%s sense: %s%s%s"
 msgstr ""
 
-#: speech.c:369
+#: speech.c:380
 #, c-format
 msgid "%s senses: %s%s%s"
 msgstr ""
 
-#: speech.c:372
+#: speech.c:383
 #, c-format
 msgid "You whisper, \"%s\"%s."
 msgstr ""
 
-#: speech.c:373
+#: speech.c:384
 #, c-format
 msgid "%s whispers%s: %s"
 msgstr ""
 
-#: speech.c:386
+#: speech.c:397
 #, c-format
 msgid "%s whispers%s."
 msgstr ""
 
-#: speech.c:561 speech.c:1346
+#: speech.c:572 speech.c:1382
 #, c-format
 msgid "I'm sorry, but %s wishes to be left alone now."
 msgstr ""
 
-#: speech.c:632
+#: speech.c:656
 msgid "Posing as a wizard could be hazardous to your health."
 msgstr ""
 
-#: speech.c:653
+#: speech.c:677
 msgid "What did you want to say?"
 msgstr ""
 
-#: speech.c:678
+#: speech.c:702
 msgid "shouts"
 msgstr ""
 
-#: speech.c:678
+#: speech.c:702
 msgid "says"
 msgstr ""
 
-#: speech.c:810
+#: speech.c:834
 msgid "You haven't paged anyone since connecting."
 msgstr ""
 
-#: speech.c:816
+#: speech.c:840
 #, c-format
 msgid "You last paged %s."
 msgstr ""
 
-#: speech.c:830
+#: speech.c:854
 msgid "Try again after you get the pemit_all power."
 msgstr ""
 
-#: speech.c:842
+#: speech.c:866
 #, c-format
 msgid "I can't find who you're trying to page with: %s"
 msgstr ""
 
-#: speech.c:848
+#: speech.c:872
 #, c-format
 msgid "I'm not sure who you want to page with: %s"
 msgstr ""
 
-#: speech.c:858
+#: speech.c:882
 #, c-format
 msgid "%s is not connected."
 msgstr ""
 
-#: speech.c:865
+#: speech.c:889
 #, c-format
 msgid "%s is not accepting any pages."
 msgstr ""
 
-#: speech.c:870
+#: speech.c:894
 #, c-format
 msgid "%s is not accepting your pages."
 msgstr ""
 
-#: speech.c:893
+#: speech.c:917
 msgid "You're trying to page too many people at once."
 msgstr ""
 
-#: speech.c:908
+#: speech.c:932
 #, c-format
 msgid "Unable to page:%s"
 msgstr ""
 
-#: speech.c:938
+#: speech.c:962
 msgid "You are set HAVEN and cannot receive pages."
 msgstr ""
 
-#: speech.c:989
+#: speech.c:1013
 msgid "From afar"
 msgstr ""
 
-#: speech.c:991
+#: speech.c:1015
 msgid " (to "
 msgstr ""
 
-#: speech.c:1000
+#: speech.c:1024
 msgid " pages"
 msgstr ""
 
-#: speech.c:1134
+#: speech.c:1158
 msgid "From "
 msgstr ""
 
-#: speech.c:1340
+#: speech.c:1376
 msgid "I can't find that."
 msgstr ""
 
-#: speech.c:1343
+#: speech.c:1379
 msgid "There can't be anything in that!"
 msgstr ""
 
-#: speech.c:1355
+#: speech.c:1391
 #, c-format
 msgid "You remit, \"%s\" in %s"
 msgstr ""
 
-#: speech.c:1408
+#: speech.c:1444
 msgid "Too many containers."
 msgstr ""
 
-#: speech.c:1416
+#: speech.c:1452
 #, c-format
 msgid "You lemit: \"%s\""
 msgstr ""
 
-#: speech.c:1476
+#: speech.c:1512
 msgid "Invalid zone."
 msgstr ""
 
-#: speech.c:1485
+#: speech.c:1521
 #, c-format
 msgid "You zemit, \"%s\" in zone %s"
 msgstr ""
@@ -5994,7 +6060,7 @@
 msgid "Row %d: NULL"
 msgstr ""
 
-#: timer.c:257
+#: timer.c:261
 msgid "Your ON-VACATION flag is set! If you're back, clear it."
 msgstr ""
 
@@ -6145,490 +6211,511 @@
 msgid "@wcheck complete."
 msgstr ""
 
-#: wiz.c:117
+#: wiz.c:119
 msgid "You do not have the power over body and mind!"
 msgstr ""
 
-#: wiz.c:129
+#: wiz.c:131
 #, c-format
 msgid "Failure creating '%s' (bad name)"
 msgstr ""
 
-#: wiz.c:133
+#: wiz.c:135
 #, c-format
 msgid "Failure creating '%s' (bad password)"
 msgstr ""
 
-#: wiz.c:137
+#: wiz.c:139
 #, c-format
 msgid "New player '%s' (#%d) created with password '%s'"
 msgstr ""
 
-#: wiz.c:164 wiz.c:782
+#: wiz.c:166 wiz.c:784
 msgid "No such player."
 msgstr ""
 
-#: wiz.c:171
+#: wiz.c:173
 msgid "Only wizards may change a quota."
 msgstr ""
 
-#: wiz.c:175
+#: wiz.c:177
 msgid "You can't look at someone else's quota."
 msgstr ""
 
-#: wiz.c:189
+#: wiz.c:191
 #, c-format
 msgid "Objects: %d   Limit: UNLIMITED"
 msgstr ""
 
-#: wiz.c:198 wiz.c:204 wiz.c:218
+#: wiz.c:200 wiz.c:206 wiz.c:220
 #, c-format
 msgid "Objects: %d   Limit: %d"
 msgstr ""
 
-#: wiz.c:205
+#: wiz.c:207
 msgid "What do you want to set the quota to?"
 msgstr ""
 
-#: wiz.c:237
+#: wiz.c:239
 msgid "Who do you think you are, GOD?"
 msgstr ""
 
-#: wiz.c:243
+#: wiz.c:245
 msgid "You can only set quotas to a number."
 msgstr ""
 
-#: wiz.c:248
+#: wiz.c:250
 msgid "You can only set quotas to a positive number."
 msgstr ""
 
-#: wiz.c:268
+#: wiz.c:270
 #, c-format
 msgid "%s: Objects: %d   Limit: UNLIMITED"
 msgstr ""
 
-#: wiz.c:274
+#: wiz.c:276
 #, c-format
 msgid "%s: Objects: %d   Limit: %d"
 msgstr ""
 
-#: wiz.c:285
+#: wiz.c:287
 msgid "Quotas not changed."
 msgstr ""
 
-#: wiz.c:287
+#: wiz.c:289
 #, c-format
 msgid "All quotas changed to %d."
 msgstr ""
 
-#: wiz.c:374
+#: wiz.c:376
 msgid "You can't teleport rooms."
 msgstr ""
 
-#: wiz.c:378
+#: wiz.c:380
 msgid "Garbage belongs in the garbage dump."
 msgstr ""
 
-#: wiz.c:402
+#: wiz.c:404
 msgid "I don't know which destination you mean!"
 msgstr ""
 
-#: wiz.c:425
+#: wiz.c:427
 msgid "Exits can only be teleported to other rooms."
 msgstr ""
 
-#: wiz.c:430
+#: wiz.c:432
 msgid "You can't move an exit to someplace that's crumbling."
 msgstr ""
 
-#: wiz.c:451 wiz.c:560
+#: wiz.c:453 wiz.c:562
 msgid "Teleported."
 msgstr ""
 
-#: wiz.c:472
+#: wiz.c:474
 msgid "You're in the Void. This is not a good thing."
 msgstr ""
 
-#: wiz.c:484
+#: wiz.c:486
 msgid "What are you doing inside of yourself?"
 msgstr ""
 
-#: wiz.c:494
+#: wiz.c:496
 msgid "You're in the void - sending you home."
 msgstr ""
 
-#: wiz.c:502
+#: wiz.c:504
 msgid "You're in too many containers."
 msgstr ""
 
-#: wiz.c:517 wiz.c:525
+#: wiz.c:519 wiz.c:527
 msgid "Teleports are not allowed in this room."
 msgstr ""
 
-#: wiz.c:538
+#: wiz.c:540
 msgid "You may not teleport out of the zone from this room."
 msgstr ""
 
-#: wiz.c:579
+#: wiz.c:581
 #, c-format
 msgid "%s tries to impose his will on you and fails."
 msgstr ""
 
-#: wiz.c:617
+#: wiz.c:619
 msgid "You can't force God!"
 msgstr ""
 
-#: wiz.c:731 wiz.c:1987
+#: wiz.c:733 wiz.c:2009
 msgid "You need a search warrant to do that!"
 msgstr ""
 
-#: wiz.c:739
+#: wiz.c:741
 #, c-format
 msgid "%d objects = %d rooms, %d exits, %d things, %d players, %d garbage."
 msgstr ""
 
-#: wiz.c:743
+#: wiz.c:745
 #, c-format
 msgid "The next object to be created will be #%d."
 msgstr ""
 
-#: wiz.c:747
+#: wiz.c:749
 #, c-format
 msgid "%d objects = %d rooms, %d exits, %d things, %d players."
 msgstr ""
 
-#: wiz.c:785
+#: wiz.c:787
 msgid "Bad password."
 msgstr ""
 
-#: wiz.c:787
+#: wiz.c:789
 msgid "You cannot change that player's password."
 msgstr ""
 
-#: wiz.c:791
+#: wiz.c:793
 #, c-format
 msgid "Password for %s changed."
 msgstr ""
 
-#: wiz.c:792
+#: wiz.c:794
 #, c-format
 msgid "Your password has been changed by %s."
 msgstr ""
 
-#: wiz.c:819
+#: wiz.c:821
 msgid "No such connected player."
 msgstr ""
 
-#: wiz.c:830
+#: wiz.c:832
 msgid "Invalid port."
 msgstr ""
 
-#: wiz.c:836
+#: wiz.c:838
 msgid "There is noone connected on that descriptor."
 msgstr ""
 
-#: wiz.c:838 wiz.c:855
+#: wiz.c:840 wiz.c:857
 msgid "You can't boot other people!"
 msgstr ""
 
-#: wiz.c:843
+#: wiz.c:845
 msgid "If you want to quit, use QUIT."
 msgstr ""
 
-#: wiz.c:864
+#: wiz.c:866
 msgid "You boot a duplicate self."
 msgstr ""
 
-#: wiz.c:866 wiz.c:880
+#: wiz.c:868 wiz.c:882
 #, c-format
 msgid "You booted %s off!"
 msgstr ""
 
-#: wiz.c:868
+#: wiz.c:870
 #, c-format
 msgid "You booted unconnected port %s!"
 msgstr ""
 
-#: wiz.c:886
+#: wiz.c:888
 msgid "None of your connections are idle. If you want to quit, use QUIT."
 msgstr ""
 
-#: wiz.c:911
+#: wiz.c:913
 msgid "Try asking them first!"
 msgstr ""
 
-#: wiz.c:941
+#: wiz.c:944
 #, c-format
 msgid "Ownership changed for %d objects."
 msgstr ""
 
-#: wiz.c:961
+#: wiz.c:964
 msgid "You do not have the power to change reality."
 msgstr ""
 
-#: wiz.c:969
+#: wiz.c:973
 msgid "No zone specified."
 msgstr ""
 
-#: wiz.c:977
+#: wiz.c:981
 msgid "I can't seem to find that."
 msgstr ""
 
-#: wiz.c:993
+#: wiz.c:997
 #, c-format
 msgid "Zone changed for %d objects."
 msgstr ""
 
-#: wiz.c:1017
+#: wiz.c:1021
 msgid "How many commands do you want to execute?"
 msgstr ""
 
-#: wiz.c:1023
+#: wiz.c:1027
 msgid "Number out of range."
 msgstr ""
 
-#: wiz.c:1028
+#: wiz.c:1032
 #, c-format
 msgid "%d commands executed."
 msgstr ""
 
-#: wiz.c:1052
+#: wiz.c:1056
 #, c-format
 msgid "Flags value: %s"
 msgstr ""
 
-#: wiz.c:1054
+#: wiz.c:1058
 #, c-format
 msgid "Powers value: %s"
 msgstr ""
 
-#: wiz.c:1057
+#: wiz.c:1061
 #, c-format
 msgid "Next: %d"
 msgstr ""
 
-#: wiz.c:1058
+#: wiz.c:1062
 #, c-format
 msgid "Contents: %d"
 msgstr ""
 
-#: wiz.c:1059
+#: wiz.c:1063
 #, c-format
 msgid "Pennies: %d"
 msgstr ""
 
-#: wiz.c:1065
+#: wiz.c:1069
 #, c-format
 msgid "Location: %d"
 msgstr ""
 
-#: wiz.c:1066
+#: wiz.c:1070
 #, c-format
 msgid "Home: %d"
 msgstr ""
 
-#: wiz.c:1069
+#: wiz.c:1073
 #, c-format
 msgid "Destination: %d"
 msgstr ""
 
-#: wiz.c:1070
+#: wiz.c:1074
 #, c-format
 msgid "Source: %d"
 msgstr ""
 
-#: wiz.c:1073
+#: wiz.c:1077
 #, c-format
 msgid "Drop-to: %d"
 msgstr ""
 
-#: wiz.c:1074
+#: wiz.c:1078
 #, c-format
 msgid "Exits: %d"
 msgstr ""
 
-#: wiz.c:1079
+#: wiz.c:1083
 msgid "Bad object type."
 msgstr ""
 
-#: wiz.c:1108
+#: wiz.c:1112
 msgid "Only wizards may grant powers."
 msgstr ""
 
-#: wiz.c:1115
+#: wiz.c:1119
 msgid "You can't grant powers to unregistered players."
 msgstr ""
 
-#: wiz.c:1119
+#: wiz.c:1123
 msgid "God is already all-powerful."
 msgstr ""
 
-#: wiz.c:1126
+#: wiz.c:1130
 msgid "You must specify a power to set."
 msgstr ""
 
-#: wiz.c:1251
+#: wiz.c:1259
 msgid ""
 "\n"
 "ROOMS:"
 msgstr ""
 
-#: wiz.c:1254 wiz.c:1291
+#: wiz.c:1262 wiz.c:1299
 #, c-format
 msgid "%s [owner: "
 msgstr ""
 
-#: wiz.c:1266
+#: wiz.c:1274
 msgid ""
 "\n"
 "EXITS:"
 msgstr ""
 
-#: wiz.c:1274
+#: wiz.c:1282
 #, c-format
 msgid "%s [from "
 msgstr ""
 
-#: wiz.c:1276 wiz.c:1279
+#: wiz.c:1284 wiz.c:1287
 msgid "NOWHERE"
 msgstr ""
 
-#: wiz.c:1288
+#: wiz.c:1296
 msgid ""
 "\n"
 "THINGS:"
 msgstr ""
 
-#: wiz.c:1302
+#: wiz.c:1310
 msgid ""
 "\n"
 "PLAYERS:"
 msgstr ""
 
-#: wiz.c:1308
+#: wiz.c:1316
 #, c-format
 msgid " [location: %s]"
 msgstr ""
 
-#: wiz.c:1315
+#: wiz.c:1324
+msgid ""
+"\n"
+"GARBAGE:"
+msgstr ""
+
+#: wiz.c:1328
+#, c-format
+msgid "%sGarbage%s(#%d)"
+msgstr ""
+
+#: wiz.c:1331
+#, c-format
+msgid "Garbage(#%d)"
+msgstr ""
+
+#: wiz.c:1335
 msgid "----------  Search Done  ----------"
 msgstr ""
 
-#: wiz.c:1403
+#: wiz.c:1339
+#, c-format
+msgid "Totals: Rooms...%d  Exits...%d  Things...%d  Players...%d  Garbage...%d"
+msgstr ""
+
+#: wiz.c:1430
 msgid "You can't see someone else's quota!"
 msgstr ""
 
-#: wiz.c:1440 wiz.c:1546
+#: wiz.c:1467 wiz.c:1581
 msgid "Your delusions of grandeur have been noted."
 msgstr ""
 
-#: wiz.c:1448
+#: wiz.c:1475
 msgid "What site did you want to lock?"
 msgstr ""
 
-#: wiz.c:1453
+#: wiz.c:1480
 msgid "No valid options found."
 msgstr ""
 
-#: wiz.c:1459
+#: wiz.c:1486
 msgid "Who do you want to lock?"
 msgstr ""
 
-#: wiz.c:1468
+#: wiz.c:1495
 #, c-format
 msgid "Site %s access options for %s(%s) set to %s"
 msgstr ""
 
-#: wiz.c:1474
+#: wiz.c:1501
 #, c-format
 msgid "Site %s access options set to %s"
 msgstr ""
 
-#: wiz.c:1493
+#: wiz.c:1521 wiz.c:1528
 #, c-format
 msgid "Site %s locked"
 msgstr ""
 
-#: wiz.c:1500
+#: wiz.c:1535
 #, c-format
 msgid "Site %s banned"
 msgstr ""
 
-#: wiz.c:1524
+#: wiz.c:1559
 #, c-format
 msgid "%d sitelocks removed."
 msgstr ""
 
-#: wiz.c:1555
+#: wiz.c:1590
 msgid "Unable to open names file."
 msgstr ""
 
-#: wiz.c:1557
+#: wiz.c:1592
 msgid "Any name matching these wildcard patterns is banned:"
 msgstr ""
 
-#: wiz.c:1570 wiz.c:1591 wiz.c:1595
+#: wiz.c:1605 wiz.c:1626 wiz.c:1630
 msgid "Unable to delete name."
 msgstr ""
 
-#: wiz.c:1588
+#: wiz.c:1623
 msgid "Name removed."
 msgstr ""
 
-#: wiz.c:1599 wiz.c:1631
+#: wiz.c:1634 wiz.c:1666
 msgid "Unable to lock name."
 msgstr ""
 
-#: wiz.c:1628
+#: wiz.c:1663
 #, c-format
 msgid "Name %s locked."
 msgstr ""
 
-#: wiz.c:1763
+#: wiz.c:1798
 msgid "Unknown owner."
 msgstr ""
 
-#: wiz.c:1768
+#: wiz.c:1803
 msgid "Invalid search class+restriction format."
 msgstr ""
 
-#: wiz.c:1839
+#: wiz.c:1874
 msgid "Unknown type."
 msgstr ""
 
-#: wiz.c:1860
+#: wiz.c:1895
 msgid "Invalid start index"
 msgstr ""
 
-#: wiz.c:1866
+#: wiz.c:1901
 msgid "Invalid count index"
 msgstr ""
 
-#: wiz.c:1875 wiz.c:1880
+#: wiz.c:1910 wiz.c:1915
 msgid "Unknown parent."
 msgstr ""
 
-#: wiz.c:1889 wiz.c:1894
+#: wiz.c:1924 wiz.c:1929
 msgid "Unknown zone."
 msgstr ""
 
-#: wiz.c:1921
+#: wiz.c:1956
 msgid "You must give a list of power names."
 msgstr ""
 
-#: wiz.c:1928
+#: wiz.c:1963
 msgid "You must give a string of flag characters."
 msgstr ""
 
-#: wiz.c:1935
+#: wiz.c:1970
 msgid "You must give a list of flag names."
 msgstr ""
 
-#: wiz.c:1940
+#: wiz.c:1975
 msgid "Unknown search class."
 msgstr ""
 
-#: wiz.c:1975
+#: wiz.c:2020
 #, c-format
 msgid "Searches cost %d %s."
 msgstr ""
Index: po/de_DE.pox
===================================================================
--- po/de_DE.pox	(.../184p0)	(revision 575)
+++ po/de_DE.pox	(.../184p1)	(revision 575)
@@ -55,10 +55,6 @@
 msgid " convtime() is stricter."
 msgstr " convtime() ist strenger."
 
-#: flags.c:1531
-msgid " granted."
-msgstr " erteilt."
-
 #: src/look.c:688 src/look.c:770
 msgid " is owned by "
 msgstr " gehrt "
Index: po/hr_HR.pox
===================================================================
--- po/hr_HR.pox	(.../184p0)	(revision 575)
+++ po/hr_HR.pox	(.../184p1)	(revision 575)
@@ -148,10 +148,6 @@
 msgid " convtime() is stricter."
 msgstr " convtime() je stroi."
 
-#: flags.c:1531
-msgid " granted."
-msgstr " - dano."
-
 #: src/look.c:688 src/look.c:770
 msgid " is owned by "
 msgstr " je vlasnitvo igraa koji se zove "
@@ -160,10 +156,6 @@
 msgid " pages"
 msgstr " alje poruku"
 
-#: flags.c:1531
-msgid " removed."
-msgstr " - uklonjeno."
-
 #: flags.c:764
 msgid " reset."
 msgstr " resetirano."
@@ -457,6 +449,10 @@
 msgid "#-1 INVALID SECOND ARGUMENT"
 msgstr "#-1 NEISPRAVNI DRUGI ARGUMENT"
 
+#: fundb.c:2124
+msgid "#-1 INVALID SOURCE ROOM"
+msgstr "#-1 NEISPRAVNA POLAZINA SOBA"
+
 #: funstr.c:369 funstr.c:425
 msgid "#-1 INVALID THIRD ARGUMENT"
 msgstr "#-1 NEISPRAVAN TREI ARGUMENT"
@@ -802,6 +798,26 @@
 msgid "%s (this room) [speech]."
 msgstr "%s (ova soba) [govor]."
 
+#: flags.c:1714
+#, c-format
+msgid "%s - %s (already) granted."
+msgstr "%s - %s (ve) dano."
+
+#: flags.c:1710
+#, c-format
+msgid "%s - %s (already) removed."
+msgstr "%s - %s (ve) uklonjeno."
+
+#: flags.c:1716
+#, c-format
+msgid "%s - %s granted."
+msgstr "%s - %s dano."
+
+#: flags.c:1708
+#, c-format
+msgid "%s - %s removed."
+msgstr "%s - %s uklonjeno."
+
 #: flags.c:1357
 #, c-format
 msgid "%s - I don't recognize that flag."
@@ -922,6 +938,16 @@
 msgid "%s doesn't know switch %s."
 msgstr "%s ne poznaje switch %s."
 
+#: rob.c:395
+#, c-format
+msgid "%s doesn't want anything from you."
+msgstr "%s ne eli nita od tebe."
+
+#: rob.c:400
+#, c-format
+msgid "%s doesn't want that."
+msgstr "%s to ne eli."
+
 #: move.c:641 move.c:644
 #, c-format
 msgid "%s drops you."
@@ -1312,6 +1338,11 @@
 msgid "%s: Objects: %d   Limit: UNLIMITED"
 msgstr "%s: Objekti: %d Granica: NEOGRANIENO"
 
+#: wiz.c:1327
+#, c-format
+msgid "%sGarbage%s(#%d)"
+msgstr "%sOtpad%s(#%d)"
+
 #: attrib.c:1566 attrib.c:1584
 #, c-format
 msgid "'%s' contains too many aliases."
@@ -1322,6 +1353,11 @@
 msgid "'%s' is not a valid alias."
 msgstr "'%s' nije ispravan alias."
 
+#: attrib.c:1851
+#, c-format
+msgid "'%s' is not a valid exit name."
+msgstr "'%s' nije ispravno ime izlaza."
+
 #: function.c:905
 msgid "(Commas okay in last argument)"
 msgstr "(zarezi u zadnjem argumentu su okej)"
@@ -1451,6 +1487,10 @@
 msgid "Alias Description"
 msgstr "Opis aliasa"
 
+#: function.c:1094
+msgid "Alias added."
+msgstr "Alias dodan."
+
 #: src/attrib.c:939
 msgid "Alias removed."
 msgstr "Alias obrisan."
@@ -2024,6 +2064,10 @@
 msgid "Command %s already exists."
 msgstr "Naredba %s ve postoji."
 
+#: command.c:1683
+msgid "Command cloned."
+msgstr "Naredba klonirana."
+
 #: command.c:1818
 #, c-format
 msgid "Commands: %s"
@@ -2340,6 +2384,11 @@
 msgid "Fixing mail for #%d."
 msgstr "Popravljam potu za #%d."
 
+#: command.c:1922
+#, c-format
+msgid "Flags      : %s"
+msgstr "Flagovi    : %s"
+
 #: function.c:897
 #, c-format
 msgid "Flags     : %s"
@@ -2405,6 +2454,14 @@
 msgid "Function added."
 msgstr "Funkcija dodana."
 
+#: function.c:1614
+msgid "Function alias deleted."
+msgstr "Alias za funkciju uklonjen."
+
+#: function.c:1053
+msgid "Function cloned."
+msgstr "Funkcija klonirana."
+
 #: src/function.c:802
 msgid "Function deleted."
 msgstr "Funkcija obrisana."
@@ -2537,6 +2594,11 @@
 msgid "Garbage is garbage."
 msgstr "Otpad je otpad."
 
+#: wiz.c:1329
+#, c-format
+msgid "Garbage(#%d)"
+msgstr "Otpad(#%d)"
+
 #: src/set.c:82
 msgid "Give it what new name?"
 msgstr "Kako bi glasilo novo ime?"
@@ -2894,6 +2956,21 @@
 msgid "Inspecting ansi string"
 msgstr "Provjeravam ansi tekst"
 
+#: flags.c:1534 flags.c:1697
+#, c-format
+msgid "Internal error: Unable to find flagspace '%s'!"
+msgstr "Unutarnja greka: Ne mogu nai flagovski prostor '%s'!"
+
+#: flags.c:2325
+#, c-format
+msgid "Internal error: Unknown flag space '%s'!"
+msgstr "Unutarnja greka: Nepoznati flagovski prostor '%s'!"
+
+#: flags.c:2515
+#, c-format
+msgid "Internal error: Unknown flagspace '%s'!"
+msgstr "Unutarnja greka: Nepoznati flagovski prostor '%s'!"
+
 #: create.c:373
 msgid "Internal error: weird object type."
 msgstr "Unutarnja greka: udan tip objekta."
@@ -2919,6 +2996,10 @@
 msgid "Invalid dbref #%d in %s."
 msgstr "Neispravan dbref #%d na lokaciji %s."
 
+#: function.c:1046 function.c:1087 function.c:1437
+msgid "Invalid function name."
+msgstr "Neispravno ime funkcije."
+
 #: command.c:1735
 msgid "Invalid hook object."
 msgstr "Neispravan objekt za hook."
@@ -3089,6 +3170,11 @@
 msgid "Location: %s"
 msgstr "Lokacija: %s"
 
+#: command.c:1814
+#, c-format
+msgid "Lock       : %s"
+msgstr "Brava      : %s"
+
 #: cmds.c:466
 msgid "Locks"
 msgstr "Brave"
@@ -3195,6 +3281,10 @@
 msgid "MAIL: All messages in all folders cleared."
 msgstr "POTA: Obrisane sve poruke u svim folderima."
 
+#: extmail.c:481
+msgid "MAIL: All messages in all folders marked as read."
+msgstr "POTA: Sve poruke u svim folderima oznaene kao proitane."
+
 #: extmail.c:428
 msgid "MAIL: All messages in all folders tagged."
 msgstr "POTA: Sve poruke u svim folderima oznaene."
@@ -3203,6 +3293,10 @@
 msgid "MAIL: All messages in all folders uncleared."
 msgstr "POTA: Poniteno brisanje svih poruka u svim folderima."
 
+#: extmail.c:479
+msgid "MAIL: All messages in all folders unread."
+msgstr "POTA: Sve poruke u svim folderima oznaene kao neproitane."
+
 #: extmail.c:426
 msgid "MAIL: All messages in all folders untagged."
 msgstr "POTA: Sve poruke u svim folderima od-oznaene."
@@ -3324,6 +3418,11 @@
 msgid "MAIL: Msg #%d:%d cleared."
 msgstr "POTA: Poruka #%d:%d obrisana."
 
+#: extmail.c:489
+#, c-format
+msgid "MAIL: Msg #%d:%d marked as read"
+msgstr "POTA: Poruka #%d:%d oznaena kao proitana"
+
 #: extmail.c:436
 #, c-format
 msgid "MAIL: Msg #%d:%d tagged"
@@ -3334,6 +3433,11 @@
 msgid "MAIL: Msg #%d:%d uncleared."
 msgstr "POTA: Poruka #%d:%d od-obrisana."
 
+#: extmail.c:487
+#, c-format
+msgid "MAIL: Msg #%d:%d unread"
+msgstr "POTA: Poruka #%d:%d oznaena kao neproitana"
+
 #: extmail.c:433
 #, c-format
 msgid "MAIL: Msg #%d:%d untagged"
@@ -3411,6 +3515,10 @@
 msgid "MAIL: To whom should I forward?"
 msgstr "POTA: Kome bih trebao proslijediti potu?"
 
+#: extmail.c:420
+msgid "MAIL: Unknown status."
+msgstr "POTA: Nepoznato stanje."
+
 #: src/extmail.c:378
 #, c-format
 msgid "MAIL: Unread Msg #%d:%d cleared! Use @mail/unclear %d:%d to recover."
@@ -3425,6 +3533,10 @@
 msgid "MAIL: What alias do you want to create?"
 msgstr "POTA: Koji alias eli stvoriti?"
 
+#: extmail.c:409
+msgid "MAIL: What do you want to do with the messages?"
+msgstr "POTA: to eli napraviti s tim porukama?"
+
 #: src/extmail.c:239 src/extmail.c:279
 msgid "MAIL: What folder is that?"
 msgstr "POTA: Koji je to folder?"
@@ -3877,6 +3989,10 @@
 msgid "Only wizards may grant powers."
 msgstr "Samo arobnjaci mogu davati moi."
 
+#: create.c:187
+msgid "Open from where?"
+msgstr "Otvoriti odakle?"
+
 #: src/create.c:118
 msgid "Open where?"
 msgstr "Prema kamo da otvorim izlaz?"
@@ -4222,6 +4338,16 @@
 msgid "SQL: Error: %s"
 msgstr "SQL: Greka: %s"
 
+#: version.c:50
+#, c-format
+msgid "SVN revision: %d [%s]"
+msgstr "SVN revizija: %d [%s]"
+
+#: version.c:52 version.c:54
+#, c-format
+msgid "SVN revision: %d"
+msgstr "SVN revizija: %d"
+
 #: src/wiz.c:1471
 #, c-format
 msgid "Searches cost %d %s."
@@ -4714,6 +4840,10 @@
 msgid "There is one player connected."
 msgstr "Jedan igra je spojen."
 
+#: function.c:1040 function.c:1072
+msgid "There's already a function with that name."
+msgstr "Ve postoji funkcija s tim imenom."
+
 #: src/move.c:335 src/move.c:336 src/move.c:337
 msgid "There's no place like home..."
 msgstr "Doma je najljepe..."
@@ -4830,6 +4960,11 @@
 msgid "Totals: Player...%d/%d[%ddel]  Object...%d/%d[%ddel]  Wait...%d/%d[%ddel]  Semaphore...%d/%d"
 msgstr "Ukupno: Korisniki...%d/%d[%ddel]  Objektni...%d/%d[%ddel]  ekajui...%d/%d[%ddel]  Semaforski...%d/%d"
 
+#: wiz.c:1337
+#, c-format
+msgid "Totals: Rooms...%d  Exits...%d  Things...%d  Players...%d  Garbage...%d"
+msgstr "Ukupno: Sobe...%d  Izlazi...%d  Predmeti...%d  Igrai...%d  Otpad...%d"
+
 #: wiz.c:1295
 #, c-format
 msgid "Totals: Rooms...%d  Exits...%d  Things...%d  Players...%d"
@@ -5437,6 +5572,10 @@
 msgid "You can't delete that @function."
 msgstr "Ne moe obrisati taj @function."
 
+#: function.c:1660
+msgid "You can't disable aliases."
+msgstr "Ne moe iskljuivati aliase."
+
 #: src/move.c:576
 msgid "You can't drop that."
 msgstr "Ne moe to ispustiti."
@@ -5533,6 +5672,10 @@
 msgid "You can't see someone else's quota!"
 msgstr "Ne moe vidjeti tuu quotu!"
 
+#: look.c:754
+msgid "You can't see that from here."
+msgstr "Ne vidi to odavde."
+
 #: src/look.c:534
 msgid "You can't see through that."
 msgstr "Ne moe vidjeti kroz to."
@@ -5585,6 +5728,10 @@
 msgid "You cannot adjust the timeout of an indefinite semaphore."
 msgstr "Ne moe promijeniti rok isteka stalnog semafora."
 
+#: function.c:1087
+msgid "You cannot alias @functions."
+msgstr "Ne moe raditi aliase za @funkcije."
+
 #: function.c:869
 msgid "You cannot change that built-in function."
 msgstr "Ne moe promijeniti tu ugraenu funkciju."
@@ -6242,6 +6389,14 @@
 "\n"
 "IZLAZI:"
 
+#: wiz.c:1323
+msgid ""
+"\n"
+"GARBAGE:"
+msgstr ""
+"\n"
+"OTPAD:"
+
 #: src/extmail.c:2507
 msgid ""
 "\n"
Index: po/nl_NL.pox
===================================================================
--- po/nl_NL.pox	(.../184p0)	(revision 575)
+++ po/nl_NL.pox	(.../184p1)	(revision 575)
@@ -148,10 +148,6 @@
 msgid " convtime() is stricter."
 msgstr " convtime() is strenger."
 
-#: flags.c:1531
-msgid " granted."
-msgstr " verleend."
-
 #: src/look.c:688 src/look.c:770
 msgid " is owned by "
 msgstr " is van "
@@ -160,10 +156,6 @@
 msgid " pages"
 msgstr " roept op"
 
-#: flags.c:1531
-msgid " removed."
-msgstr " verwijderd."
-
 #: flags.c:764
 msgid " reset."
 msgstr " uitgezet."
@@ -457,6 +449,10 @@
 msgid "#-1 INVALID SECOND ARGUMENT"
 msgstr "#-1 ONGELDIG TWEEDE ARGUMENT"
 
+#: fundb.c:2124
+msgid "#-1 INVALID SOURCE ROOM"
+msgstr "#-1 ONGELDIGE BRON KAMER"
+
 #: funstr.c:369 funstr.c:425
 msgid "#-1 INVALID THIRD ARGUMENT"
 msgstr "#-1 ONGELDIG DERDE ARGUMENT"
@@ -802,6 +798,26 @@
 msgid "%s (this room) [speech]."
 msgstr "%s (deze kamer) [spraak]."
 
+#: flags.c:1714
+#, c-format
+msgid "%s - %s (already) granted."
+msgstr "%s - %s (al) verleend."
+
+#: flags.c:1710
+#, c-format
+msgid "%s - %s (already) removed."
+msgstr "%s - %s (al) verwijderd."
+
+#: flags.c:1716
+#, c-format
+msgid "%s - %s granted."
+msgstr "%s - %s verleend."
+
+#: flags.c:1708
+#, c-format
+msgid "%s - %s removed."
+msgstr "%s - %s verwijderd."
+
 #: flags.c:1357
 #, c-format
 msgid "%s - I don't recognize that flag."
@@ -1322,6 +1338,11 @@
 msgid "%s: Objects: %d   Limit: UNLIMITED"
 msgstr "%s: Objecten: %d  Limiet: ONGELIMITEERD"
 
+#: wiz.c:1327
+#, c-format
+msgid "%sGarbage%s(#%d)"
+msgstr "%sAfval%s(#%d)"
+
 #: attrib.c:1566 attrib.c:1584
 #, c-format
 msgid "'%s' contains too many aliases."
@@ -1544,7 +1565,7 @@
 
 #: wiz.c:1810
 msgid "Any name matching these wildcard patterns is banned:"
-msgstr "Iedere naam die met deze wildcards overeenkomt is verboden:"
+msgstr "Iedere naam die met deze wildcard patronen overeenkomt is verboden:"
 
 #: command.c:1812
 #, c-format
@@ -2187,7 +2208,7 @@
 
 #: look.c:821
 msgid "Destination: *UNLINKED*"
-msgstr "Doel: *NIET GEKOPPELD*"
+msgstr "Bestemming: *NIET GEKOPPELD*"
 
 #: destroy.c:320
 msgid "Destroyed."
@@ -2568,6 +2589,11 @@
 msgid "Garbage is garbage."
 msgstr "Afval is afval."
 
+#: wiz.c:1329
+#, c-format
+msgid "Garbage(#%d)"
+msgstr "Afval(#%d)"
+
 #: src/set.c:82
 msgid "Give it what new name?"
 msgstr "Welke nieuwe naam wil je het geven?"
@@ -2927,7 +2953,7 @@
 
 #: create.c:373
 msgid "Internal error: weird object type."
-msgstr "Interne fout: Vreemd type object."
+msgstr "Interne fout: vreemd type object."
 
 #: atr_tab.c:202 atr_tab.c:293
 msgid "Invalid attribute name."
@@ -4348,7 +4374,7 @@
 
 #: src/game.c:206
 msgid "Sorry, you are in a no dumping zone."
-msgstr "Sorry, je bent in een zone waar dumpen verboden is."
+msgstr "Sorry, je mag hier niet dumpen."
 
 #: src/game.c:1235
 msgid "Sorry, you are in an invalid location."
@@ -4888,6 +4914,11 @@
 msgid "Totals: Player...%d/%d[%ddel]  Object...%d/%d[%ddel]  Wait...%d/%d[%ddel]  Semaphore...%d/%d"
 msgstr "Totalen: Speler...%d/%d[%ddel]  Object...%d/%d[%ddel]  Wacht...%d/%d[%ddel]  Semaphore...%d/%d"
 
+#: wiz.c:1337
+#, c-format
+msgid "Totals: Rooms...%d  Exits...%d  Things...%d  Players...%d  Garbage...%d"
+msgstr "Totaal: Kamers...%d  Uitgangen...%d  Dingen...%d  Spelers...%d  Afval...%d"
+
 #: wiz.c:1295
 #, c-format
 msgid "Totals: Rooms...%d  Exits...%d  Things...%d  Players...%d"
@@ -5595,6 +5626,10 @@
 msgid "You can't see someone else's quota!"
 msgstr "Je kunt iemand anders z'n quota niet bekijken."
 
+#: look.c:754
+msgid "You can't see that from here."
+msgstr "Je kunt dat niet zien van hier af."
+
 #: src/look.c:534
 msgid "You can't see through that."
 msgstr "Je kunt daar niet doorheen kijken."
@@ -6290,7 +6325,7 @@
 "*** Inactivity limit reached. You are now HIDDEN. ***\n"
 msgstr ""
 "\n"
-" *** Inactiviteits limiet bereikt. Je bent nu HIDDEN. ***\n"
+" *** Inactiviteitslimiet bereikt. Je bent nu HIDDEN. ***\n"
 
 #: src/bsd.c:4673
 msgid ""
@@ -6308,6 +6343,14 @@
 "\n"
 "UITGANGEN:"
 
+#: wiz.c:1323
+msgid ""
+"\n"
+"GARBAGE:"
+msgstr ""
+"\n"
+"AFVAL:"
+
 #: src/extmail.c:2507
 msgid ""
 "\n"
Index: po/pl_PL.pox
===================================================================
--- po/pl_PL.pox	(.../184p0)	(revision 575)
+++ po/pl_PL.pox	(.../184p1)	(revision 575)
@@ -124,10 +124,6 @@
 msgid " convtime() is stricter."
 msgstr " convtime() jest ograniczony."
 
-#: flags.c:1531
-msgid " granted."
-msgstr " przyznane."
-
 #: src/look.c:688 src/look.c:770
 msgid " is owned by "
 msgstr " jest w posiadaniu "
@@ -136,10 +132,6 @@
 msgid " pages"
 msgstr " wzywa"
 
-#: flags.c:1531
-msgid " removed."
-msgstr " usunite."
-
 #: flags.c:764
 msgid " reset."
 msgstr " skasowany."
Index: po/no_NO.pox
===================================================================
--- po/no_NO.pox	(.../184p0)	(revision 575)
+++ po/no_NO.pox	(.../184p1)	(revision 575)
@@ -148,10 +148,6 @@
 msgid " convtime() is stricter."
 msgstr " convtime() er streng."
 
-#: flags.c:1531
-msgid " granted."
-msgstr " gitt."
-
 #: src/look.c:688 src/look.c:770
 msgid " is owned by "
 msgstr " er eid av "
@@ -160,10 +156,6 @@
 msgid " pages"
 msgstr " kaller"
 
-#: flags.c:1531
-msgid " removed."
-msgstr " fjernet."
-
 #: flags.c:764
 msgid " reset."
 msgstr " resatt."
Index: CHANGES.184
===================================================================
--- CHANGES.184	(.../184p0)	(revision 575)
+++ CHANGES.184	(.../184p1)	(revision 575)
@@ -16,6 +16,98 @@
 
 ==========================================================================
 
+Version 1.8.4 patchlevel 1                                 Sep 05,  2010
+
+Major Changes:
+ * You can now do the equivilent of @command/add, @hook, @function and
+   @attribute/access from alias.cnf and restrict.cnf, to add/configure
+   commands, functions and standard attributes. Suggested by Paige. [MG]
+ * Exits now use @alias for alternate names. The old style of
+   including aliases directly in names is still supported, but
+   depreciated in new construction. Suggested by [MG]. [SW]
+
+Minor Changes:
+ * @power now reports when you try and set a power which is already set (or
+   clear one which isn't set), similar to @set. Suggested by Paige. [MG]
+ * Sorting methods now take - as a prefix to sort type in order to sort
+   in descending order. Suggested by Minion. [GM]
+ * The matching code no longer matches players who aren't nearby with
+   "*playername" when MAT_NEAR is given, more in line with other checks.
+   (This has virtually no impact for most players.) [MG]
+ * The internal pe_info (which manages the function invocation limit, among
+   other things) is now managed per-queue, not per-command argument. [MG]
+ * @chan/decompile now uses "*name" for players, and dbrefs for other
+   objects, when printing "@chan/on" statements. [MG]
+ * cpu_limit now works on Cygwin (though not quite as well as on unix).
+   A slightly higher limit may be needed than other platforms. [MG]
+ * The output from say, pose, semipose and @emit is now passed through the
+   SPEECHMOD attribute before being outputted. Suggested by Paige, based on
+   MUX and TinyMUSH. [MG]
+ * @config/list now accepts wildcard patterns to match against option names.
+   Suggested by Trinsec. [MG]
+ * The dreaded <Output flushed> message should show up a lot less frequently
+   on spammy debug output and the like. By popular demand. [SW]
+ * Added support for MSSP (Mud Server Status Protocol), based on patches by
+   Javelin and Teal. See mush.cnf for details. [MG]
+ * The script for updating config files is smarter about adding new alias
+   lines. [SW]
+ * @search now only charges for elock searches which use eval or indirect
+   locks.
+ * Added @mail/unread, to mark mail you've already read as new, and 
+   @mail/status to change read/cleared/tagged status for messages.. Suggested
+   by qa'toq. [MG]
+
+Commands:
+ * Add /preserve switch to @chzone and @chzoneall, like @chown/preserve.
+ * Rooms/exits must now have an @COST attribute in order to be given
+   pennies. Use @cost <ancestor>=%0 to enable giving to all rooms/exits. [MG]
+ * with/room can now check for commands in the Master Room or your ZMR, and
+   with can check for commands on your ZMT. [MG]
+ * @sitelock/register <host> now sets the access rules for <host> to be
+   "!create register", rather than "!create". Suggested by Trinsec. [MG]
+   
+Functions:
+ * remit() now works like @remit/list. Suggested by Minion. [MG]
+ * rand() now accepts negative arguments again. [MG]
+ * lcon() can now take a second argument to make it behave like lthings()
+   or l[v]players(), or makes it return only puppets/listening objects,
+   for MUX/Rhost compatability. Suggested by Bane. [MG]
+ * open() can now open rooms remotely. Suggested by Minion. [MG]
+ * reswitch() and co now perform $-replacements for subexpressions. [MG]
+
+Fixes:
+ * Help fixes.
+ * @search's output can now include garbage objects, like lsearch().
+   Reported by Minion. [MG]
+ * The command parser incorrectly expanded the names of disabled built-in
+   commands prior to $-command matching. Reported by Mercutio. [MG]
+ * benchmark()'s average would be thrown off when the CPU limit was 
+   exceeded during evaluation. Reported by Amberyl. [MG]
+ * Fix a few bugs in handling of command locks. [SW]
+ * Garbage objects could be matched by dbref. Reported by Paige. [MG]
+ * No longer complain about reboot.db not being present when we're not
+   doing a @shutdown/reboot anyway. Reported by Paige. [MG]
+ * The Telnet escape code was not properly escaped when sent literally to
+   Pueblo-aware clients. [MG]
+ * namelist() did not accept names in quotes. Reported by Amberyl. [MG]
+ * @attrib/access/retroactive could remove the 'root' flag from attribute
+   trees, making nasty things happen. Reported by Cooee. [MG]
+ * Fix fn() to check that the first arugment is actually the name of a
+   built-in function. Reported by Time and Cheetah. [DC]
+ * Nested @asserts/@breaks with no '=' would loop unintentionally.
+   Reported by Minion. [MG]
+ * Fixed a couple of small bugs in give/@cost. [MG]
+ * You can now always look at remote objects whose descs are not set nearby,
+   and can never look at remote objects with nearby descs. [MG]
+ * The chatdb didn't load correctly with invalid objects on channels. [MG]
+ * Fixed a crashbug in @boot on Windows. Reported by Daniel Powell. [MG]
+ * %q-registers did not carry over into @includes correctly. Reported by
+   Reaver. [MG]
+ * Double-free in follow command fixed. Reported by Anya@ST:DW. [MG]
+ * locate() sometimes returned #-2 when two objects matched, even if only
+   one of them was the preferred type. Reported by Minion. [MG]
+
+
 Version 1.8.4 patchlevel 0                                 May 09,  2010
 
 Major Changes:
@@ -30,7 +122,7 @@
  * mindb+maxdb classes for lsearch/@search no longer reset to default
    values when > db_top or < 0 is given: Instead treated as an integer
    comparison. [GM]
- * @open can now open exits in remove locations, as well as your current
+ * @open can now open exits in remote locations, as well as your current
    location. Suggested by Bane. [MG]
  * New OPEN_OK flag allows anyone to open exits in a room, and @lock/open
    to restrict who can. Based on patch by ranmir@M*U*S*H. [MG]
Index: utils/update.pl
===================================================================
--- utils/update.pl	(.../184p0)	(revision 575)
+++ utils/update.pl	(.../184p1)	(revision 575)
@@ -33,82 +33,75 @@
 #  want to retain obsoleted defines. Retained defines appear at
 #  the end of the file.
 
-die "Usage: update.pl old-file new-file\n" unless $#ARGV == 1;
+die "Usage: update.pl old-file new-file\n" unless scalar @ARGV == 2;
 
-$old = $ARGV[0];
-$bak = $old . ".bak";
-$new = $ARGV[1];
+use File::Copy;
+use subs qw/ask_value ask_simple def/;
+
+my ($old, $new) = @ARGV;
 
+$bak = $old . ".bak";
 
-# Part 1 - back up the old file (inefficient but reliable method)
+# Part 1 - back up the old file
 if (-r $old) {
     print "*** Backing up $old to $bak...\n";
-    die "update.pl: Unable to open $old\n" unless open(OLD,"$old"); 
-    die "update.pl: Unable to open $bak\n" unless open(BAK,">$bak");
-    print BAK <OLD>;
-    close(BAK);
-    close(OLD);
+    copy $old, $bak or die "Unable to copy $old to $bak: $!\n";
 }
 
 # Part 2 - read the settings from the old file and store them
 if (-r $old) {
-   print "*** Reading your settings from $old...\n";
-    die "update.pl: Unable to open $old\n" unless open(OLD,"$old"); 
+    print "*** Reading your settings from $old...\n";
+    open OLD, "<", $old or die "update.pl: Unable to open $old: $!\n"; 
     while (<OLD>) {
-        # There are a few possibilities for what we could have:
-        # an #ifdef, #ifndef, #else, #endif, #define, #undef,
-        # commented #define, comment text, etc. We only care
-        # about the settings of define/undefs
-        s#/\*\s*\*/##;
-        s#[ \t]+([\r\n]*)$#$1#;
-        if ( /^#define\s+([A-Z0-9_-]+).*\\$/ ) {
-    	# A define with a continuation, we need the next line
-    	chop($next = <OLD>);
-    	$defs{$1} = $next;
-    	$comment{$1} = $comment;
-        } elsif ( m!^#define\s+([A-Z0-9_-]+)\s+(.+)\s+(/\*.*\*/)!
-    	     ) {
-    	# A define with a value and a comment
-    	$name = $1;
-    	$comment{$name} = $3;
-    	$defs{$name} = $2;
-    	undef $comment;
-        } elsif ( m!^#define\s+([A-Z0-9_-]+)\s+(.+)!
-    	     ) {
-    	# A define with a value
-    	$defs{$1} = $2;
-    	$comment{$1} = $comment;
-        } elsif ( /^#undef\s+([A-Z0-9_-]+)/ 
-    	     ) {
-    	# an undef
-    	$defs{$1} = 'undef';
-    	$comment{$1} = $comment;
-        } elsif ( m!^/\*\s*#define\s+([A-Z0-9_-]+)\s+(.+)\s+(/\*.*\*/)!
-    	     ) {
-    	# A commented define with a value and a comment
-    	$name = $1;
-    	$comment{$name} = $3;
-        $cvaldef{$name}++;
-    	$defs{$name} = $2;
-    	undef $comment;
-        } elsif ( /^(\/\*)*\s*#define\s+([A-Z0-9-][A-Z0-9_-]+)/
-    	     ) {
-    	# a define or commented define
-    	$defs{$2} = ($1 eq "/*") ? 'undef' : 'define';
-    	$comment{$2} = $comment;
+	# There are a few possibilities for what we could have:
+	# an #ifdef, #ifndef, #else, #endif, #define, #undef,
+	# commented #define, comment text, etc. We only care
+	# about the settings of define/undefs
+	s#/\*\s*\*/##;
+	s#[ \t]+([\r\n]*)$#$1#;
+	if (/^#define\s+([A-Z0-9_-]+).*\\$/) {
+	    # A define with a continuation, we need the next line
+	    chop($next = <OLD>);
+	    $defs{$1} = $next;
+	    $comment{$1} = $comment;
+	} elsif (m!^#define\s+([A-Z0-9_-]+)\s+(.+)\s+(/\*.*\*/)!) {
+	    # A define with a value and a comment
+	    $name = $1;
+	    $comment{$name} = $3;
+	    $defs{$name} = $2;
+	    undef $comment;
+        } elsif (m!^#define\s+([A-Z0-9_-]+)\s+(.+)!) {
+	    # A define with a value
+	    $defs{$1} = $2;
+	    $comment{$1} = $comment;
+        } elsif (/^#undef\s+([A-Z0-9_-]+)/) {
+	    # an undef
+	    $defs{$1} = 'undef';
+	    $comment{$1} = $comment;
+        } elsif (m!^/\*\s*#define\s+([A-Z0-9_-]+)\s+(.+)\s+(/\*.*\*/)!) {
+	    # A commented define with a value and a comment
+	    $name = $1;
+	    $comment{$name} = $3;
+	    $cvaldef{$name}++;
+	    $defs{$name} = $2;
+	    undef $comment;
+        } elsif (/^(\/\*)*\s*#define\s+([A-Z0-9-][A-Z0-9_-]+)/) {
+	    # a define or commented define
+	    $defs{$2} = ($1 eq "/*") ? 'undef' : 'define';
+	    $comment{$2} = $comment;
         } else {
-    	if (m#^\s*/\*#) {
-    	    # Start of a comment
-    	    $incomment = 1;
-    	    undef $comment;
-    	}
-    	if ($incomment) {
-    	    $comment = $comment . $_;
-    	    if (m#\*/\s+$#) {
-    		# End of a comment
-    		$incomment = 0;
-    	    }
-    	}
+	    if (m#^\s*/\*#) {
+		# Start of a comment
+		$incomment = 1;
+		undef $comment;
+	    }
+	    if ($incomment) {
+		$comment = $comment . $_;
+		if (m#\*/\s+$#) {
+		    # End of a comment
+		    $incomment = 0;
+		}
+	    }
         }
     }
     close(OLD);
@@ -119,48 +112,47 @@
 # Part 3 - Check to see if we have environment variable SETTINGS and
 #          use those settings as if they were in the old file.
 if ($settings = $ENV{'DEFINE'}) {
-  print "\n*** Found a DEFINE environment variable - applying settings...\n";
-  @pairs = split ' ', $settings;
-  foreach (@pairs) {
-    if (($d,$v) = /(.+)=(.+)/) {
-      $defs{$d} = $v;
-    } else {
-      $defs{$_} = 'define';
+    print "\n*** Found a DEFINE environment variable - applying settings...\n";
+    my @pairs = split ' ', $settings;
+    foreach (@pairs) {
+	if (/(.+)=(.+)/) {
+	    $defs{$1} = $2;
+	} else {
+	    $defs{$_} = 'define';
+	}
     }
-  }
 }
 if ($settings = $ENV{'UNDEFINE'}) {
-  print "\n*** Found an UNDEFINE environment variable - applying settings...\n";
-  @pairs = split ' ', $settings;
-  foreach (@pairs) {
-      $defs{$_} = 'undef';
-  }
+    print "\n*** Found an UNDEFINE environment variable - applying settings...\n";
+    my @pairs = split ' ', $settings;
+    foreach (@pairs) {
+	$defs{$_} = 'undef';
+    }
 }
 
 # Part 4 - read in the new file, modifying its definition lines to
 #          match the old file. If we come across a definition that
 #          isn't in the old file, ask the user about it. 
 print "*** Updating $old from $new...\n";
-die "update.pl: Unable to open $old\n" unless open(OLD,">$old"); 
-die "update.pl: Unable to open $new\n" unless open(NEW,"$new"); 
+open OLD, ">", $old or die "update.pl: Unable to open $old: $!\n"; 
+open NEW, "<", $new or die "update.pl: Unable to open $new: $!\n"; 
 $_ = <NEW>;
 while ($next = <NEW>) {
     # Just like before, but we need to keep track of
     # comments in the file so that we can describe options
     s#[ \t]+([\r\n]*)$#$1#;
-    if ( /^#define\s+([A-Z0-9_-]+).*\\$/
-	) {
+    if (/^#define\s+([A-Z0-9_-]+).*\\$/) {
 	# A define with a continuation, we need the next line
 	print OLD "#define $1 \\\n";
-	&ask_value($1,$next) if (!defined($defs{$1}));
+	ask_value($1,$next) if (!defined($defs{$1}));
 	print OLD $defs{$1};
 	delete $defs{$1};
 	$next = <NEW>;
-    } elsif ( /^#define\s+([A-Z0-9-][A-Z0-9_-]+)\s+\/\*\s*\*\//) {
+    } elsif (/^#define\s+([A-Z0-9-][A-Z0-9_-]+)\s+\/\*\s*\*\//) {
 	# a define followed by /* */
-	print OLD defined($defs{$1}) ? &def($1) 
-	                             : &def(&ask_simple($1,'define'));
-    } elsif ( m!^(/\*\s*)?#define\s+([A-Z0-9_-]+)\s+(.+)\s+(/\*.*\*/)!) {
+	print OLD defined($defs{$1}) ? def($1) 
+	    : def(ask_simple($1,'define'));
+    } elsif (m!^(/\*\s*)?#define\s+([A-Z0-9_-]+)\s+(.+)\s+(/\*.*\*/)!) {
 	# A define with a value and a comment
         $maybeundef = $1;
 	$maybecomment = $4; $name = $2;
@@ -168,20 +160,18 @@
 	$comment = $maybecomment if ($maybecomment =~ /\w/);
 	$def = "undef" if $maybeundef =~ /./;
 	print OLD defined($defs{$name}) 
-	    ? &def($name,$comment) : &def(&ask_value($name,$def),$maybecomment,$def eq "undef" ? $olddef : $def);
-    } elsif ( m!^#define\s+([A-Z0-9_-]+)\s+(.+)!) {
+	    ? def($name,$comment) : def(ask_value($name,$def),$maybecomment,$def eq "undef" ? $olddef : $def);
+    } elsif (m!^#define\s+([A-Z0-9_-]+)\s+(.+)!) {
 	# A define with a value
-	print OLD defined($defs{$1}) ? &def($1) : &def(&ask_value($1,$2));
-    } elsif ( /^#undef\s+([A-Z0-9_-]+)/ 
-	     ) {
-	print OLD defined($defs{$1}) ? &def($1) 
-	                             : &def(&ask_simple($1,'undef'));
-    } elsif ( /^(\/\*)*\s*#define\s+([A-Z0-9-][A-Z0-9_-]+)/
-	     ) {
+	print OLD defined($defs{$1}) ? def($1) : def(ask_value($1,$2));
+    } elsif (/^#undef\s+([A-Z0-9_-]+)/) {
+	print OLD defined($defs{$1}) ? def($1) 
+	    : def(ask_simple($1,'undef'));
+    } elsif (/^(\/\*)*\s*#define\s+([A-Z0-9-][A-Z0-9_-]+)/) {
 	# a define or commented define
 	print OLD defined($defs{$2}) ?
-	    &def($2)
-		: &def(&ask_simple($2,($1 eq "/*" ? 'undef': 'define')));
+	    def($2)
+	    : def(ask_simple($2,($1 eq "/*" ? 'undef': 'define')));
     } else {
 	if (m#^\s*/\*#) {
 	    # Start of a comment
@@ -189,7 +179,7 @@
 	    undef $comment;
 	}
 	if ($incomment) {
-	    $comment = $comment . $_;
+	    $comment .= $_;
 	    if (m#\*/\s+$#) {
 		# End of a comment
 		$incomment = 0;
@@ -202,50 +192,48 @@
 # At the end of that loop, $_ contains the last line of the
 # file, which should be the #endif.
 $final = $_;
-close(NEW);
+close NEW;
 
 # Part 5 - if there are any definitions left from the old file,
 #          offer to delete them (or not)
 print "\n*** Checking for leftover defines from $old...\n";
-foreach $d (keys %defs) {
+while (my ($d, $val) = each %defs) {
     print "\nI found: $d\n";
-    if ($defs{$d} eq 'undef') {
+    if ($val eq 'undef') {
 	print "Currently undefined\n";
-    } elsif ($defs{$d} eq 'define') {
+    } elsif ($val eq 'define') {
 	print "Currently defined\n";
     } else {
-	print "Definition: $defs{$d}\n";
+	print "Definition: $val\n";
     }
-    print $comment{$d};
-    print "\n";
+    print $comment{$d}, "\n";
     print "If this is a define that you hacked in, you probably should retain it.\n";
     print "If not, it's probably an obsolete define from an earlier patchlevel,\n";
     print "and you need not retain it.\n";
     print "Do you want to retain this in your $old file? [y] ";
     $yn = <STDIN>;
-    if ($yn !~ /^[Nn]/) {
+    if ($yn !~ /^n/i) {
 	print "Retaining definition. It will appear at the end of $old.\n";
-        @retained = (@retained, $d);
+        push @retained, $d;
 	print OLD $comment{$d};
-	print OLD &def($d);
+	print OLD def($d);
 	print OLD "\n";
     } else {
 	print "Deleting definition.\n";
-	@deleted = (@deleted, $d);
+	push @deleted, $d;
     }
 }
 
 print OLD $final;
 
-close(OLD);
+close OLD;
 
 print "\nSummary of changes:\n";
-print "New options from $new: ",join(" ",@newoptions),"\n";
-print "Old options retained: ",join(" ",@retained),"\n";
-print "Old options deleted: ",join(" ",@deleted),"\n";
+print "New options from $new: ", join(", ",@newoptions), "\n";
+print "Old options retained: ", join(", ",@retained), "\n";
+print "Old options deleted: ", join(", ",@deleted), "\n";
 print "If this is wrong, you can recover $old from $bak.\n";
 print "Done!\n";
-exit 0;
 
 
 #
@@ -254,9 +242,8 @@
 # May also be given a comment as a second arg.
 #
 sub def {
-    # We should use my instead of local, but some folks have perl 4
-    local($d,$c,$oldval) = @_;
-    local($df) = $defs{$d};
+    my ($d,$c,$oldval) = @_;
+    my $df = $defs{$d};
     delete $defs{$d};
     $d =~ s/^\s+//;
     $d =~ s/\s+$//;
@@ -265,13 +252,13 @@
     $df =~ s/^\s+//;
     $df =~ s/\s+$//;
     if ($df eq 'undef') {
-      if (defined($oldval) and $oldval) {
-        $oldval =~ s/^\s+//;
-        $oldval =~ s/\s+$//;
-        return "/* #define $d\t$oldval /* */\n";
-      } else {
-        return "/* #define $d /* */\n";
-      }
+	if (defined($oldval) and $oldval) {
+	    $oldval =~ s/^\s+//;
+	    $oldval =~ s/\s+$//;
+	    return "/* #define $d\t$oldval /* */\n";
+	} else {
+	    return "/* #define $d /* */\n";
+	}
     }
     return "#define $d /* */\n" if ($df eq 'define');
     return "/* #define $d\t$df\t$c\n" if ($cvaldef{$d} and $c);
@@ -286,8 +273,8 @@
 # Set $defs{$d} and return the name given
 #
 sub ask_simple {
-    local($d,$s) = @_;
-    local($yn);
+    my ($d,$s) = @_;
+    my $yn;
     print "\nNew option: $d\n";
     print $comment;
     $s = ($s eq 'define') ? 'y' : 'n';
@@ -295,21 +282,21 @@
 	print "Define this option? [$s] ";
 	$yn = <STDIN>;
 	$yn = $s if $yn =~ /^$/;
-	last if $yn =~ /^[YyNn]/;
+	last if $yn =~ /^[yn]/i;
     }
-    $defs{$d} = ($yn =~ /^[Yy]/) ? 'define' : 'undef';
-    @newoptions = (@newoptions,$d);
+    $defs{$d} = ($yn =~ /^y/i) ? 'define' : 'undef';
+    push @newoptions, $d;
     return $d;
 }
-    
+
 
 #
 # &ask_value - Just like ask_simple, but instead of a yes/no,
 # we're going to get a value
 #
 sub ask_value {
-    local($d,$s) = @_;
-    local($val);
+    my ($d,$s) = @_;
+    my $val;
     print "\nNew option: $d\n";
     print "$comment\n" unless ($comment =~ /^\s*\/\*\s*\*\/\s*$/);
     print "Default value: $s\n";
@@ -317,7 +304,7 @@
     $val = <STDIN>;
     $val = $s if $val =~ /^$/;
     $defs{$d} = $val;
-    @newoptions = (@newoptions,$d);
+    push @newoptions, $d;
     return $d;
 }
 
Index: utils/update-cnf.pl
===================================================================
--- utils/update-cnf.pl	(.../184p0)	(revision 575)
+++ utils/update-cnf.pl	(.../184p1)	(revision 575)
@@ -1,4 +1,4 @@
-#!/usr/local/bin/perl
+#!/usr/local/bin/perl -w
 #
 # You make have to change the path to perl above, unless you call this
 # script with 'make update'
@@ -13,176 +13,214 @@
 #
 # Here's how it works.
 # First, we make a backup of your old-file to old-file.bak
-# Then we read all the directives in the old-file, and their
-#  associated comments. Associated comments are those which
-#  appear on lines preceding the directive.
-#  We store the names of all the directives, 
-#  their comments, and how they're defined.
-# Then we do the same for the new-file. If we find a directive
-#  that wasn't in the old-file, we show the user the comment
-#  and ask them how they want it set. Every time we write out
-#  a directive, we delete it from the list of directives from old-file
-# Finally, if there's anything left from old-file that's not in
-#  new-file, we ask if the user would like to retain each one.
-#  Presumably users want to retain their custom directives, but don't
-#  want to retain obsoleted directives. Retained directives appear at
-#  the end of the file.
+# If old-file doesn't exist, just copy new-file to it.
+# Otherwise... 
+# * Read both files, storing all their directives.
+# * Then, for each directive in old-file, if one of the same name also
+#   exists in new-file, write out old-file's version.
+# * If it's a multiple option, like function_alias, add ones present
+#   in new-file that aren't in old-file. If old-file has entries that
+#   aren't in new-file, also write them out.
+# * If it's a single option and is missing from new-file, prompt to
+#   keep it or not.
+# * Then add directives that are in new-file but not old-file.
 
-die "Usage: update-cnf.pl old-file new-file\n" unless $#ARGV == 1;
+use File::Copy;
+use strict;
+use subs qw/read_cnf_file prompt_to_save dump_directive/;
 
-$old = $ARGV[0];
-$bak = $old . ".bak";
-$new = $ARGV[1];
+die "Usage: $0 old-file new-file\n" unless scalar @ARGV == 2;
 
+my ($old, $new) = @ARGV;
 
-# Part 1 - back up the old file (inefficient but reliable method)
+my $bak = $old . ".bak";
+
+# Part 1 - back up the old file
 if (-r $old) {
     print "*** Backing up $old to $bak...\n";
-    die "update-cnf.pl: Unable to open $old\n" unless open(OLD,"$old"); 
-    die "update-cnf.pl: Unable to open $bak\n" unless open(BAK,">$bak");
-    print BAK <OLD>;
-    close(BAK);
-    close(OLD);
+    copy $old, $bak or die "Unable to back up $old: $!\n";
 } else {
     # Heck, let's just copy the new file to the old one and quit!
     print "*** Creating $old from $new...\n";
-    die "update-cnf.pl: Unable to open $old\n" unless open(OLD,">$old"); 
-    die "update-cnf.pl: Unable to open $new\n" unless open(NEW,"$new"); 
-    print OLD <NEW>;
-    close(OLD);
-    close(NEW);
+    copy $new, $old or die "Unable to copy $old to $new: $!\n";
     exit 0;
 }
-  
 
-# Part 2 - read the settings from the old file and store them
-if (-r $old) {
-    print "*** Reading your settings from $old...\n";
-    die "update-cnf.pl: Unable to open $old\n" unless open(OLD,"$old"); 
-    while (<OLD>) {
-	# We can have comments, which start with #,
-        # or directives, which start with anything else.
-	if (/^#/) {
-	  # A comment
- 	  push(@comment,$_);
-	} elsif (/^(\S+)\s+(.+)$/) {
-	  # A directive
-	  $key = $1; $val = $2;
-	  chop;
-	  if (defined($directive{$key})) {
-	      # This is a repeatable directive! 
-	      $num{$key}++;
-	      $directive{"$key/$num{$key}"} = $val;
-	      $comment{"$key/$num{$key}"} = join("",@comment);
-	  } else {
-	      $directive{$key} = $val; 
-	      $comment{$key} = join("",@comment);
-	  }
-	  undef @comment;
-        } elsif (/^(\S+)/) {
-          # A directive that's defined as blank
-          $key = $1; $val = "";
-          $directive{$key} = $val;
-	  $comment{$key} = join("",@comment);
-          undef @comment;
-    	} elsif (/^$/) {
-	  # A blank line. Ignore comments so far
-	  undef @comment;
-	}
-    }
-    close(OLD);
-}
+# Part 2 - read the settings from the current and the distributed config files and store them.
 
-# Part 3 - read in the new file, modifying its definition lines to
-#          match the old file. If we come across a definition that
-#          isn't in the old file, ask the user about it. 
+my $working_cnf = read_cnf_file $old;
+my $dist_cnf = read_cnf_file $new;
+
+# Part 3: Merge changes to the distributed conf file with the working one.
+
+my $tmp = $old . ".tmp";
 print "*** Updating $old from $new...\n";
-die "update-cnf.pl: Unable to open $old\n" unless open(OLD,">$old"); 
-die "update-cnf.pl: Unable to open $new\n" unless open(NEW,"$new"); 
-while (<NEW>) {
-    # We can have comments, which start with #,
-    # or directives, which start with anything else.
+
+my @comment = ();
+my @newoptions = ();
+my %seen;
+
+open OUT, ">", $tmp or die "update-cnf.pl: Unable to open $old: $!\n"; 
+open IN, "<", $old or die "update-cnf.pl: Unable to open $new: $!\n"; 
+while (<IN>) {
     if (/^#/) {
 	# A comment
-	push(@comment,$_);
+	push @comment, $_;
+    } elsif (/^\s+$/) {
+	# Blank line. Dump preceding comments.
+	if (scalar @comment) {
+	    print OUT @comment, "\n";
+	    undef @comment;
+	} else {
+	    print OUT "\n";
+	}
     } elsif (/^(\S+)/) {
-	# Not a comment
-	$key = $1;
-	chop;
-	if ($num{$key}) {
-	    if ($num{$key} > 0) {
-		# A repeatable directive!
-		# Spew them all here. It's probably the best we can do.
-		print OLD @comment;
-		print OLD "$key\t$directive{$key}\n\n";
-		delete $comment{$key};
-		for ($i = 1; $i <= $num{$key}; $i++) {
-		    print OLD $comment{"$key/$i"};
-		    print OLD "$key\t", $directive{"$key/$i"},"\n\n";
-		    delete $comment{"$key/$i"};
-		    delete $directive{"$key/$i"};
-		} 
-		$num{$key} = -1; # Don't spew again
-	    }
+	# Directive
+	my $key = $1;	
+
+	undef @comment;
+
+	next if $seen{$key};
+
+	if (!defined $dist_cnf->{$key}) {
+            # Present in working copy, not in dist copy.
+	    dump_directive $working_cnf->{$key} if prompt_to_save $key, $working_cnf->{$key};
+	    $seen{$key} = 1;
 	} else {
-	    print OLD @comment;
-	    if (!defined($directive{$key}) || $key eq "include") {
-		# It's new, just add it
-		print OLD $_,"\n";
-		push(@newoptions,$key);
-              delete $comment{$key} if $key eq "include";
+	    # Present in working copy and dist copy.
+	    my $nwork = scalar @{$working_cnf->{$key}};
+	    my $ndist = scalar @{$dist_cnf->{$key}};
+	    if ($nwork == $ndist) {
+		# Both copies have the same number of repeats. Use working version.
+		dump_directive \*OUT, $working_cnf->{$key};
+		$seen{$key} = 1;
+	    } elsif ($nwork > $ndist) {
+		# There are more records in the working cnf
+		# file. Assume they're supposed to be there
+		# (Game-specific function aliases, etc.)
+		# TODO: Consider prompting for each one?
+		dump_directive \*OUT, $working_cnf->{$key};
+		$seen{$key} = 1;
 	    } else {
-		# It's old. Put it in, with a value if one's set.
-		print OLD $key;
-		print OLD "\t$directive{$key}" if (defined($directive{$key}));
-		print OLD "\n";
-		# Remove its comment.
-		delete $comment{$key};
+		# More records in the dist file. Try to merge.
+		my %records;
+
+		# Copy everything in the conf file.
+		dump_directive \*OUT, $working_cnf->{$key};
+
+		# And add anything new from the dist file. TODO: Prompting?
+		foreach my $dir (@{$dist_cnf->{$key}}) {
+		    $records{$dir->{"value"}} = $dir->{"comment"};
+		}
+		foreach my $dir (@{$working_cnf->{$key}}) {
+		    delete $records{$dir->{"value"}};
+		}
+		while (my ($val, $c) = each %records) {
+		    if ($val =~ /^(\S+)\s/) {
+			push @newoptions, "$key $1";
+		    } else {
+			push @newoptions, $key;
+		    }
+		    print OUT $c, $key, " ", $val, "\n";
+		}
+		$seen{$key} = 1;
 	    }
 	}
-	undef @comment;
-    } elsif (/^$/) {
-	print OLD @comment;
-	undef @comment;
-	print OLD;
-    } else {
-	print OLD;
     }
 }
-close(NEW);
+close IN;
 
-# Part 4 - if there are any definitions left from the old file,
-#          offer to delete them (or not)
-print "\n*** Checking for leftover defines from $old...\n";
-foreach $d (sort { $directive{$a} cmp $directive{$b} } keys %comment) {
-    $newd = $d;
-    $newd =~ s!/.*!!;
-    print "\nI found:\n";
-    print $comment{$d};
-    print "$newd\t$directive{$d}\n";
+# Now we check for things in dist that haven't been seen in the working file.
+while (my ($key, $dir) = each %{$dist_cnf}) {
+    next if $seen{$key};
+    dump_directive \*OUT, $dir;
+    push @newoptions, $key;   
+}
+
+close OUT;
+move $tmp, $old or die "Unable to create $old: $!\n";
+
+my (@deleted, @retained);
+
+print "\nSummary of changes:\n";
+print "New options from $new: ", join(", ",@newoptions), "\n";
+print "Old options retained: ", join(", ",@retained), "\n";
+print "Old options deleted: ", join(", ",@deleted), "\n";
+print "If this is wrong, you can recover $old from $bak.\n";
+print "Done!\n";
+
+sub read_cnf_file {
+    my (%directive, @comment);
+    my $file = shift;
+    
+    print "*** Reading settings from $file...\n";
+    open FILE, "<", $file or die "update-cnf.pl: Unable to open $file: $!\n"; 
+    while (<FILE>) {
+	# We can have comments, which start with #,
+	# or directives, which start with anything else.
+	chomp;
+	if (/^#/) {
+	    # A comment
+	    push @comment, $_;
+	} elsif (/^(\S+)\s+(.+)$/) {
+	    # A directive
+	    my ($key, $val) = ($1, $2);
+	    my $c = join "\n", @comment;
+	    $c .= "\n" if length $c;
+	    if (defined $directive{$key}) {
+		# This is a repeated directive! 
+		push @{$directive{$key}}, { "key" => $key, "value" => $val, "comment" => $c };
+	    } else {
+		$directive{$key} = [{"key" => $key, "value" => $val, "comment" => $c}]; 
+	    }
+	    undef @comment;
+        } elsif (/^(\S+)/) {
+	    # A directive that's defined as blank
+	    my ($key, $val) = ($1, "");
+	    my $c = join "\n", @comment;
+	    $c .= "\n" if length $c;
+	    if (defined $directive{$key}) {
+		# These probably won't repeat, but... 
+		push @{$directive{$key}}, {"key" => $key, "value" => "", "comment" => $c };
+	    } else {
+		$directive{$key} = [{"key" => $key, "value" => "", "comment" => $c }];
+	    }
+	    undef @comment;
+    	} elsif (/^$/) {
+	    # A blank line. Ignore comments so far
+	    undef @comment;
+	}
+    }
+    close FILE;
+    return \%directive;
+}
+
+sub prompt_to_save {
+    my ($name, $directive) = shift;
+
+    print "\nI found $name:\n";
+    dump_directive \*STDOUT, $directive;
     print "\n";
     print "If this is a directive that you hacked in, you probably should retain it.\n";
     print "If not, it's probably an obsolete directive from an earlier release,\n";
     print "and you need not retain it.\n";
     print "Do you want to retain this in your $old file? [y] ";
-    $yn = <STDIN>;
-    if ($yn !~ /^[Nn]/) {
-	print "Retaining directive. It will appear at the end of $old.\n";
-        @retained = (@retained, $newd);
-	print OLD $comment{$d};
-	print OLD "$newd\t$directive{$d}\n";
-	print OLD "\n";
+    my $yn = <STDIN>;
+    if ($yn !~ /^n/i) {
+	print "Retaining directive.\n";
+	push @retained, $name;
+	return 1;
     } else {
-	print "Deleting definition.\n";
-	@deleted = (@deleted, $d);
+        push @deleted, $name;
+	return 0;
     }
 }
-close(OLD);
 
-print "\nSummary of changes:\n";
-print "New options from $new: ",join(" ",@newoptions),"\n";
-print "Old options retained: ",join(" ",@retained),"\n";
-print "Old options deleted: ",join(" ",@deleted),"\n";
-print "If this is wrong, you can recover $old from $bak.\n";
-print "Done!\n";
-exit 0;
+sub dump_directive {
+    my $out = shift;
+    my $directive = shift;
+    foreach my $d (@{$directive}) {
+	print $out $d->{"comment"};
+	print $out $d->{key}, " ", $d->{"value"}, "\n";
+    }
+}
Index: hdrs/switches.h
===================================================================
--- hdrs/switches.h	(.../184p0)	(revision 575)
+++ hdrs/switches.h	(.../184p1)	(revision 575)
@@ -132,29 +132,31 @@
 #define SWITCH_SPEAK 129
 #define SWITCH_SPOOF 130
 #define SWITCH_STATS 131
-#define SWITCH_SUMMARY 132
-#define SWITCH_TABLES 133
-#define SWITCH_TAG 134
-#define SWITCH_TELEPORT 135
-#define SWITCH_TF 136
-#define SWITCH_THINGS 137
-#define SWITCH_TITLE 138
-#define SWITCH_TRACE 139
-#define SWITCH_TYPE 140
-#define SWITCH_UNCLEAR 141
-#define SWITCH_UNFOLDER 142
-#define SWITCH_UNGAG 143
-#define SWITCH_UNHIDE 144
-#define SWITCH_UNMUTE 145
-#define SWITCH_UNTAG 146
-#define SWITCH_UNTIL 147
-#define SWITCH_URGENT 148
-#define SWITCH_USEFLAG 149
-#define SWITCH_WHAT 150
-#define SWITCH_WHO 151
-#define SWITCH_WIPE 152
-#define SWITCH_WIZ 153
-#define SWITCH_WIZARD 154
-#define SWITCH_YES 155
-#define SWITCH_ZONE 156
+#define SWITCH_STATUS 132
+#define SWITCH_SUMMARY 133
+#define SWITCH_TABLES 134
+#define SWITCH_TAG 135
+#define SWITCH_TELEPORT 136
+#define SWITCH_TF 137
+#define SWITCH_THINGS 138
+#define SWITCH_TITLE 139
+#define SWITCH_TRACE 140
+#define SWITCH_TYPE 141
+#define SWITCH_UNCLEAR 142
+#define SWITCH_UNFOLDER 143
+#define SWITCH_UNGAG 144
+#define SWITCH_UNHIDE 145
+#define SWITCH_UNMUTE 146
+#define SWITCH_UNREAD 147
+#define SWITCH_UNTAG 148
+#define SWITCH_UNTIL 149
+#define SWITCH_URGENT 150
+#define SWITCH_USEFLAG 151
+#define SWITCH_WHAT 152
+#define SWITCH_WHO 153
+#define SWITCH_WIPE 154
+#define SWITCH_WIZ 155
+#define SWITCH_WIZARD 156
+#define SWITCH_YES 157
+#define SWITCH_ZONE 158
 #endif                          /* SWITCHES_H */
Index: hdrs/extmail.h
===================================================================
--- hdrs/extmail.h	(.../184p0)	(revision 575)
+++ hdrs/extmail.h	(.../184p1)	(revision 575)
@@ -51,9 +51,12 @@
 };
 
 typedef int folder_array[MAX_FOLDERS + 1];
-#define FA_Init(fa,x) \
-for (x = 0; x <= MAX_FOLDERS; x++) \
-fa[x] = 0
+#define FA_Init(fa) \
+  do { \
+  int nfolders; \
+  for (nfolders = 0; nfolders <= MAX_FOLDERS; nfolders++)	\
+    fa[nfolders] = 0; \
+  } while (0)
 
 #define SUBJECT_COOKIE  '/'
 #define SUBJECT_LEN     60
@@ -90,6 +93,9 @@
 extern void do_mail_read(dbref player, char *msglist);
 extern void do_mail_clear(dbref player, const char *msglist);
 extern void do_mail_unclear(dbref player, const char *msglist);
+extern void do_mail_unread(dbref player, const char *msglist);
+extern void do_mail_status(dbref player, const char *msglist,
+                           const char *status);
 extern void do_mail_purge(dbref player);
 extern void do_mail_file(dbref player, char *msglist, char *folder);
 extern void do_mail_tag(dbref player, const char *msglist);
Index: hdrs/mushtype.h
===================================================================
--- hdrs/mushtype.h	(.../184p0)	(revision 575)
+++ hdrs/mushtype.h	(.../184p1)	(revision 575)
@@ -46,6 +46,10 @@
 typedef const char *lock_type;
 typedef struct lock_list lock_list;
 
+
+/* Set this somewhere near the recursion limit */
+#define MAX_ITERS 100
+
 typedef struct pe_info PE_Info;
 typedef struct debug_info Debug_Info;
 /** process_expression() info
@@ -64,6 +68,9 @@
   int call_depth;               /**< Function call counter */
   Debug_Info *debug_strings;    /**< DEBUG infromation */
   int arg_count;                /**< Number of arguments passed to function */
+  int iter_nesting;             /**< Current iter() nesting depth */
+  char *iter_itext[MAX_ITERS];  /**< itext() replacements in iter() */
+  int iter_inum[MAX_ITERS];     /**< inum() values in iter() */
 };
 
 
Index: hdrs/function.h
===================================================================
--- hdrs/function.h	(.../184p0)	(revision 575)
+++ hdrs/function.h	(.../184p1)	(revision 575)
@@ -117,4 +117,7 @@
 extern void function_add(const char *name, function_func fun, int minargs,
                          int maxargs, int ftype);
 
+int cnf_add_function(char *name, char *opts);
+
+
 #endif
Index: hdrs/attrib.h
===================================================================
--- hdrs/attrib.h	(.../184p0)	(revision 575)
+++ hdrs/attrib.h	(.../184p1)	(revision 575)
@@ -35,6 +35,9 @@
 extern char *list_attribs(void);
 extern void attr_init_postconfig(void);
 
+extern int cnf_attribute_access(char *attrname, char *opts);
+
+
 /* From attrib.c */
 
 /** atr_add(), atr_clr() error codes */
Index: hdrs/conf.h
===================================================================
--- hdrs/conf.h	(.../184p0)	(revision 575)
+++ hdrs/conf.h	(.../184p1)	(revision 575)
@@ -50,6 +50,7 @@
 #define DOING_COMMAND "DOING"
 #define SESSION_COMMAND "SESSION"
 #define IDLE_COMMAND "IDLE"
+#define MSSPREQUEST_COMMAND "MSSP-REQUEST"
 
 #define GET_COMMAND "GET"
 #define POST_COMMAND "POST"
@@ -63,7 +64,10 @@
 #define PUEBLO_HELLO "This world is Pueblo 1.10 Enhanced.\r\n"
 
 
-#define MAX_OUTPUT 16384
+/* How much pending outgoing text can be queued up on a socket before
+ * the dreaded 'Output flushed' message shows up? Used to be 16k, now 1m.
+ */
+#define MAX_OUTPUT (1024*1024)
 /* How much output buffer space must be left before we flush the
  * buffer? Reportedly, using '0' fixes problems with Win32 port,
  * and may be more efficient in network use. Using (MAX_OUTPUT / 2)
@@ -76,9 +80,6 @@
 #define COMMANDS_PER_TIME 1     /* commands per time slice after burst */
 
 
-/* Set this somewhere near the recursion limit */
-#define MAX_ITERS 100
-
 /* From conf.c */
 extern void do_config_list(dbref player, const char *type, int lc);
 
@@ -277,8 +278,16 @@
   char sql_database[256]; /**< Database for sql */
 };
 
+typedef struct mssp MSSP;
+struct mssp {
+  char *name;
+  char *value;
+  MSSP *next;
+};
+
 extern OPTTAB options;
 extern HASHTAB local_options;
+extern MSSP *mssp;
 
 extern PENNCONF *add_config(const char *name, config_func handler, void *loc,
                             int max, const char *group);
Index: hdrs/boolexp.h
===================================================================
--- hdrs/boolexp.h	(.../184p0)	(revision 575)
+++ hdrs/boolexp.h	(.../184p1)	(revision 575)
@@ -35,4 +35,7 @@
 };
 char *unparse_boolexp(dbref player, boolexp b, enum u_b_f flag);
 boolexp cleanup_boolexp(boolexp);
+
+bool is_eval_lock(boolexp b);
+
 #endif                          /* BOOLEXP_H */
Index: hdrs/game.h
===================================================================
--- hdrs/game.h	(.../184p0)	(revision 575)
+++ hdrs/game.h	(.../184p1)	(revision 575)
@@ -110,7 +110,7 @@
 extern void do_chown
   (dbref player, const char *name, const char *newobj, int preserve);
 extern int do_chzone(dbref player, const char *name, const char *newobj,
-                     int noisy);
+                     bool noisy, bool preserve);
 extern int do_set(dbref player, const char *name, char *flag);
 extern void do_cpattr
   (dbref player, char *oldpair, char **newpair, int move, int noflagcopy);
@@ -172,11 +172,12 @@
 enum boot_type { BOOT_NAME, BOOT_DESC, BOOT_SELF };
 extern void do_boot(dbref player, const char *name, enum boot_type flag,
                     int silent);
-extern void do_chzoneall(dbref player, const char *name, const char *target);
+extern void do_chzoneall(dbref player, const char *name, const char *target,
+                         bool preserve);
 extern int parse_force(char *command);
 extern void do_power(dbref player, const char *name, const char *power);
 enum sitelock_type { SITELOCK_ADD, SITELOCK_REMOVE, SITELOCK_BAN,
-  SITELOCK_CHECK, SITELOCK_LIST
+  SITELOCK_CHECK, SITELOCK_LIST, SITELOCK_REGISTER
 };
 extern void do_sitelock(dbref player, const char *site, const char *opts,
                         const char *charname, enum sitelock_type type);
Index: hdrs/parse.h
===================================================================
--- hdrs/parse.h	(.../184p0)	(revision 575)
+++ hdrs/parse.h	(.../184p1)	(revision 575)
@@ -158,6 +158,9 @@
                        dbref executor, dbref caller, dbref enactor,
                        int eflags, int tflags, PE_Info *pe_info);
 
+PE_Info *make_pe_info();
+void free_pe_info();
+
 /* buff is a pointer to a BUFFER_LEN string to contain the expression
  * result.  *bp is the point in buff at which the result should be written.
  * *bp will be updated to point one past the result of the expression,
Index: hdrs/atr_tab.h
===================================================================
--- hdrs/atr_tab.h	(.../184p0)	(revision 575)
+++ hdrs/atr_tab.h	(.../184p1)	(revision 575)
@@ -161,6 +161,7 @@
    0, NULL},
   {"SEX", AF_VISUAL | AF_NOPROG | AF_PREFIXMATCH, NULL_CHUNK_REFERENCE, 0,
    NULL},
+  {"SPEECHMOD", AF_NOPROG | AF_PREFIXMATCH, NULL_CHUNK_REFERENCE, 0, NULL},
   {"STARTUP", AF_NOPROG | AF_PREFIXMATCH, NULL_CHUNK_REFERENCE, 0, NULL},
   {"SUCCESS", AF_NOPROG | AF_PREFIXMATCH, NULL_CHUNK_REFERENCE, 0, NULL},
   {"TFPREFIX", AF_NOPROG | AF_NOCOPY | AF_PRIVATE | AF_PREFIXMATCH,
Index: hdrs/command.h
===================================================================
--- hdrs/command.h	(.../184p0)	(revision 575)
+++ hdrs/command.h	(.../184p1)	(revision 575)
@@ -113,9 +113,9 @@
                   char *arg_right, char *args_right[MAX_ARG])
 
 typedef struct command_info COMMAND_INFO;
-typedef void (*command_func) (COMMAND_INFO *, dbref, dbref, switch_mask, const char *,
-                              const char *, char *, char *, char *[MAX_ARG],
-                              char *, char *[MAX_ARG]);
+typedef void (*command_func) (COMMAND_INFO *, dbref, dbref, switch_mask,
+                              const char *, const char *, char *, char *,
+                              char *[MAX_ARG], char *, char *[MAX_ARG]);
 
 /** A hook specification.
  */
@@ -206,8 +206,6 @@
 COMMAND_INFO *make_command
   (const char *name, int type, const char *flagstr,
    const char *powerstr, const char *sw, command_func func);
-COMMAND_INFO *command_modify(const char *name, int type,
-                             boolexp key, switch_mask sw, command_func func);
 void reserve_alias(const char *a);
 int alias_command(const char *command, const char *alias);
 void command_init_preconfig(void);
@@ -230,10 +228,13 @@
 void local_commands(void);
 void do_command_add(dbref player, char *name, int flags);
 void do_command_delete(dbref player, char *name);
-int run_command(COMMAND_INFO *cmd, dbref player, dbref cause, const char *commandraw,
-                switch_mask sw, char switch_err[BUFFER_LEN], const char *string,
-                char *swp, char *ap, char *ls, char *lsa[MAX_ARG], char *rs,
+int run_command(COMMAND_INFO *cmd, dbref player, dbref cause,
+                const char *commandraw, switch_mask sw,
+                char switch_err[BUFFER_LEN], const char *string, char *swp,
+                char *ap, char *ls, char *lsa[MAX_ARG], char *rs,
                 char *rsa[MAX_ARG]);
+int cnf_add_command(char *name, char *opts);
+int cnf_hook_command(char *name, char *opts);
 
 
 #endif                          /* __COMMAND_H */
Index: hdrs/svninfo.h
===================================================================
--- hdrs/svninfo.h	(.../184p0)	(revision 575)
+++ hdrs/svninfo.h	(.../184p1)	(revision 575)
@@ -1,3 +1,3 @@
 #define SVNREVISION "$Rev$"
 #define SVNDATE "$Date$"
-/* Built at 20100418233624 */
+/* Built at 20100904211632 */
Index: hdrs/version.h
===================================================================
--- hdrs/version.h	(.../184p0)	(revision 575)
+++ hdrs/version.h	(.../184p1)	(revision 575)
@@ -1,4 +1,4 @@
 #define VERSION "1.8.4"
-#define PATCHLEVEL "0"
-#define PATCHDATE "[05/09/2010]"
-#define NUMVERSION 1008004000
+#define PATCHLEVEL "1"
+#define PATCHDATE "[09/05/2010]"
+#define NUMVERSION 1008004001
Index: hdrs/dbdefs.h
===================================================================
--- hdrs/dbdefs.h	(.../184p0)	(revision 575)
+++ hdrs/dbdefs.h	(.../184p1)	(revision 575)
@@ -76,7 +76,7 @@
 
 #define GoodObject(x) ((x >= 0) && (x < db_top))
 
-
+#define RealGoodObject(x) (GoodObject(x) && !IsGarbage(x))
 
 /******* Player toggles */
 #define Connected(x)    (IS(x, TYPE_PLAYER, "CONNECTED"))
Index: hdrs/externs.h
===================================================================
--- hdrs/externs.h	(.../184p0)	(revision 575)
+++ hdrs/externs.h	(.../184p1)	(revision 575)
@@ -243,6 +243,7 @@
   int re_subpatterns;         /**< The number of re subpatterns */
   int *re_offsets;            /**< The offsets for the subpatterns */
   struct _ansi_string *re_from;             /**< The positions of the subpatterns */
+  PE_Info *pe_info;           /**< The PE_Info to evaluate the queue with */
 };
 
 typedef struct eval_context EVAL_CONTEXT;
@@ -454,14 +455,16 @@
 unsigned char *u_strncpy
   (unsigned char *restrict target, const unsigned char *restrict source,
    size_t len);
+char *
+mush_strndup(const char *src, size_t len, const char *check)
+  __attribute_malloc__;
 
 
 /** Unsigned char strdup. Why is this a macro when the others functions? */
 #define u_strdup(x) (unsigned char *)strdup((const char *) x)
 #ifndef HAVE_STRDUP
-char *
-strdup(const char *s)
-  __attribute_malloc__;
+    char *strdup(const char *s)
+ __attribute_malloc__;
 #endif
     char *mush_strdup(const char *s, const char *check) __attribute_malloc__;
 
@@ -527,6 +530,7 @@
                           const char *restrict string)
  __attribute_malloc__;
     extern const char *standard_tokens[2];      /* ## and #@ */
+    char *copy_up_to(char *RESTRICT dest, const char *RESTRICT src, char c);
     char *trim_space_sep(char *str, char sep);
     int do_wordcount(char *str, char sep);
     char *remove_word(char *list, char *word, char sep);
